# 信号处理入门 Signal Processing 101

> **阅读时间**: ~60 分钟 | **前置知识**: [生物力学入门](biomechanics-101.md) | **目标**: 理解传感器信号如何转化为挥杆事件

---

## 为什么学习这些？

想象你戴着一个 EMG 传感器贴在前臂上：

- **你完全放松** — 传感器显示的数字是 0 吗？
- **答案是 NO** — 即使你躺在床上，传感器仍会显示一个波动的数值

这不是传感器坏了，而是**信号的本质**。

本文档将帮助你理解：

- EMG 信号的"静息噪声"从何而来
- 如何从噪声中检测到**真正的肌肉激活**
- IMU 如何检测**挥杆阶段**的变化
- 多传感器如何**时间对齐**

掌握这些知识后，你就能理解 [传感器指标映射](../../design/architecture/sensor-metric-mapping.md) 中的检测算法为什么这样写。

---

## 第一章：什么是 EMG 信号 {#emg-basics}

### 1.1 肌肉的电活动 Muscle Electrical Activity

**EMG (Electromyography)** = 肌电图，记录肌肉收缩时产生的电信号。

每一次肌肉收缩，大脑都会发送电信号：

```text
┌─────────────────────────────────────────────────────────────────────────────┐
│                         肌肉激活的电信号传递                                  │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│    大脑        神经        肌肉纤维        EMG传感器                          │
│   ┌───┐       ─────►      ┌────────┐      ┌────────┐                        │
│   │ 🧠 │  发送电信号  ─►   │ 收缩！  │  ─►  │ 检测到  │                        │
│   └───┘                   └────────┘      │ 电信号  │                        │
│                                           └────────┘                        │
│                                                                              │
│   这个电信号的强度：                                                           │
│   • 静息时: ~10-50 μV (微伏)                                                  │
│   • 轻度收缩: 100-300 μV                                                      │
│   • 最大收缩 (MVC): 500-2000 μV                                               │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

**关键概念**:

| 英文 | 中文 | 一句话解释 |
|------|------|-----------|
| **EMG** | 肌电图 | 测量肌肉电活动的信号 |
| **μV (microvolt)** | 微伏 | 电压单位，1 μV = 0.000001 伏特 |
| **MVC** | 最大自主收缩 | 一个人能产生的最大肌肉力量 |

---

### 1.2 静息不是零 Resting is NOT Zero

这是初学者最容易误解的地方：

> **即使你完全放松，EMG 信号也不是 0**

为什么？

```text
┌─────────────────────────────────────────────────────────────────────────────┐
│                         为什么静息 EMG ≠ 0？                                  │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   1. 生理噪声                                                                 │
│      • 心跳产生的电信号会传导到皮肤                                            │
│      • 其他肌肉的微弱活动 (你无法 100% 放松)                                    │
│                                                                              │
│   2. 电子噪声                                                                 │
│      • 电源线的 50/60Hz 干扰                                                  │
│      • 传感器电路本身的热噪声                                                  │
│                                                                              │
│   3. 运动伪影 Motion Artifact                                                │
│      • 电极与皮肤的接触变化                                                    │
│      • 缆线晃动 (有线传感器的噩梦)                                             │
│                                                                              │
│   结果：                                                                      │
│   ──────────────────────────────────────────────────────────────────────    │
│                                                                              │
│   你以为的静息：   ────────────────────────────────                          │
│                              0                                               │
│                                                                              │
│   实际的静息：     ∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿                          │
│                   围绕某个值波动 (这就是 baseline)                             │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

**实际 EMG 信号长这样**：

```text
   肌肉激活强度 (μV)
   ▲
   │                                    ╭───╮
   │                                   ╱     ╲
 500│                                 ╱       ╲    ← 激活峰值
   │                                ╱         ╲
   │                              ╱            ╲
 300│                            ╱              ╲
   │                          ╱                 ╲
   │              ╭─────────╱                    ╲───────╮
 100│∿∿∿∿∿∿∿∿∿∿∿∿∿╯                                      ╰∿∿∿∿∿∿
   │   静息噪声                                              静息噪声
   │  (baseline)                                            (baseline)
   └──────────────────────────────────────────────────────────────────► 时间
         静息期              激活期                     恢复期
```

---

## 第二章：基线 Baseline {#baseline}

### 2.1 什么是基线？

**基线 (Baseline)** = 静息状态下信号的平均水平

可以把它想象成：

> **基线就像湖面的平均水位 — 波浪会在这个水位上下起伏**

```text
┌─────────────────────────────────────────────────────────────────────────────┐
│                         基线的类比                                           │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   想象一个平静的湖面：                                                         │
│                                                                              │
│         波浪高度                                                              │
│            ▲                                                                 │
│            │      ∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿                                  │
│   基线 ─── ├ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─              │
│            │                                                                 │
│            └─────────────────────────────────────────────────► 时间          │
│                                                                              │
│   • 平均水位 = baseline (基线)                                                │
│   • 波浪的起伏 = noise (噪声)                                                 │
│   • 一艘船经过，水位大幅上升 = signal (信号，即肌肉激活)                         │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 2.2 如何计算基线？

**方法：在用户开始运动前，采集 1-2 秒的静息数据**

```text
采集流程：

1. 让用户放松 2 秒
   "请放松手臂，保持静止..."

2. 采集静息期 EMG 数据
   [数据点 1, 数据点 2, ..., 数据点 N]

3. 计算平均值和标准差
   baseline_mean = 所有数据点的平均值
   baseline_std  = 所有数据点的标准差 (波动幅度)

4. 后续使用这两个值判断激活
```

**关键参数**:

| 参数 | 英文 | 推荐值 | 说明 |
|------|------|--------|------|
| 基线窗口 | `baseline_window_ms` | 200-500 ms | 采集静息数据的时长 |
| 基线均值 | `baseline_mean` | 计算值 | 静息信号的平均值 |
| 基线标准差 | `baseline_std` | 计算值 | 静息信号的波动幅度 |

---

## 第三章：激活检测 Onset Detection {#onset-detection}

### 3.1 问题定义

**Onset Detection** = 检测肌肉**开始工作**的精确时刻

为什么这很重要？

```text
┌─────────────────────────────────────────────────────────────────────────────┐
│                    为什么需要精确检测激活时刻？                                 │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   高尔夫运动链的正确顺序:                                                      │
│                                                                              │
│   核心肌群 ──► 躯干 ──► 手臂 ──► 球杆                                         │
│   (先激活)              (后激活)                                              │
│                                                                              │
│   如果检测精度是 50ms，而职业选手的激活间隔只有 30ms：                           │
│   → 我们无法区分正确的顺序和错误的顺序！                                        │
│                                                                              │
│   目标精度: < 5ms                                                             │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.2 直观理解

**问题本质**：在嘈杂的信号中，找到**真正激活**的起点

```text
信号强度 (μV)
▲
│
│                          ← 哪里是激活开始？
│                         ╭╮
│                        ╱  ╲
│                       ╱    ╲
│                      ╱      ╲
│                     ╱        ╲
│                    ╱          ╲
│               ╭───╯            ╲
│∿∿∿∿∿∿∿∿∿∿∿∿∿∿╯                  ╲∿∿∿∿∿∿∿∿
│   ↑                              ↑
│   噪声                           噪声
│
└──────────────────────────────────────────────────► 时间

问题：噪声中偶尔也有高点，如何区分"真激活"和"假高点"？
```

**类比**：

> 想象你在嘈杂的咖啡店里等朋友。背景噪音一直存在 (baseline)，
> 当你听到朋友叫你名字时 (onset)，声音明显比背景大。
> 但偶尔路人的咳嗽声也可能很大 (噪声尖峰)。
> 你需要一种方法区分"真的叫我"和"随机噪音"。

---

## 第四章：三种阈值方法 {#threshold-methods}

### 4.1 方法一：标准差法 SD Method

**原理**：信号超过 baseline + N 倍标准差时，判定为激活

```text
┌─────────────────────────────────────────────────────────────────────────────┐
│                         标准差法 (SD Method)                                 │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   阈值计算:                                                                   │
│   threshold = baseline_mean + (N × baseline_std)                            │
│                                                                              │
│   常用 N 值:                                                                  │
│   • N = 2: 灵敏但可能有假阳性                                                 │
│   • N = 3: 平衡选择 (推荐)                                                    │
│   • N = 5: 保守但可能漏检                                                     │
│                                                                              │
│   示例 (baseline_mean=50μV, baseline_std=15μV):                              │
│   • 2SD 阈值 = 50 + 2×15 = 80 μV                                              │
│   • 3SD 阈值 = 50 + 3×15 = 95 μV                                              │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘

信号图示:

   μV
   ▲
   │                              ╭──╮
   │                             ╱    ╲
 150│                           ╱      ╲
   │                          ╱        ╲
   │                        ╱           ╲
   │                      ╱              ╲
 95 ├ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─X─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ← 3SD 阈值
   │                    ╱                 ╲
 80 ├ ─ ─ ─ ─ ─ ─ ─ ─ X ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ← 2SD 阈值
   │                 ╱                      ╲
   │         ∿     ╱                         ╲     ∿
 50 ├∿∿∿∿∿∿∿╱∿∿∿∿∿╱∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿∿╲∿∿╱∿∿ ← baseline
   │
   └──────────────────────────────────────────────────► 时间
                   ↑
                   onset (激活开始点)
```

**关键参数**:

| 参数 | 英文 | 推荐值 | 说明 |
|------|------|--------|------|
| 标准差倍数 | `onset_threshold_sd` | 2-3 | 超过基线 N 个 SD 判定为激活 |

**优点**: 简单、快速、易于理解

**缺点**: 阈值固定，不同用户的 baseline 差异大

---

### 4.2 方法二：百分比 MVC 法 %MVC Method

**原理**：阈值设为最大自主收缩 (MVC) 的某个百分比

```text
┌─────────────────────────────────────────────────────────────────────────────┐
│                         %MVC 方法                                            │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   步骤:                                                                       │
│   1. 校准: 让用户用最大力气收缩肌肉 3 秒                                        │
│   2. 记录: 取峰值作为 MVC 参考                                                 │
│   3. 阈值: threshold = MVC × 百分比                                           │
│                                                                              │
│   常用百分比:                                                                  │
│   • 5-10% MVC: 用于检测轻微激活                                               │
│   • 15-20% MVC: 用于检测中等激活 (推荐)                                        │
│   • 30%+ MVC: 用于检测强力激活                                                │
│                                                                              │
│   示例 (MVC=800μV):                                                           │
│   • 10% MVC 阈值 = 800 × 0.10 = 80 μV                                         │
│   • 20% MVC 阈值 = 800 × 0.20 = 160 μV                                        │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

**MVC 校准流程**：

```text
用户校准步骤:

┌──────────────────────────────────────────────────────────────┐
│  1. "请用最大力气握拳 3 秒"                                   │
│     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓ 100%                               │
│                                                              │
│  2. "放松..."                                                 │
│                                                              │
│  3. "再做一次最大握拳"                                        │
│     ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓ 100%                               │
│                                                              │
│  4. 取两次峰值的平均 → MVC 参考值                              │
└──────────────────────────────────────────────────────────────┘
```

**优点**: 归一化不同用户的信号强度，更公平地比较

**缺点**: 需要额外校准步骤，用户可能没有真正使出 100% 力量

---

### 4.3 方法三：贝叶斯法 Bayesian Method

**原理**：使用概率模型，考虑"在给定信号强度下，肌肉激活的概率"

```text
┌─────────────────────────────────────────────────────────────────────────────┐
│                         贝叶斯方法 (简化解释)                                 │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   核心问题:                                                                   │
│   "看到这个信号值，肌肉真正激活的概率是多少？"                                  │
│                                                                              │
│   P(激活 | 信号=X) = P(信号=X | 激活) × P(激活) / P(信号=X)                   │
│                                                                              │
│   通俗理解:                                                                   │
│   ─────────────────────────────────────────────────────────────────────     │
│   • 信号值 = 50μV → 激活概率 5% (可能只是噪声)                                │
│   • 信号值 = 100μV → 激活概率 60%                                            │
│   • 信号值 = 200μV → 激活概率 95% (几乎肯定激活)                              │
│                                                                              │
│   优势:                                                                       │
│   • 自动适应不同用户                                                          │
│   • 考虑历史数据 (这个用户通常的激活模式)                                      │
│   • 更少误报                                                                  │
│                                                                              │
│   劣势:                                                                       │
│   • 计算复杂                                                                  │
│   • 需要足够的训练数据                                                        │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

### 4.4 方法对比

| 方法 | 英文 | 优点 | 缺点 | 适用场景 |
|------|------|------|------|---------|
| **标准差法** | SD Method | 简单快速 | 固定阈值 | 快速原型、MVP |
| **%MVC法** | %MVC Method | 用户间可比 | 需校准 | 研究/临床 |
| **贝叶斯法** | Bayesian Method | 自适应 | 计算复杂 | 高精度系统 |

**MVP 推荐**：使用 **2-3 SD 方法** 作为起点，如果误报多则调整。

---

## 第五章：消抖 Debounce {#debounce}

### 5.1 问题：抖动和假阳性

**问题描述**：信号在阈值附近来回跳动，导致多次误触发

```text
信号强度 (μV)
▲
│
│                ╱╲     ╱╲
│               ╱  ╲   ╱  ╲
│              ╱    ╲ ╱    ╲
│─ ─ ─ ─ ─ ─ ─X─ ─ ─X─ ─ ─ ─X─ ─ ─ ─ ─ ─ ─ ─ ← 阈值线
│            ╱╲    ╱ ╲    ╱ ╲
│∿∿∿∿∿∿∿∿∿∿∿╱  ╲  ╱   ╲  ╱   ╲∿∿∿∿∿∿∿∿∿∿∿
│
└──────────────────────────────────────────────────► 时间
            ↑    ↑     ↑
            触发1 触发2  触发3
            (真)  (假)   (假)

问题：信号在阈值附近波动，产生多次"激活"判断！
```

这就像开关的"抖动" — 按一下按钮，电路可能触发好几次。

---

### 5.2 解决方案：Debounce 算法

**Debounce (消抖)** = 要求信号**持续**超过阈值一段时间才算真正激活

```text
┌─────────────────────────────────────────────────────────────────────────────┐
│                         Debounce 消抖原理                                    │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   规则: 信号必须连续 N 个采样点都超过阈值，才判定为"激活"                        │
│                                                                              │
│   常用参数:                                                                   │
│   • N = 10 个采样点 @ 1000Hz → 10ms 持续时间                                  │
│   • N = 20 个采样点 @ 1000Hz → 20ms 持续时间                                  │
│                                                                              │
│   示例 (N=5):                                                                │
│                                                                              │
│   采样点:  1  2  3  4  5  6  7  8  9  10 11 12 13 14 15                      │
│   信号值: [▬][▬][▬][▬][□][▬][▬][▬][▬][▬][▬][▬][▬][▬][▬]                      │
│           ↑─────────↑  ↑──────────────────────────────↑                      │
│           连续4个     中断    连续10个 (超过5个，确认激活!)                     │
│           (不够5个)                                                          │
│                       ↓                                                      │
│                      onset = 采样点 6                                        │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

**关键参数**:

| 参数 | 英文 | 推荐值 | 说明 |
|------|------|--------|------|
| 消抖时间 | `debounce_ms` | 10-20 ms | 必须持续超过阈值的时间 |

**类比**：

> 消抖就像确认门铃是否有人按 — 如果门铃响了一下就停，可能是误触。
> 但如果持续响了 2 秒，那肯定是有人在按门铃。

---

## 第六章：相位检测原理 {#phase-detection}

### 6.1 IMU 如何检测挥杆阶段

**IMU (Inertial Measurement Unit)** = 惯性测量单元，包含：

- **陀螺仪 (Gyroscope)**: 测量旋转速度 (°/s)
- **加速度计 (Accelerometer)**: 测量线性加速度 (m/s²)

高尔夫挥杆的不同阶段有明显不同的 IMU 特征：

```text
┌─────────────────────────────────────────────────────────────────────────────┐
│                         IMU 在挥杆各阶段的信号特征                            │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   陀螺仪 Z 轴角速度 (°/s):                                                    │
│                                                                              │
│         ▲                                                                    │
│    +600 │            上杆中                                                  │
│         │           ╱    ╲                                                   │
│         │          ╱      ╲                                                  │
│    +300 │         ╱        ╲                                                 │
│         │        ╱          ╲                                                │
│       0 ├───────╱────────────╲───────────────────────╮                      │
│         │                     ╲           ╱          ╲                      │
│    -300 │                      ╲         ╱            ╲                     │
│         │                       ╲       ╱              ╲                    │
│    -600 │                        ╲     ╱                ╲                   │
│         │                         ╲   ╱                  ╲                  │
│   -1200 │                          ╲╱ ← Impact            ╲                 │
│         │                           ↑                      ╲                │
│         │                       峰值角速度                   收杆             │
│         └─────────────────────────────────────────────────────────► 时间    │
│                                                                              │
│   阶段:  [准备] [上杆]    [顶点]  [下杆]  [击球]  [收杆]                        │
│            ↑       ↑        ↑       ↑       ↑       ↑                        │
│          静止   正向旋转  零交叉  负向加速  负峰值  减速                        │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

### 6.2 零交叉检测 Zero-Crossing Detection {#zero-crossing}

**零交叉 (Zero-Crossing)** = 信号从正变负或从负变正的瞬间

**用途**：检测 **Top of Backswing (上杆顶点)**

```text
角速度
▲
│
│           ╱╲
│          ╱  ╲
│         ╱    ╲
│        ╱      ╲
│       ╱        ╲
│      ╱          ╲
0 ────X────────────X────────────────────────────
│                   ╲          ╱
│                    ╲        ╱
│                     ╲      ╱
│                      ╲    ╱
│                       ╲  ╱
│                        ╲╱
└──────────────────────────────────────────► 时间
      ↑                 ↑
   起杆零交叉        顶点零交叉
   (开始上杆)        (转换方向)
```

**检测逻辑**：找到信号从正变负（或负变正）的时刻

---

### 6.3 峰值速度检测 Peak Velocity Detection

**峰值速度 (Peak Velocity)** = 下杆过程中的最大角速度

**用途**：检测 **Impact (击球/峰值时刻)**

```text
┌─────────────────────────────────────────────────────────────────────────────┐
│                         峰值速度检测                                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   峰值角速度是评估挥杆力量的关键指标:                                           │
│                                                                              │
│   • 业余球手: ~600-800 °/s                                                   │
│   • 职业球手: ~1000-1500 °/s                                                 │
│   • PGA Tour 平均: ~1200 °/s                                                 │
│                                                                              │
│   检测方法:                                                                   │
│   1. 找到下杆区间 (顶点零交叉之后)                                             │
│   2. 在下杆区间内找最大绝对值                                                  │
│                                                                              │
│   重要: Impact 定义为峰值角速度时刻，无论有没有球都适用                          │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 第七章：时间同步 {#time-sync}

### 7.1 为什么需要时间同步？

我们的系统有三种传感器，采样率不同：

| 传感器 | 采样率 | 每秒数据点 |
|--------|--------|-----------|
| Vision (相机) | 30 Hz | 30 帧 |
| IMU | 1666 Hz | 1666 个数据点 |
| EMG | 1000 Hz | 1000 个数据点 |

**问题**：如何确保这三个传感器的数据在"时间上对齐"？

```text
┌─────────────────────────────────────────────────────────────────────────────┐
│                         时间同步问题示意                                      │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   Vision (30Hz):    ├───────────┼───────────┼───────────┼                   │
│                     0ms         33ms        66ms        100ms               │
│                                                                              │
│   IMU (1666Hz):     ├┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼      │
│                     每 0.6ms 一个采样点                                       │
│                                                                              │
│   EMG (1000Hz):     ├─┼─┼─┼─┼─┼─┼─┼─┼─┼─┼─┼─┼─┼─┼─┼─┼─┼─┼─┼─┼─┼─┼─          │
│                     每 1ms 一个采样点                                         │
│                                                                              │
│   问题:                                                                       │
│   • Impact 发生在 IMU 时间 45.6ms                                             │
│   • Vision 最近的帧是 33ms 或 66ms — 偏差高达 12ms!                            │
│   • 如何对齐分析？                                                            │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

### 7.2 解决方案：插值 Interpolation {#interpolation}

**插值 (Interpolation)** = 在已知数据点之间估算未知时刻的值

```text
┌─────────────────────────────────────────────────────────────────────────────┐
│                         线性插值示意                                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   已知: t=0ms 时 X-Factor = 30°                                              │
│         t=33ms 时 X-Factor = 42°                                             │
│                                                                              │
│   问题: t=20ms 时 X-Factor = ?                                               │
│                                                                              │
│   X-Factor                                                                   │
│   ▲                                                                          │
│   │                              ● 42° (已知)                                │
│   │                            ╱                                             │
│   │                          ╱                                               │
│   │                        ╱                                                 │
│   │                      ● 37.3° (插值估算)                                  │
│   │                    ╱                                                     │
│   │                  ╱                                                       │
│   │  ● 30° (已知) ╱                                                         │
│   └──────────────────────────────────────────────────────────────► 时间     │
│      0ms        20ms         33ms                                            │
│                                                                              │
│   计算: 37.3° = 30° + (42° - 30°) × (20ms / 33ms)                           │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

### 7.3 多传感器对齐策略

**策略**：以最高采样率传感器 (IMU) 为基准

```text
┌─────────────────────────────────────────────────────────────────────────────┐
│                         多传感器时间对齐流程                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   Step 1: 选择基准时钟                                                        │
│   ─────────────────────────────────────────────────────────────────────     │
│   IMU (1666Hz) 作为主时钟 — 精度最高                                          │
│                                                                              │
│   Step 2: 上采样低频数据                                                      │
│   ─────────────────────────────────────────────────────────────────────     │
│   • Vision (30Hz) → 插值到 1666Hz                                            │
│   • EMG (1000Hz) → 插值到 1666Hz                                             │
│                                                                              │
│   Step 3: 事件对齐 (Impact 同步)                                              │
│   ─────────────────────────────────────────────────────────────────────     │
│   使用 Impact 瞬间作为"锚点":                                                 │
│   • IMU: 检测峰值角速度时刻                                                   │
│   • Vision: 检测球杆与球接触帧                                                │
│   • EMG: 检测前臂峰值激活时刻                                                  │
│                                                                              │
│   如果三者 Impact 检测有偏差 (>5ms)，调整时间偏移                              │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

**Sensor Hub 架构的优势**：

> 我们的系统使用 ESP32 作为 Sensor Hub，同一块 ESP32 同时采集 IMU 和 EMG。
> 这意味着 **IMU 和 EMG 共享同一个时钟**，硬件级别实现微秒级同步。
> 只有 Vision 需要软件对齐。

---

## 术语参考表 Terminology Reference

| 中文 | 英文 | 关键词 | 一句话解释 |
|------|------|--------|-----------|
| 肌电图 | EMG (Electromyography) | `EMG`, `muscle signal` | 测量肌肉收缩时的电活动 |
| 基线 | Baseline | `baseline`, `resting` | 放松状态下信号的平均值 |
| 激活检测 | Onset Detection | `onset`, `activation` | 检测肌肉开始工作的精确时间 |
| 标准差 | Standard Deviation (SD) | `SD`, `sigma`, `σ` | 数据围绕均值的离散程度 |
| 最大自主收缩 | MVC (Max Voluntary Contraction) | `MVC`, `maximum` | 用户能产生的最大肌肉力量 |
| 消抖 | Debounce | `debounce`, `持续时间` | 要求信号持续超过阈值才算有效 |
| 零交叉 | Zero-Crossing | `zero-crossing` | 信号从正变负或负变正的瞬间 |
| 峰值速度 | Peak Velocity | `peak`, `maximum velocity` | 下杆过程中的最大角速度 |
| 插值 | Interpolation | `interpolation` | 在已知点之间估算未知点的值 |
| 时间同步 | Time Synchronization | `sync`, `alignment` | 确保多传感器数据在时间上对应 |
| 采样率 | Sampling Rate | `Hz`, `frequency` | 每秒采集的数据点数量 |
| 阈值 | Threshold | `threshold` | 区分噪声和真信号的分界值 |
| 运动伪影 | Motion Artifact | `artifact`, `noise` | 由运动而非肌肉产生的干扰信号 |
| 贝叶斯 | Bayesian | `Bayesian`, `probability` | 基于概率的自适应检测方法 |

---

## 参数速查表 Parameter Quick Reference

| 参数 | 英文 | 推荐值 | 用途 |
|------|------|--------|------|
| `baseline_window_ms` | Baseline Window | 200-500 ms | 采集静息数据的时长 |
| `onset_threshold_sd` | Onset Threshold | 2-3 SD | 激活阈值 (标准差倍数) |
| `debounce_ms` | Debounce Duration | 10-20 ms | 防抖持续时间 |
| `timestamp_us` | Timestamp | int64 | 微秒级时间戳 (ESP32) |

---

## 下一步

掌握这些信号处理基础后，你可以：

1. 阅读 [传感器指标映射](../../design/architecture/sensor-metric-mapping.md) — 理解检测算法的实现
2. 阅读 [挥杆阶段](../../design/specs/swing-phases.md) — 理解如何应用相位检测
3. 阅读 [生物力学基准值](biomechanics-benchmarks.md) — 了解阈值从何而来

---

**最后更新**: 2025-12-26
