# 可视化工具评估

> **核心结论**: 选择 **Rerun** 作为开发调试工具，**TAPIR** 作为 Phase 4+ 球杆追踪技术储备

---

## 1. Rerun: 为什么它对我们至关重要

### 1.1 解决的核心问题

我们的系统需要同时处理三种数据流：**视频 (MediaPipe)** + **IMU (1666Hz)** + **EMG (1000Hz)**。

**调试时的痛点**:

```text
❌ 没有 Rerun 时:
┌─────────────────────────────────────────────────────────────────────────┐
│  问题: "为什么这一帧的 X-Factor 计算错误？"                               │
│                                                                          │
│  MediaPipe 输出  →  JSON 文件  →  手动分析                               │
│  IMU 数据       →  CSV 导出   →  Excel 绘图                              │
│  EMG 数据       →  另一个 CSV →  另一个图表                              │
│                                                                          │
│  结果: 三个独立视图，无法同步对齐，找问题像大海捞针                        │
└─────────────────────────────────────────────────────────────────────────┘

✅ 有 Rerun 时:
┌─────────────────────────────────────────────────────────────────────────┐
│  所有数据在同一个界面、同一条时间轴上                                     │
│                                                                          │
│  拖动时间轴到 "击球瞬间":                                                │
│    → 视频画面显示骨架叠加                                                │
│    → IMU 曲线显示此刻角速度峰值                                          │
│    → EMG 曲线显示核心肌群激活                                            │
│    → 一眼看出哪个传感器数据异常                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

### 1.2 对我们项目的具体价值

| 我们需要做什么 | Rerun 如何帮助 |
|---------------|----------------|
| **调试 MediaPipe 姿态检测** | 官方 human_pose_tracking 示例，33 关键点 + 骨架线自动渲染 |
| **验证 IMU 时间同步** | 1666Hz 角速度曲线与视频帧对齐，一眼看出延迟 |
| **分析 EMG 肌肉激活** | 1000Hz 信号与动作阶段对齐，验证"核心先启动"规则 |
| **调优规则引擎阈值** | 录制 .rrd 文件，反复回放同一挥杆，精调参数 |
| **团队协作** | 保存问题录制分享给队友，无需复现环境 |

### 1.3 为什么不选其他工具

| 工具 | 排除原因 |
|------|----------|
| **Foxglove** | 2024年3月**闭源**，免费版限制多，$18-100/月 |
| **RViz2** | 需要 ROS2 基础设施，我们不是机器人项目 |
| **PlotJuggler** | 仅时序数据，无法显示视频和骨架 |
| **自己写** | 开发成本高，不如用成熟工具 |

### 1.4 Rerun 技术亮点

```text
┌─────────────────────────────────────────────────────────────────────────┐
│                          Rerun 核心优势                                  │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  🎯 多模态同步                                                           │
│     Vision + IMU + EMG 在同一时间轴上，拖动即同步                        │
│                                                                          │
│  🎯 MediaPipe 原生支持                                                   │
│     官方示例: human_pose_tracking (33 关键点 + 骨架线)                   │
│     在线体验: rerun.io/examples/video-image/human_pose_tracking         │
│                                                                          │
│  🎯 高频时序数据                                                         │
│     支持 kHz 级别数据 (我们的 1666Hz IMU、1000Hz EMG 绑绑有余)           │
│                                                                          │
│  🎯 完全开源                                                             │
│     MIT + Apache 2.0，无需担心许可证变更                                 │
│     (对比: Foxglove 2024年闭源)                                          │
│                                                                          │
│  🎯 活跃开发                                                             │
│     $20.4M 融资 (2025年3月 $17M)，8,700+ GitHub stars                   │
│                                                                          │
│  🎯 简单集成                                                             │
│     Python SDK: pip install rerun-sdk                                    │
│     3 行代码开始: rr.init() → rr.log() → 完成                           │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

### 1.5 我们如何使用

#### Phase 1: 验证 (2-4 小时)

```bash
pip install rerun-sdk
python -m rerun_demos.human_pose_tracking
```

运行官方示例，确认 MediaPipe 姿态可视化效果

#### Phase 2: MVP 集成

在我们的 Python 原型代码中添加 `rr.log()` 调用，实现:

- 视频帧 + MediaPipe 骨架叠加
- IMU 角速度曲线
- EMG 肌肉激活曲线
- 计算指标 (X-Factor, 挥杆速度等)

#### Phase 3: 团队工作流

- 录制 `.rrd` 文件保存问题挥杆
- 分享给团队成员协作调试
- 用于规则引擎阈值调优

---

## 2. TAPIR: 未来的球杆追踪能力 (Phase 4+)

### 2.1 发现这个技术的背景

在研究 Rerun 时，发现他们有一个 TAPIR 集成示例，演示了追踪网球运动员的任意点。

**关键洞察**: TAPIR 可以追踪视频中**任何你指定的点**，不只是人体关键点。

### 2.2 TAPIR 是什么

**TAPIR** = **T**racking **A**ny **P**oint with per-frame **I**nitialization and temporal **R**efinement

| 方面 | 说明 |
|------|------|
| **开发者** | Google DeepMind + UCL + Oxford |
| **发布** | ICCV 2023 |
| **论文** | [arXiv:2306.08637](https://arxiv.org/abs/2306.08637) |
| **代码** | [google-deepmind/tapnet](https://github.com/google-deepmind/tapnet) (开源) |
| **Rerun 集成** | [rerun-io/tapnet](https://github.com/rerun-io/tapnet) |

### 2.3 TAPIR vs MediaPipe: 关键区别

```text
┌─────────────────────────────────────────────────────────────────────────┐
│                     MediaPipe vs TAPIR                                   │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  MediaPipe Pose:                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  ✅ 自动检测人体 33 个关键点 (肩膀、手腕、髋部...)               │    │
│  │  ✅ 无需手动指定，模型知道"人体长什么样"                         │    │
│  │  ❌ 只能追踪人体 — 无法追踪球杆、高尔夫球                        │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                          │
│  TAPIR:                                                                  │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  ✅ 追踪你点击的任意点 — 球杆头、高尔夫球、手套 logo...          │    │
│  │  ✅ 在第一帧点击位置，自动追踪整个视频                           │    │
│  │  ✅ 实时性能: 256 点 @ 40fps (现代 GPU)                         │    │
│  │  ❌ 不理解"人体结构"，需要手动指定追踪点                         │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                          │
│  结论: 两者互补，不是替代关系                                           │
│        MediaPipe = 人体姿态                                              │
│        TAPIR = 球杆、球等非人体物体                                      │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

### 2.4 对我们项目的潜在价值

**TAPIR 能让我们做到什么？**

| 追踪目标 | 可提取指标 | 竞品方案 | 竞品价格 |
|----------|-----------|----------|----------|
| **球杆头** | 杆头速度、攻击角、杆路 | Trackman 雷达 | $5,000-25,000 |
| **高尔夫球** | 起飞角、球速、旋转方向 | Launch Monitor | $2,000-15,000 |
| **手套标记** | 精确手部轨迹 | GEARS 动捕 | $10,000+ |

**核心价值**: 用**软件**实现 Trackman 的**部分功能**，无需昂贵雷达硬件

```text
┌─────────────────────────────────────────────────────────────────────────┐
│                   竞品对比: 球杆追踪方案                                  │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  Trackman / Foresight (雷达):                                           │
│    ✅ 精度高 (毫米级)                                                   │
│    ❌ 价格: $5,000 - $25,000                                            │
│    ❌ 需要专用硬件                                                      │
│                                                                          │
│  GEARS (动作捕捉):                                                      │
│    ✅ 全身 + 球杆 3D 追踪                                               │
│    ❌ 价格: $10,000+                                                    │
│    ❌ 需要专业场地 + 标记服                                             │
│                                                                          │
│  Sportsbox AI / OnForm (竞品):                                          │
│    ✅ 手机视频分析                                                      │
│    ❌ 只有人体姿态，没有球杆追踪                                        │
│                                                                          │
│  Movement Chain AI + TAPIR (我们):                                      │
│    ✅ 手机视频 + TAPIR 球杆追踪                                         │
│    ✅ 开源免费                                                          │
│    ✅ 差异化: 竞品都没有球杆追踪                                        │
│    ⚠️ 精度待验证 (需要高帧率视频)                                       │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

### 2.5 为什么放在 Phase 4+

| 原因 | 说明 |
|------|------|
| **需要高帧率视频** | 球杆头速度可达 100+ mph，普通手机 30fps 会模糊，需要 120fps+ |
| **增加系统复杂度** | MVP 阶段应聚焦核心功能 (MediaPipe + IMU + EMG) |
| **已有足够差异化** | IMU + EMG 传感器融合已经是市场独特卖点 |
| **技术成熟度** | TAPIR 在高尔夫场景的精度需要验证 |

### 2.6 未来集成路线

```text
Phase 4 路线图:

1. 验证可行性
   - 用 iPhone Pro 拍摄 120fps 慢动作视频
   - 运行 TAPIR 追踪球杆头
   - 评估精度是否满足需求

2. 如果可行，添加功能
   - 球杆头轨迹可视化
   - 攻击角计算
   - 杆路 (inside-out / outside-in) 检测

3. 与现有系统融合
   - MediaPipe (人体) + TAPIR (球杆) + IMU + EMG
   - 四模态数据同步分析
```

---

## 3. 技术路线图总结

| 阶段 | 工具/技术 | 目的 |
|------|----------|------|
| **Phase 1 (MVP)** | MediaPipe + IMU + EMG | 核心传感器融合 |
| **Phase 2 (V1.1)** | **Rerun** 集成 | 开发调试可视化 |
| **Phase 3 (V1.x)** | 规则引擎优化 | 阈值调优、精度提升 |
| **Phase 4+ (Future)** | **TAPIR** 球杆追踪 | 高级功能、差异化 |

---

## 附录 A: Rerun 技术规格

| 属性 | 值 |
|------|-----|
| **许可证** | MIT + Apache 2.0 (完全开源) |
| **SDK** | Python, Rust, C++ |
| **GitHub Stars** | 8,700+ |
| **最新融资** | $17M Seed (2025年3月, Point Nine 领投) |
| **总融资** | $20.4M |
| **性能** | 时序数据 20-30x 提速 (v0.13) |

**在线体验**: [Human Pose Tracking Demo](https://rerun.io/viewer?url=https%3A%2F%2Fapp.rerun.io%2Fversion%2F0.27.3%2Fexamples%2Fhuman_pose_tracking.rrd)

---

## 附录 B: 竞品工具对比

### Foxglove (不推荐)

| 属性 | 值 |
|------|-----|
| **许可证** | 2024年3月起**闭源** |
| **价格** | $0 (限制版) / $18-100/user/月 |
| **融资** | $58.7M ($40M B轮, 2025年11月) |
| **适用场景** | ROS 团队、企业合规需求 |
| **不选原因** | 闭源、付费、无体育/生物力学支持 |

### 其他工具

| 工具 | 适用场景 | 不选原因 |
|------|----------|----------|
| **PlotJuggler** | 时序数据调试 | 无视频/骨架支持 |
| **RViz2** | ROS2 机器人 | 需要 ROS2 基础设施 |
| **Open3D** | 3D 点云处理 | 是库不是应用 |
| **Kinovea** | 体育视频分析 | 无多模态同步 |

---

## 附录 C: 参考链接

### Rerun

- [官网](https://rerun.io/)
- [GitHub](https://github.com/rerun-io/rerun)
- [人体姿态示例](https://rerun.io/examples/video-image/human_pose_tracking)
- [文档](https://rerun.io/docs)

### TAPIR

- [论文 (arXiv)](https://arxiv.org/abs/2306.08637)
- [DeepMind 官方页面](https://deepmind-tapir.github.io/)
- [GitHub (google-deepmind/tapnet)](https://github.com/google-deepmind/tapnet)
- [Rerun 集成](https://github.com/rerun-io/tapnet)
- [技术博客: 空间智能](https://deepmind-tapir.github.io/blogpost.html)

---

**最后更新**: 2025年12月19日
