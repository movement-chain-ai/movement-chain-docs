# 硬件工程师 Brief

**目标人群**: 嵌入式/电子工程师
**阅读时间**: 45 分钟
**目标**: 评估可行性 + 设计传感器原型

---

## ⚠️ 时间线说明

硬件工作在软件 MVP 验证后开始 (约 4-6 周后)。

**现阶段任务**: 评估可行性 + 准备物料清单

---

## 你需要做什么 (Tasks)

### Phase 1: 可行性评估 (现在)

1. 评估 LSM6DSV16X IMU 方案可行性
   - BLE 能否稳定传输 100Hz × 6轴 IMU 数据?
   - 传感器精度是否满足高尔夫挥杆分析?

2. 评估 EMG 采集方案
   - DFRobot SEN0240 (1通道, ¥319)
   - OYMotion gForce (8通道, ¥3,000-5,000)
   - EMG 信噪比在运动场景下可接受吗?

3. 评估 ESP32-S3 BLE 数据传输协议
   - BLE 5.0 吞吐量: 800-1200 kbps
   - 数据量估算: 100Hz × 6轴 × 2字节/轴 = 7.2KB/s
   - 有 10 倍余量，理论可行

4. 电池续航估算是否准确?
   - 活动电流: 20-30mA (BLE 传输)
   - 500mAh 电池 → 约 5 小时连续使用
   - 目标: 每次充电支持 5 小时训练

5. PCB 尺寸能否控制在手腕佩戴范围?
   - 目标尺寸: 50mm × 70mm × 15mm
   - 参考: Apple Watch (40mm × 34mm × 10.7mm)

### Phase 2: Dev 板验证 (软件 MVP 后)

- 使用 ESP32-S3-DevKitC-1 + DFRobot SEN0240
- 验证 BLE 传输稳定性
- 测试 EMG 信号质量

### Phase 3: Works-like 原型 (Phase 2 后)

- 设计 PCB (4层板, 50×70mm)
- 集成 LSM6DSV16X + EMG + ESP32-S3
- 制作可穿戴外壳 (3D 打印)

---

## 硬件规格

### 核心传感器

| 组件 | 型号 | 规格 | 用途 |
|-----|------|-----|------|
| **IMU** | LSM6DSV16X | 6轴, 100-200Hz, I²C/SPI | 手腕角速度/加速度 |
| **EMG** | DFRobot SEN0240 | 1-2 通道, 1000Hz, 模拟 | 前臂肌肉激活 |
| **MCU** | ESP32-S3-WROOM-1-N8R8 | 双核 240MHz, BLE 5.0 | 数据采集和传输 |
| **电池** | LiPo 3.7V | 500mAh | 目标 5h 续航 |

### 性能要求

| 参数 | 要求 | 说明 |
|-----|------|------|
| **IMU 采样率** | 100-200Hz | 捕捉高速挥杆 (1500-2500 dps) |
| **EMG 采样率** | 1000Hz | 肌肉信号频段 20-450Hz |
| **BLE 吞吐量** | 7.2KB/s | 100Hz × 6轴 × 12 字节/包 |
| **延迟** | <50ms | 实时反馈要求 |
| **续航** | 5 小时 | 连续训练场景 |
| **工作温度** | 0-50°C | 户外使用 |

---

## 关键文档 (必读)

### 硬件选型决策 (⭐ 必读)

- [ADR-0002: LSM6DSV16X IMU 选型](../decisions/0002-lsm6dsv16x-imu.md)
  - **为什么选 LSM6DSV16X**: 45+ 分钟漂移稳定性，内置 MLC 机器学习核心
  - **对比方案**: ICM-42688-P, BMI270, MPU6050

- [ADR-0005: ESP32-S3 微控制器选型](../decisions/0005-esp32-s3-microcontroller.md)
  - **为什么选 ESP32-S3**: BLE 5.0 + WiFi 双模，240MHz 双核，8MB PSRAM
  - **对比方案**: nRF52840, STM32WB55, ESP32-C3

### 详细硬件规格

- [IMU 详细规格](../../components/imu/hardware.md)
  - LSM6DSV16X 技术参数
  - WitMotion WT901BLECL 开发板 (MVP 首选)
  - BLE GATT 数据格式

- [EMG 详细规格](../../components/emg/hardware.md)
  - DFRobot SEN0240 vs OYMotion gForce 对比
  - 电极配置和信号处理
  - 肌肉激活检测算法

- [MCU 详细规格](../../components/mcu/hardware.md)
  - ESP32-S3 技术参数
  - BLE 通信协议设计
  - 电源管理策略
  - **MVP 物料清单 (BOM)** ← 成本估算

### 采样率要求

- [传感器指标映射](../research/sensor-metric-mapping.md)
  - IMU 100Hz 用于运动链时序 (<10ms 精度)
  - EMG 1000Hz 用于肌肉激活检测 (<5ms 精度)
  - Vision 30fps 用于身体角度测量

---

## 需要你评估的问题

### 1. BLE 传输可行性

**问题**: BLE 能否稳定传输 100Hz × 6轴 IMU 数据?

**数据量估算**:

```text
IMU 数据包格式 (20 bytes):
├── Timestamp (4 bytes)
├── AccX/Y/Z (6 bytes, int16_t)
├── GyroX/Y/Z (6 bytes, int16_t)
└── Reserved (4 bytes)

传输速率:
100Hz × 20 bytes = 2KB/s (IMU)
+ 1000Hz × 12 bytes = 12KB/s (EMG × 2 通道)
= 14KB/s 总数据量

BLE 5.0 吞吐量: 800-1200 kbps = 100-150KB/s
余量: 150KB/s / 14KB/s ≈ 10倍
```

**结论**: 理论可行，需实测验证稳定性

### 2. EMG 信噪比

**问题**: EMG 信噪比在运动场景下可接受吗?

**挑战**:

- 运动伪影 (加速度导致电极移动)
- 汗水影响电极阻抗
- 工频干扰 (50/60Hz)

**缓解措施**:

- 使用 Ag/AgCl 干电极 (降低皮肤阻抗)
- 带通滤波 20-450Hz (去除工频)
- 陷波滤波 50Hz (二次去噪)
- 仪表放大器 INA128 (CMRR >100dB)

**需实测验证**:

- 挥杆过程中信号是否稳定?
- 能否清晰检测肌肉激活时序?

### 3. 电池续航

**问题**: 500mAh 电池能否支持 5 小时连续使用?

**功耗分解**:

```text
组件功耗:
├── ESP32-S3 (BLE 活动): 20-30mA
├── LSM6DSV16X (100Hz): 0.55mA
├── EMG 放大器 × 2: 2-5mA
└── 总计: 25-35mA

续航估算:
500mAh / 30mA = 16.7 小时 (理论值)

实际场景:
- 活动训练 (1h): 30mA × 1h = 30mAh
- 轻睡眠 (4h): 2mA × 4h = 8mAh
- 总消耗: 38mAh/天
- 预期续航: 500mAh / 38mAh ≈ 13 天
```

**结论**: 续航充足，远超 5 小时目标

### 4. PCB 尺寸

**问题**: PCB 能否控制在手腕佩戴范围?

**组件尺寸**:

| 组件 | 尺寸 (mm) |
|-----|----------|
| ESP32-S3-WROOM-1 | 18 × 25.5 × 3.1 |
| LSM6DSV16X | 2.5 × 3.0 × 0.83 |
| INA128 (EMG 放大器) × 2 | 5 × 5 (SOT-23) |
| LiPo 电池 (500mAh) | 30 × 40 × 5 |
| PCB (目标) | 50 × 70 × 1.6 |

**布局挑战**:

- ESP32-S3 天线需要 10mm 禁入区
- 电池需要独立隔间 (防止压力损坏)
- EMG 放大器需要远离数字电路 (降低干扰)

**建议**: 4 层板设计 (内层用于地平面和电源层)

---

## BOM 估算 (供参考)

详细 BOM 见 [MCU 详细规格](../../components/mcu/hardware.md)

| 组件 | 零件号 | 数量 | 单价 | 总计 |
|-----|-------|-----|------|------|
| **ESP32-S3 模块** | ESP32-S3-WROOM-1-N8R8 | 1 | $3.50 | $3.50 |
| **IMU 传感器** | LSM6DSV16X | 1 | $6.50 | $6.50 |
| **EMG 放大器** | INA128 | 2 | $3.00 | $6.00 |
| 干电极 | Ag/AgCl 织物 | 4 | $5.00 | $20.00 |
| 触觉电机 | ERM 振动电机 | 2 | $2.50 | $5.00 |
| LiPo 电池 | 500mAh 3.7V | 1 | $4.00 | $4.00 |
| 电池充电器 | MCP73831 | 1 | $0.50 | $0.50 |
| LDO 稳压器 | TPS73633 (3.3V) | 1 | $1.00 | $1.00 |
| 无源器件 | 电阻、电容等 | - | - | $5.00 |
| PCB | 4层 50×70mm | 1 | $15.00 | $15.00 |
| 外壳 | 3D 打印 | 1 | $8.00 | $8.00 |
| **总 BOM 成本** | | | | **$74.50** |

**注意**:

- 以上为小批量 (10-100 件) 估算
- 量产 (1000+ 件) 可降低 30-40%
- 不含开发板测试成本

---

## 预估工作量

| 阶段 | 任务 | 工作量 | 开始时间 |
|-----|------|-------|---------|
| **Phase 1** | 可行性评估 | 1 周 | 现在 |
| **Phase 2** | Dev 板验证 | 2 周 | 软件 MVP 后 (4-6 周) |
| **Phase 3** | Works-like 原型 | 4 周 | Phase 2 后 |

**Phase 1 任务分解**:

- [ ] 阅读 ADR-0002, ADR-0005 (2h)
- [ ] 阅读硬件规格文档 (4h)
- [ ] BLE 传输可行性分析 (4h)
- [ ] EMG 信噪比评估 (4h)
- [ ] 电池续航计算 (2h)
- [ ] PCB 布局规划 (4h)
- [ ] 撰写可行性报告 (4h)

**Phase 2 任务分解**:

- [ ] 采购开发板和传感器 (1 周)
- [ ] BLE 数据传输测试 (3 天)
- [ ] EMG 信号质量测试 (3 天)
- [ ] 整合测试 (1 周)

**Phase 3 任务分解**:

- [ ] PCB 设计 (Altium/KiCad) (1 周)
- [ ] PCB 打样和焊接 (1 周)
- [ ] 外壳设计和 3D 打印 (1 周)
- [ ] 功能测试和优化 (1 周)

---

## 联系方式

- **技术问题**: [Tech Lead Email]
- **采购问题**: [Operations Email]
- **项目进度**: [Project Manager Email]

---

## 下一步

1. 阅读本文档和关键 ADR (ADR-0002, ADR-0005)
2. 提出你的疑问和建议
3. 完成可行性评估报告
4. 等待软件 MVP 验证后开始 Phase 2

**预期产出 (Phase 1)**:

- 可行性评估报告 (包含以上 5 个问题的详细分析)
- 风险清单 (技术风险、供应链风险)
- 优化建议 (如有)

---

**最后更新**: 2025 年 12 月 18 日
