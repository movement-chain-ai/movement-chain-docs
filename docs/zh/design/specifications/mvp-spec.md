# MVP 规格说明书

> **文档目的**: 定义最小可行产品的技术规格，供工程团队实现
>
> **阅读对象**: 硬件工程师、软件工程师、算法工程师

---

## MVP 定义

### 核心原则

```text
MVP = 能够验证"练习↔实战闭环"价值主张的最小功能集
```

### 范围界定

| 类别 | MVP 包含 | MVP 不包含 (Phase 2+) |
|-----|---------|---------------------|
| **模式** | 训练场模式 + 简化实战模式 | 完整实战模式 (AI球童) |
| **传感器** | IMU + Vision + EMG | 智能鞋垫、E-Skin |
| **反馈** | 视觉 + 语音 | 触觉振动 |
| **AI功能** | 基础挥杆分析 + 肌肉时序 | AI球童、策略推荐 |
| **社交** | 本地历史记录 | 社交排行榜、微信分享 |
| **平台** | iOS/Android (Flutter) | Web Dashboard |

> **战略决策**: EMG 纳入 MVP 采用并行开发策略。即使 EMG 开发遇到困难，Vision + IMU 仍可独立发布。EMG 是市场唯一差异化，早期投入可建立技术壁垒。

### 成功标准

| 指标 | 目标值 | 测量方法 |
|-----|-------|---------|
| 挥杆检测准确率 | >95% | 测试集验证 |
| 反馈延迟 | <500ms | 端到端测量 |
| 用户满意度 | >4.0/5.0 | 内测反馈 |
| 日活跃度 | >50% | 7日留存 |

---

## 系统架构

### 整体架构图

```text
┌─────────────────────────────────────────────────────────────────────┐
│                        Movement Chain AI MVP                         │
├─────────────────────────────────────────────────────────────────────┤
│                                                                      │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │                      用户层 (User Layer)                      │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐          │   │
│  │  │   iOS App   │  │  训练视图   │  │  历史记录   │          │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘          │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                              ↕                                       │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │                    应用层 (Application Layer)                 │   │
│  │  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐    │   │
│  │  │ 评估模块 │→│ 诊断模块 │→│ 纠正模块 │→│ 追踪模块 │    │   │
│  │  │Assessment│  │Diagnosis │  │Correction│  │ Tracking │    │   │
│  │  └──────────┘  └──────────┘  └──────────┘  └──────────┘    │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                              ↕                                       │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │                     核心层 (Core Layer)                       │   │
│  │  ┌───────────┐  ┌───────────┐  ┌───────────┐  ┌─────────┐  │   │
│  │  │ MediaPipe │  │ IMU处理   │  │ EMG处理   │  │数据融合 │  │   │
│  │  │ 姿态估计  │  │  算法     │  │  算法     │  │  引擎   │  │   │
│  │  └───────────┘  └───────────┘  └───────────┘  └─────────┘  │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                              ↕                                       │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │                     硬件层 (Hardware Layer)                   │   │
│  │  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐        │   │
│  │  │ iPhone  │  │  IMU    │  │  EMG    │  │  BLE    │        │   │
│  │  │ (Vision)│  │ 传感器  │  │ 传感器  │  │  通信   │        │   │
│  │  └─────────┘  └─────────┘  └─────────┘  └─────────┘        │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                      │
└─────────────────────────────────────────────────────────────────────┘
```

### 数据流图

```text
┌────────────────────────────────────────────────────────────────────┐
│                         MVP 数据流 (三模态)                         │
├────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  iPhone相机 ──┐                                                    │
│   (30fps)     │      ┌──────────┐    ┌──────────┐    ┌──────────┐ │
│               ├─────→│ 数据融合  │───→│ 挥杆分析 │───→│ 反馈生成 │ │
│  IMU传感器 ──┤      │ 时间同步  │    │  引擎    │    │  引擎    │ │
│   (100Hz)     │      └──────────┘    └──────────┘    └──────────┘ │
│               │                                            ↓       │
│  EMG传感器 ──┘                                      ┌──────────┐   │
│   (200Hz)                                           │  输出    │   │
│                                                     ├──────────┤   │
│   并行开发策略:                                      │ • 3D骨架 │   │
│   • Vision + IMU: 主线路                            │ • 语音   │   │
│   • EMG: 并行开发，可独立集成                        │ • 肌肉图 │   │
│                                                     └──────────┘   │
│                                                                     │
└────────────────────────────────────────────────────────────────────┘
```

---

## 模块规格

### 模块1: 评估 (Assessment)

#### 1.1 多模态数据采集

**视觉数据采集**:

| 参数 | 规格 | 备注 |
|-----|------|------|
| 分辨率 | 1080p | iPhone原生 |
| 帧率 | 30fps | 可升至60fps |
| 视角 | 后方/侧方 | 用户选择 |
| 存储 | H.264压缩 | 本地临时存储 |

```swift
// 视觉采集配置 (伪代码)
struct VideoCaptureConfig {
    let resolution: CGSize = CGSize(width: 1920, height: 1080)
    let frameRate: Int = 30
    let codec: VideoCodec = .h264
    let orientation: CaptureOrientation = .landscape
}
```

**IMU数据采集**:

| 参数 | 规格 | 备注 |
|-----|------|------|
| 采样率 | 100Hz | 可调 |
| 轴数 | 9轴 | 加速度+陀螺仪+磁力计 |
| 精度 | 加速度±2g, 陀螺仪±2000°/s | 标定后 |
| 传输 | BLE 5.0 | 低延迟模式 |

```swift
// IMU数据结构 (伪代码)
struct IMUFrame {
    let timestamp: UInt64      // 微秒
    let accelerometer: SIMD3<Float>  // m/s²
    let gyroscope: SIMD3<Float>      // rad/s
    let magnetometer: SIMD3<Float>   // μT
    let quaternion: simd_quatf       // 姿态四元数
}
```

#### 1.2 传感器融合

**时间同步**:

```text
┌─────────────────────────────────────────────────────────────┐
│                     时间同步流程                             │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  App启动                                                     │
│     ↓                                                        │
│  NTP同步获取基准时间                                          │
│     ↓                                                        │
│  IMU连接时发送时间戳同步包                                    │
│     ↓                                                        │
│  计算时间偏移量 offset = T_app - T_imu                        │
│     ↓                                                        │
│  运行时: T_aligned = T_imu + offset                          │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

**数据对齐算法**:

| 步骤 | 方法 | 输出 |
|-----|------|------|
| 时间戳归一化 | 线性插值 | 统一时间轴 |
| 数据重采样 | 样条插值 | 30fps对齐 |
| 异常检测 | 阈值+滑窗 | 无效帧标记 |

#### 1.3 评估输出

**挥杆评分算法**:

```python
# 伪代码
def calculate_swing_score(swing_data):
    scores = {
        'tempo': calculate_tempo_score(swing_data.imu),
        'plane': calculate_plane_score(swing_data.pose),
        'sequence': calculate_sequence_score(swing_data.pose, swing_data.imu),
        'balance': calculate_balance_score(swing_data.pose)
    }

    weights = {'tempo': 0.25, 'plane': 0.30, 'sequence': 0.25, 'balance': 0.20}

    total_score = sum(scores[k] * weights[k] for k in scores)
    return total_score, scores
```

---

### 模块2: 诊断 (Diagnosis)

#### 2.1 运动链分析

**关节序列检测**:

```text
标准挥杆运动链:
髋部启动 → 躯干旋转 → 肩部旋转 → 手臂下挥 → 手腕释放

检测点:
┌────────────────────────────────────────────────────────┐
│  P1: 髋部角速度峰值 (下杆启动)                          │
│  P2: 肩部角速度峰值                                    │
│  P3: 手肘角速度峰值                                    │
│  P4: 手腕角速度峰值 (击球点)                           │
│                                                        │
│  正确顺序: P1 < P2 < P3 < P4 (时间)                    │
│  错误示例: P2 < P1 → "下杆时用肩带动，而非髋部启动"     │
└────────────────────────────────────────────────────────┘
```

**关键关节角度定义**:

| 关节 | 角度定义 | 正常范围 | 检测方法 |
|-----|---------|---------|---------|
| 髋部旋转 | 骨盆相对脊柱旋转角 | 40-60° | Vision |
| 肩部旋转 | 肩线相对骨盆线旋转角 | 90-110° | Vision |
| 手腕屈伸 | 手背与前臂夹角 | ±30° | IMU |
| 手肘角度 | 上臂与前臂夹角 | 90-180° | Vision+IMU |

#### 2.2 问题诊断规则引擎

**规则结构**:

```python
# 诊断规则示例 (伪代码)
rules = [
    {
        "id": "early_extension",
        "name": "早伸展",
        "conditions": [
            ("hip_thrust_timing", "<", "impact_time - 0.1s"),
            ("hip_distance_change", ">", "5cm")
        ],
        "severity": "high",
        "feedback": "下杆时髋部过早向球方向推进，尝试保持髋部后坐"
    },
    {
        "id": "over_the_top",
        "name": "外挥",
        "conditions": [
            ("downswing_plane", ">", "backswing_plane + 10°")
        ],
        "severity": "high",
        "feedback": "下杆轨迹偏外，尝试从内侧下杆"
    },
    {
        "id": "casting",
        "name": "抛杆",
        "conditions": [
            ("wrist_release_timing", "<", "impact_time - 0.15s"),
            ("wrist_angle_change_rate", ">", "threshold")
        ],
        "severity": "medium",
        "feedback": "手腕过早释放，尝试保持手腕角度到更晚的位置"
    }
]
```

**MVP支持的诊断项**:

| 诊断项 | 优先级 | 检测难度 | MVP状态 |
|-------|-------|---------|--------|
| 挥杆节奏 | P0 | 低 | ✅ |
| 挥杆平面 | P0 | 中 | ✅ |
| 运动链顺序 | P0 | 中 | ✅ |
| 早伸展 | P1 | 中 | ✅ |
| 外挥/内挥 | P1 | 中 | ✅ |
| 抛杆 | P1 | 高 | ✅ |
| 重心转移 | P2 | 高 | 简化版 |
| 头部移动 | P2 | 低 | ✅ |

---

### 模块3: 纠正 (Correction)

#### 3.1 实时反馈

**视觉反馈**:

```text
┌─────────────────────────────────────────────────────────────┐
│                    3D骨架叠加界面                            │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌───────────────────────────────────────────────────┐     │
│  │                                                    │     │
│  │         ○ ← 头部                                   │     │
│  │        /│\                                         │     │
│  │       / │ \                                        │     │
│  │      /  │  \ ← 肩线 (显示角度)                     │     │
│  │         │                                          │     │
│  │        ┌┴┐ ← 髋部                                  │     │
│  │       /   \                                        │     │
│  │      /     \                                       │     │
│  │                                                    │     │
│  │  [实时摄像头画面作为背景]                           │     │
│  │                                                    │     │
│  └───────────────────────────────────────────────────┘     │
│                                                              │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 挥杆速度: 95 mph  │  节奏: 3:1  │  评分: 82/100     │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

**语音反馈**:

| 触发条件 | 语音内容 | 优先级 | 延迟要求 |
|---------|---------|-------|---------|
| 检测到严重问题 | 具体纠正建议 | P0 | <300ms |
| 检测到轻微问题 | 简短提示 | P1 | <500ms |
| 动作改善 | 正向鼓励 | P2 | <1s |
| 挥杆完成 | 评分播报 | P3 | <2s |

**语音模板**:

```yaml
# 语音反馈模板
feedback_templates:
  tempo_fast:
    text: "节奏太快，试试放慢{slowdown_percent}%"
    variables: [slowdown_percent]
    priority: 1

  plane_steep:
    text: "挥杆平面太陡，注意从内侧下杆"
    variables: []
    priority: 1

  good_swing:
    text: "很好！{score}分"
    variables: [score]
    priority: 2

  improvement:
    text: "进步了！{metric}比上次好{improvement}%"
    variables: [metric, improvement]
    priority: 2
```

#### 3.2 动作回放

**回放功能规格**:

| 功能 | MVP版本 | 完整版本 |
|-----|--------|---------|
| 慢动作回放 | 0.25x-1x | 0.1x-2x |
| 3D骨架叠加 | ✅ | ✅ + 多角度 |
| 关键帧标记 | 自动4点 | 自动+手动 |
| 对比模式 | 与上次对比 | 与标准/任意对比 |
| 分享 | 视频导出 | 视频+数据导出 |

**关键帧定义**:

```text
┌────────────────────────────────────────────────────────────┐
│                    挥杆关键帧                               │
├────────────────────────────────────────────────────────────┤
│                                                             │
│  P1: Address (准备)                                         │
│      - 检测点: 静止状态 + 握杆姿势                          │
│                                                             │
│  P2: Top of Backswing (上杆顶点)                            │
│      - 检测点: 手臂角速度由正转负                            │
│                                                             │
│  P3: Impact (击球)                                          │
│      - 检测点: 手腕角速度峰值                               │
│                                                             │
│  P4: Follow Through (送杆)                                  │
│      - 检测点: 击球后500ms                                  │
│                                                             │
└────────────────────────────────────────────────────────────┘
```

---

### 模块4: 追踪 (Tracking)

#### 4.1 数据存储

**本地存储结构**:

```text
/Documents/MovementChain/
├── swings/
│   ├── 2024-01-15/
│   │   ├── swing_001.json      # 挥杆数据
│   │   ├── swing_001.mp4       # 视频
│   │   └── swing_001_analysis.json  # 分析结果
│   └── ...
├── user_profile.json           # 用户配置
├── training_plan.json          # 训练计划
└── cache/
    └── models/                 # AI模型缓存
```

**挥杆数据格式**:

```json
{
  "version": "1.0",
  "swing_id": "uuid-xxx",
  "timestamp": "2024-01-15T10:30:00Z",
  "duration_ms": 1500,
  "metadata": {
    "club": "7_iron",
    "mode": "training",
    "weather": null
  },
  "imu_data": {
    "sample_rate": 100,
    "frames": [
      {
        "t": 0,
        "acc": [0.1, 0.2, 9.8],
        "gyro": [0.01, 0.02, 0.03],
        "quat": [1, 0, 0, 0]
      }
    ]
  },
  "pose_data": {
    "frame_rate": 30,
    "keypoints": [
      {
        "t": 0,
        "joints": {
          "left_shoulder": [100, 200, 0.95],
          "right_shoulder": [150, 200, 0.93]
        }
      }
    ]
  },
  "analysis": {
    "score": 82,
    "tempo_ratio": 3.1,
    "swing_speed_mph": 95,
    "issues": ["early_extension"],
    "feedback": ["下杆时髋部过早向球方向推进"]
  }
}
```

#### 4.2 进度追踪

**追踪指标**:

| 指标类别 | 具体指标 | 计算周期 |
|---------|---------|---------|
| **基础指标** | 练习次数、时长 | 每次/日/周 |
| **技术指标** | 各项评分趋势 | 滑动平均7次 |
| **问题追踪** | 问题出现频率变化 | 周对比 |
| **稳定性** | 指标标准差 | 最近20次 |

---

## 硬件规格

### IMU可穿戴设备

#### 硬件BOM (MVP 原型阶段)

| 组件 | 型号 | 单价 (USD) | 备注 |
|-----|------|-----------|------|
| MCU | ESP32-S3 DevKit | $10.00 | 开发板 (含USB/WiFi) |
| IMU | LSM6DSV16X 模块 | $15.00 | 45+分钟低漂移，ML核心 |
| **EMG AFE** | DFRobot/MyoWare | $45.00 | 模拟前端模块 |
| **电池** | 500mAh LiPo | $5.00 | 6小时续航 |
| **外壳** | 3D打印 | $5.00 | 快速原型 |
| **连接线** | 杜邦线/线束 | $2.00 | 连接组件 |
| **总计 (原型)** | - | **~$82** | 模块化开发成本 |

#### 硬件BOM (量产目标)

| 组件 | 型号 | 单价 (USD) | 备注 |
|-----|------|-----------|------|
| MCU | ESP32-S3-WROOM | $3.50 | 芯片级集成 |
| IMU | LSM6DSV16X | $6.50 | ST高性能传感器 |
| EMG | ADS1292R + 外围 | $8.00 | 定制PCB集成 |
| PCB/PCBA | 4层板 + 贴片 | $5.00 | 1k量级预估 |
| 外壳 | 注塑 | $2.50 | 模具摊销后 |
| 电池 | 400mAh LiPo | $3.00 | 定制尺寸 |
| **总计 (量产)** | - | **~$28.50** | 目标成本 |

> **决策更新**:
>
> 1. 原型阶段使用模块化组件加速开发 (成本 ~$82)。
> 2. 量产阶段通过集成设计降低成本至 ~$28.50。
> 3. IMU 选型从 ICM-42688-P 变更为 **LSM6DSV16X**，因为后者提供优越的零漂移性能 (45+ mins vs 25 mins)。

#### 电气规格

| 参数 | 规格 |
|-----|------|
| 工作电压 | 3.3V |
| 电池容量 | 250mAh |
| 充电接口 | USB-C |
| 充电时间 | <1.5小时 |
| 续航时间 | >4小时 (连续使用) |
| 待机时间 | >30天 |

#### 机械规格

| 参数 | 规格 |
|-----|------|
| 尺寸 | 35 × 25 × 12 mm |
| 重量 | <20g |
| 防护等级 | IP54 |
| 佩戴方式 | 手套夹持/绑带 |

---

## 软件规格

### 移动 App (Flutter)

#### 技术栈

| 组件 | 技术选型 | 理由 |
|-----|---------|------|
| UI框架 | Flutter 3.x | 跨平台，40%开发成本节省 |
| 语言 | Dart | 高性能编译 |
| 视觉处理 | MediaPipe Pose | 3D姿态原生支持，快速MVP |
| AI推理 | ONNX Runtime | 跨平台模型部署 (Phase 2) |
| BLE通信 | flutter_reactive_ble | 生产级稳定性 |
| 状态管理 | Riverpod | 可测试性，解耦 |
| 数据存储 | Isar / Hive | 高性能NoSQL本地库 |

#### 性能要求

| 指标 | 目标 | 测量方法 |
|-----|------|---------|
| 启动时间 | <3s | 冷启动到可用 |
| 姿态估计延迟 | <50ms | 单帧推理 |
| 内存占用 | <500MB | 正常使用峰值 |
| 电池消耗 | <15%/小时 | 连续录制 |
| App大小 | <100MB | 含模型 |

#### 最低系统要求

| 要求 | 规格 |
|-----|------|
| iOS版本 | iOS 15.0+ |
| 设备 | iPhone 11+ |
| 存储空间 | 500MB |

---

## 接口定义

### BLE协议

#### 服务UUID

```text
Service UUID: 0x1234 (Movement Chain Service)
├── Characteristic: 0x1235 (IMU Data Stream)
│   - Properties: Notify
│   - Format: 20 bytes per packet
│   - Rate: 100Hz
│
├── Characteristic: 0x1236 (Device Status)
│   - Properties: Read, Notify
│   - Format: 4 bytes
│
├── Characteristic: 0x1237 (Command)
│   - Properties: Write
│   - Commands: START, STOP, CALIBRATE, SYNC_TIME
│
└── Characteristic: 0x1238 (Config)
    - Properties: Read, Write
    - Format: JSON string
```

#### 数据包格式

```text
IMU Data Packet (20 bytes):
┌────────────────────────────────────────────────────────┐
│ Byte 0-3:   Timestamp (uint32, ms)                     │
│ Byte 4-5:   Acc X (int16, 0.001g)                      │
│ Byte 6-7:   Acc Y (int16, 0.001g)                      │
│ Byte 8-9:   Acc Z (int16, 0.001g)                      │
│ Byte 10-11: Gyro X (int16, 0.1°/s)                     │
│ Byte 12-13: Gyro Y (int16, 0.1°/s)                     │
│ Byte 14-15: Gyro Z (int16, 0.1°/s)                     │
│ Byte 16-19: Quaternion W (float16) [可选]              │
└────────────────────────────────────────────────────────┘
```

### 内部模块接口

```swift
// 评估模块输出
protocol AssessmentOutput {
    var timestamp: Date { get }
    var imuFrames: [IMUFrame] { get }
    var poseFrames: [PoseFrame] { get }
    var swingDetected: Bool { get }
    var swingPhases: [SwingPhase] { get }
}

// 诊断模块输出
protocol DiagnosisOutput {
    var issues: [SwingIssue] { get }
    var metrics: SwingMetrics { get }
    var confidence: Float { get }
}

// 纠正模块输出
protocol CorrectionOutput {
    var visualFeedback: VisualFeedbackData { get }
    var audioFeedback: AudioFeedbackData { get }
    var score: Int { get }
}
```

---

## UI设计规格

### 关键界面清单

MVP需要设计以下5个核心界面：

| 界面 | 优先级 | 描述 |
|-----|-------|------|
| **训练主界面** | P0 | 摄像头画面 + 3D骨架叠加 + 实时数据 |
| **挥杆回放** | P0 | 慢动作回放 + 关键帧标记 |
| **历史记录** | P1 | 挥杆列表 + 筛选 |
| **挥杆详情** | P1 | 评分 + 问题诊断 + 建议 |
| **设置** | P2 | 设备连接 + 偏好设置 |

### 界面线框图

#### 1. 训练主界面

```text
┌─────────────────────────────────────────────────────────────┐
│  ◀ 返回              训练模式               ⚙️ 设置        │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌───────────────────────────────────────────────────────┐  │
│  │                                                        │  │
│  │                 [摄像头实时画面]                        │  │
│  │                                                        │  │
│  │           ○  ← 3D骨架叠加                              │  │
│  │          /│\                                           │  │
│  │         / │ \                                          │  │
│  │           │                                            │  │
│  │          / \                                           │  │
│  │                                                        │  │
│  └───────────────────────────────────────────────────────┘  │
│                                                              │
│  ┌─────────────┬─────────────┬─────────────┐               │
│  │  速度       │   节奏       │   评分      │               │
│  │  95 mph    │   3:1       │   82       │               │
│  └─────────────┴─────────────┴─────────────┘               │
│                                                              │
│                    ┌─────────────┐                          │
│                    │  ● 录制     │                          │
│                    └─────────────┘                          │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

#### 2. 挥杆回放界面

```text
┌─────────────────────────────────────────────────────────────┐
│  ◀ 返回              挥杆回放               📤 分享        │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌───────────────────────────────────────────────────────┐  │
│  │                                                        │  │
│  │                 [慢动作视频 + 骨架]                     │  │
│  │                                                        │  │
│  └───────────────────────────────────────────────────────┘  │
│                                                              │
│  ──●────────────────────────────────────────────── 0.25x   │
│    ▲准备   ▲上杆顶点   ▲击球   ▲收杆                        │
│                                                              │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  问题: 外挥                                          │   │
│  │  建议: 下杆时从内侧启动，想象球杆沿着身体右侧下来      │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                              │
│  ┌────────┐  ┌────────┐  ┌────────┐                       │
│  │ ◀◀ 慢  │  │ ▶ 播放  │  │  快 ▶▶ │                       │
│  └────────┘  └────────┘  └────────┘                       │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

### Figma AI 设计指南

#### 推荐 Prompt 模板

**训练主界面**:

```text
Design a mobile app screen for golf swing training:
- Main view: Live camera feed with 3D skeleton overlay
- Bottom panel: Three metrics (swing speed, tempo ratio, score)
- Large circular record button at bottom center
- Dark background (#1A1A2E) with green accents (#4CAF50)
- Style: Modern, clean, sports tech, minimal
- Top bar: Back button, "Training Mode" title, settings icon
```

**挥杆回放界面**:

```text
Design a mobile app screen for golf swing replay:
- Video player area at top (16:9 aspect ratio)
- Timeline scrubber with 4 keyframe markers below video
- Issue diagnosis card with problem and suggestion
- Playback controls: slow, play/pause, fast
- Dark theme with green highlights
- Share button in top right
```

**历史记录界面**:

```text
Design a mobile app screen for golf swing history:
- List of swing cards, each showing:
  - Date/time, club type
  - Score badge (colored by performance)
  - Thumbnail preview
- Filter chips at top: All, This Week, Best Swings
- Pull to refresh
- Dark theme, card-based layout
```

#### 设计系统建议

| 元素 | 规格 |
|-----|------|
| **主色调** | 深色背景 #1A1A2E |
| **强调色** | 高尔夫绿 #4CAF50 |
| **警告色** | 橙色 #FF9800 |
| **错误色** | 红色 #F44336 |
| **字体** | SF Pro (iOS) / 思源黑体 (中文) |
| **圆角** | 12px (卡片), 24px (按钮) |
| **间距** | 8px 基础单位 |

#### 交互规范

| 操作 | 反馈 |
|-----|------|
| 挥杆检测到 | 震动 + 音效 |
| 录制开始 | 按钮变红 + 脉冲动画 |
| 分析完成 | 评分数字滚动动画 |
| 问题诊断 | 卡片从底部滑入 |

---

## 测试计划

### 单元测试

| 模块 | 测试项 | 覆盖率目标 |
|-----|-------|-----------|
| IMU数据处理 | 滤波、融合算法 | >90% |
| 姿态估计 | 关键点检测准确率 | >85% |
| 挥杆检测 | 检测准确率、召回率 | >95% |
| 诊断规则 | 各规则触发准确性 | >90% |

### 集成测试

| 场景 | 测试内容 | 通过标准 |
|-----|---------|---------|
| 端到端延迟 | 挥杆→反馈 | <500ms |
| 数据同步 | IMU+Vision对齐 | 误差<10ms |
| 长时运行 | 2小时连续使用 | 无崩溃、漂移可控 |

### 用户测试

| 阶段 | 人数 | 时长 | 目标 |
|-----|------|------|------|
| Alpha | 5人 | 2周 | 基础功能验证 |
| Beta | 30人 | 4周 | 可用性验证 |
| RC | 100人 | 2周 | 稳定性验证 |

---

## 开发里程碑

| 阶段 | 交付物 | 完成标准 |
|-----|-------|---------|
| M1 | IMU固件 + BLE通信 | 数据稳定传输 |
| M2 | Flutter基础App + 视频采集 | 录制播放正常 |
| M3 | MediaPipe集成 | 骨架叠加正常 |
| M4 | 评估+诊断模块 | 挥杆分析可用 |
| M5 | 反馈系统 | 语音+视觉反馈 |
| M6 | 完整MVP | 通过Beta测试 |

---

## 相关文档

- [产品战略](../../product/product-strategy.md) - 设计决策背景
- [产品路线图](../roadmap.md) - 后续迭代计划
- [IMU硬件选型](../../components/imu/hardware.md) - 传感器详细规格
- [视觉系统](../../components/vision/software.md) - 姿态估计技术

---

**最后更新**: 2025年12月9日
