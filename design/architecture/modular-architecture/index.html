
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Architecture documentation for multimodal AI movement training system">
      
      
        <meta name="author" content="Movement Chain AI Team">
      
      
        <link rel="canonical" href="https://movement-chain-ai.github.io/movement-chain-docs/design/architecture/modular-architecture/">
      
      
        <link rel="prev" href="../system-design/">
      
      
        <link rel="next" href="../mvp-plan/">
      
      
        
          <link rel="alternate" href="/movement-chain-docs/" hreflang="zh">
        
          <link rel="alternate" href="/movement-chain-docs/en/" hreflang="en">
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>模块化设计 - Movement Chain AI Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="cyan">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#modular-design" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="Movement Chain AI Documentation" class="md-header__button md-logo" aria-label="Movement Chain AI Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Movement Chain AI Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              模块化设计
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="cyan"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="cyan"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="选择当前语言">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="/movement-chain-docs/" hreflang="zh" class="md-select__link">
              中文
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="/movement-chain-docs/en/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/movement-chain-ai/movement-chain-docs" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    movement-chain-ai/movement-chain-docs
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  首页

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../prerequisites/" class="md-tabs__link">
          
  
  
  前置知识

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../business-plan/" class="md-tabs__link">
          
  
  
  商业计划

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
  技术设计

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../components/" class="md-tabs__link">
          
  
  
  硬件组件

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../development/" class="md-tabs__link">
          
  
  
  开发指南

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../reference/" class="md-tabs__link">
          
  
  
  参考资料与术语

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Movement Chain AI Documentation" class="md-nav__button md-logo" aria-label="Movement Chain AI Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Movement Chain AI Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/movement-chain-ai/movement-chain-docs" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    movement-chain-ai/movement-chain-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    首页
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    前置知识
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    前置知识
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概览
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    高尔夫生物力学基础
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    高尔夫生物力学基础
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prerequisites/foundations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概览
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prerequisites/foundations/biomechanics-101/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    入门教程
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prerequisites/foundations/biomechanics-glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    术语表
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prerequisites/foundations/biomechanics-benchmarks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    基准值
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prerequisites/ml-basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ML 基础
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    商业计划
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    商业计划
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../business-plan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概览
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    市场洞察
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    市场洞察
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../business-plan/market-insights/market-analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    市场分析
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../business-plan/market-insights/pain-points/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    市场痛点
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../business-plan/market-insights/user-personas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    用户画像
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_4" >
        
          
          <label class="md-nav__link" for="__nav_3_2_4" id="__nav_3_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    竞品分析
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    竞品分析
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../business-plan/market-insights/competitors/imu-based/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IMU 方案竞品分析
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../business-plan/market-insights/competitors/vision-based/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    视觉方案竞品分析
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../business-plan/market-insights/competitors/multi-sensor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    多传感器方案竞品分析
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../business-plan/market-insights/competitors/smart-clothing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    智能服装竞品分析
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    商业模式
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    商业模式
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../business-plan/business-model/business-model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    商业模式画布（待补充）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../business-plan/business-model/pricing-strategy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    定价策略（待补充）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../business-plan/business-model/unit-economics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    单位经济学
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    进入市场
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    进入市场
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../business-plan/go-to-market/entry-strategy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    进入策略
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../business-plan/go-to-market/channel-strategy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    渠道策略（待补充）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../business-plan/go-to-market/market-timing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    市场时机（待补充）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    产品战略
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    产品战略
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../business-plan/product-strategy/strategic-vision/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    战略愿景
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../business-plan/product-strategy/product-strategy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    核心决策
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    合规与风险
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    合规与风险
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../business-plan/compliance-risk/risk-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    风险管理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../business-plan/compliance-risk/regulatory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    法规与合规（待补充）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../business-plan/compliance-risk/ip-strategy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    知识产权（待补充）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../business-plan/exit-strategy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    退出策略（待补充）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    技术设计
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    技术设计
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概览
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" checked>
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    架构设计
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    架构设计
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概览
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../system-design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    系统架构
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    模块化设计
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    模块化设计
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. 模块化设计哲学
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. 模块化设计哲学">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-lego" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.1 LEGO 核心原则
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.2 技术不确定性管理
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.3 架构阶段与模块映射
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-模块详情" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. 十二个模块详解
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. 十二个模块详解">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-数据采集层" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1 数据采集层
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.1 数据采集层">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#211-camera-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1.1 CAMERA Block
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#212-sensor-hub-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1.2 SENSOR_HUB Block ×N
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#213-ble-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1.3 BLE Block
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-传感器融合层" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2 传感器融合层
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.2 传感器融合层">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#221-time-align-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2.1 TIME_ALIGN Block
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#222-时间同步策略" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2.2 时间同步策略
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#223-时间同步实现方案" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2.3 时间同步实现方案
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#224-sensor-hub-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2.4 Sensor Hub 架构 (2025-12 推荐)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#225-融合引擎" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2.5 融合引擎: 三大机制
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-特征提取层" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3 特征提取层
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.3 特征提取层">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#231-积木块接口契约" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3.1 积木块接口契约
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#232-pose-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3.2 POSE Block 实现
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#233-imu-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3.3 IMU Block 实现
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#234-emg-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3.4 EMG Block 实现
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-分析诊断层" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.4 分析诊断层
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.4 分析诊断层">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#241-classifier-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.4.1 CLASSIFIER Block
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#242-fusion-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.4.2 FUSION Block
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#243-置信度计算逻辑" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.4.3 置信度计算逻辑
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-ai-反馈生成层" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.5 AI 反馈生成层
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.5 AI 反馈生成层">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#251-prompt-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.5.1 PROMPT Block
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#252-llm-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.5.2 LLM Block
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#26-用户反馈呈现层" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.6 用户反馈呈现层
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.6 用户反馈呈现层">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#261-output-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.6.1 OUTPUT Block
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-积木替换示例" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. 积木替换示例
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. 积木替换示例">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1 替换场景示例
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-1-classifier-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2 示例 1: 分类器升级 (CLASSIFIER Block)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-2-imu-sensor_hub-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.3 示例 2: IMU 真实化 (SENSOR_HUB Block)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-3-fusion-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.4 示例 3: 融合算法升级 (FUSION Block)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.5 为什么能做到"零修改"？
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-相关文档" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. 相关文档
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. 相关文档">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      
        核心文档
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adrs" class="md-nav__link">
    <span class="md-ellipsis">
      
        技术决策 (ADRs)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      
        实现指南
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-版本历史" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. 版本历史
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mvp-plan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MVP 开发计划
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2_5" >
        
          
          <label class="md-nav__link" for="__nav_4_2_5" id="__nav_4_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    数据处理
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    数据处理
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data-processing/data-pipeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    数据管道
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data-processing/signal-processing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    信号处理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data-processing/metrics-calculation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    指标计算
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data-processing/data-collection-plan-a/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    数据采集计划
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    产品设计
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    产品设计
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../specs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概览
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../specs/three-product-versions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    三种产品版本
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../specs/eight-swing-phases/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    八个挥杆阶段
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3_4" >
        
          
          <label class="md-nav__link" for="__nav_4_3_4" id="__nav_4_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    四种使用模式
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    四种使用模式
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../specs/modes/assessment-mode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    评估模式
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../specs/modes/drill-mode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    练习模式
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../specs/modes/guide-mode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    引导模式
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../specs/modes/game-mode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    实战模式
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../specs/four-comparison-methods/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    四种对比基准
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../specs/three-feedback-channels/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    三个反馈通道
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../specs/user-profile-thresholds/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    用户信息和阈值调整
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3_8" >
        
          
          <label class="md-nav__link" for="__nav_4_3_8" id="__nav_4_3_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    UI 设计
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    UI 设计
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../specs/ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概览
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../specs/ui/screens/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    屏幕列表
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../specs/ui/user-flows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    用户流程
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../specs/ui/design-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    设计系统
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../specs/ui/data-visualization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    数据可视化
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    技术决策
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    技术决策
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decisions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概览
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decisions/0001-multi-repo-structure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-0001 多仓库结构
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decisions/0002-lsm6dsv16x-imu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-0002 IMU 传感器
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decisions/0005-esp32-s3-microcontroller/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-0005 ESP32-S3
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decisions/0007-swift-ios-native/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-0007 Swift iOS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decisions/0008-desktop-to-mobile-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-0008 Desktop→Mobile
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decisions/sdk-selection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SDK/库选型
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decisions/visualization-tools-evaluation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    可视化工具
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decisions/architecture-decisions-2025-12-23/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2025-12 关键决策
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    产品调研
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    产品调研
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../market-research/competitor-metrics-comparison/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OnForm & Sportsbox AI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../market-research/3d-golf-decoded/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3D Golf Decoded
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    硬件组件
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    硬件组件
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../components/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概览
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    IMU 惯性测量
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    IMU 惯性测量
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../components/imu/hardware/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IMU 惯性测量单元
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../components/imu/suppliers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IMU 供应商大全
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    EMG 肌电传感
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    EMG 肌电传感
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../components/emg/hardware/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    EMG 肌电传感器
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../components/emg/suppliers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    EMG 供应商大全
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    视觉/摄像头
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    视觉/摄像头
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../components/vision/hardware/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    视觉/摄像头传感器
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../components/vision/software/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pose Estimation 姿态估计与计算机视觉指南
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    MCU 微控制器
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    MCU 微控制器
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../components/mcu/hardware/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MCU 微控制器
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../components/mcu/suppliers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MCU 供应商大全
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6" >
        
          
          <label class="md-nav__link" for="__nav_5_6" id="__nav_5_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    柔性传感器
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    柔性传感器
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../components/flexible-sensors/hardware/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    柔性/E-Skin 传感器
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../components/flexible-sensors/suppliers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    柔性传感器供应商大全
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_7" >
        
          
          <label class="md-nav__link" for="__nav_5_7" id="__nav_5_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    压力传感器
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    压力传感器
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../components/pressure-sensors/hardware/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    压力传感器
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../components/pressure-sensors/suppliers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    压力传感器供应商大全
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_8" >
        
          
          <label class="md-nav__link" for="__nav_5_8" id="__nav_5_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    供应链与 ODM/OEM
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    供应链与 ODM/OEM
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../components/supply-chain/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概览
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../components/supply-chain/china-sensors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    国内传感器供应商清单 (China Domestic Sensor Suppliers)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../components/supply-chain/china-wearables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    中国智能服装与可穿戴设备供应商大全
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../components/supply-chain/mvp-suppliers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    中国供应商快速 MVP 开发指南 - 高尔夫挥杆分析可穿戴设备
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../components/supply-chain/smart-clothing-market/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    中国智能运动服装与可穿戴设备市场调研报告
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../components/supply-chain/e-skin-odm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    E-Skin ODM/OEM 厂商研究
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    开发指南
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    开发指南
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概览
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    移动应用
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    移动应用
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/mobile/development/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mobile App Development Guide 移动应用开发指南
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3" >
        
          
          <label class="md-nav__link" for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    ML 训练
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    ML 训练
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/ml-training/datasets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Datasets &amp; Benchmarking Guide 数据集与基准测试指南
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/ml-training/visual-feedback/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Visual Feedback Design 视觉反馈设计指南
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4" >
        
          
          <label class="md-nav__link" for="__nav_6_4" id="__nav_6_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    AI 辅助开发
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    AI 辅助开发
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/ai-assistant/agent-sdk-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Agent SDK 指南
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    参考资料与术语
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    参考资料与术语
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概览
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/golf-glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    高尔夫术语表
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/physics-glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    物理学术语表
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/engineering-glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    工程术语表
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/software-glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    软件架构术语表
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/ml-glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    机器学习术语表
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/business-glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    商业术语表
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/academic-datasets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    运动训练系统的学术研究与数据集 (Academic Research &amp; Datasets for Movement Training Systems)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/golf-research/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    高尔夫生物力学研究 (Golf Biomechanics Research)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/open-source-tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    开源工具与代码库 (Open Source Tools &amp; Repositories)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/semg-research-2024-2025/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    sEMG 研究报告 (2024-2025)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. 模块化设计哲学
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. 模块化设计哲学">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-lego" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.1 LEGO 核心原则
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.2 技术不确定性管理
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.3 架构阶段与模块映射
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-模块详情" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. 十二个模块详解
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. 十二个模块详解">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-数据采集层" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1 数据采集层
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.1 数据采集层">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#211-camera-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1.1 CAMERA Block
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#212-sensor-hub-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1.2 SENSOR_HUB Block ×N
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#213-ble-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1.3 BLE Block
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-传感器融合层" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2 传感器融合层
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.2 传感器融合层">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#221-time-align-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2.1 TIME_ALIGN Block
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#222-时间同步策略" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2.2 时间同步策略
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#223-时间同步实现方案" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2.3 时间同步实现方案
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#224-sensor-hub-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2.4 Sensor Hub 架构 (2025-12 推荐)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#225-融合引擎" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2.5 融合引擎: 三大机制
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-特征提取层" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3 特征提取层
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.3 特征提取层">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#231-积木块接口契约" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3.1 积木块接口契约
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#232-pose-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3.2 POSE Block 实现
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#233-imu-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3.3 IMU Block 实现
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#234-emg-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3.4 EMG Block 实现
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-分析诊断层" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.4 分析诊断层
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.4 分析诊断层">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#241-classifier-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.4.1 CLASSIFIER Block
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#242-fusion-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.4.2 FUSION Block
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#243-置信度计算逻辑" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.4.3 置信度计算逻辑
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-ai-反馈生成层" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.5 AI 反馈生成层
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.5 AI 反馈生成层">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#251-prompt-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.5.1 PROMPT Block
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#252-llm-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.5.2 LLM Block
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#26-用户反馈呈现层" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.6 用户反馈呈现层
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.6 用户反馈呈现层">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#261-output-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.6.1 OUTPUT Block
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-积木替换示例" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. 积木替换示例
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. 积木替换示例">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1 替换场景示例
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-1-classifier-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2 示例 1: 分类器升级 (CLASSIFIER Block)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-2-imu-sensor_hub-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.3 示例 2: IMU 真实化 (SENSOR_HUB Block)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-3-fusion-block" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.4 示例 3: 融合算法升级 (FUSION Block)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.5 为什么能做到"零修改"？
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-相关文档" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. 相关文档
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. 相关文档">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      
        核心文档
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adrs" class="md-nav__link">
    <span class="md-ellipsis">
      
        技术决策 (ADRs)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      
        实现指南
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-版本历史" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. 版本历史
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="modular-design">模块化设计 Modular Design<a class="headerlink" href="#modular-design" title="Permanent link">&para;</a></h1>
<blockquote>
<p><strong>文档目的</strong>: 定义 Movement Chain AI 的 LEGO 积木式模块化架构</p>
<p><strong>核心理念</strong>: 每个组件独立可替换，MVP 快速验证，渐进式升级</p>
<p><strong>阅读时间</strong>: 25 分钟</p>
</blockquote>
<hr />
<h2 id="1">1. 模块化设计哲学<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11-lego">1.1 LEGO 核心原则<a class="headerlink" href="#11-lego" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>模块独立</strong> — 每个模块是独立的"积木块"，可以单独替换，接口保持稳定</li>
<li><strong>快速验证</strong> — MVP 用最简单的积木快速搭建，验证完整管道和用户价值</li>
<li><strong>延迟决策</strong> — 不提前设计"终态"，根据真实用户数据决定升级方向</li>
<li><strong>数据驱动</strong> — 复杂度来自训练数据，不来自代码 (AI 能写代码，但数据需要积累)</li>
<li><strong>融合优先</strong> — 单传感器准确性不如跨传感器验证重要</li>
<li><strong>六边形架构</strong> — Ports &amp; Adapters 模式，硬件依赖通过接口隔离</li>
</ol>
<h3 id="12">1.2 技术不确定性管理<a class="headerlink" href="#12" title="Permanent link">&para;</a></h3>
<p>我们面临多个技术不确定性:</p>
<table>
<thead>
<tr>
<th>不确定性</th>
<th>选项</th>
<th>MVP 策略</th>
<th>升级触发条件</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>分类器选择</strong></td>
<td>Simple Rules vs SwingNet vs BiGRU</td>
<td>Simple Rules (IMU 峰值/零交叉)</td>
<td>需要完整 8 阶段划分时</td>
</tr>
<tr>
<td><strong>姿态估计</strong></td>
<td>MediaPipe vs RTMPose vs Custom</td>
<td>MediaPipe (最易集成)</td>
<td>精度不足时升级</td>
</tr>
<tr>
<td><strong>传感器数据</strong></td>
<td>真实 vs 模拟 IMU/EMG</td>
<td>模拟 (验证管道)</td>
<td>硬件就绪后替换</td>
</tr>
<tr>
<td><strong>融合方法</strong></td>
<td>Simple vs Rule-based vs ML</td>
<td>Simple Merge</td>
<td>有足够融合数据后升级</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">解决方案</p>
<p>把这些不确定性封装成<strong>可替换的积木块</strong>，通过定义清晰的接口契约，让替换成本最小化。</p>
</div>
<hr />
<h3 id="13">1.3 架构阶段与模块映射<a class="headerlink" href="#13" title="Permanent link">&para;</a></h3>
<blockquote>
<p>📐 <strong>完整 7 阶段架构图</strong>: 见 <a href="../system-design/#12-完整系统架构">系统架构 §1.2</a></p>
</blockquote>
<table>
<thead>
<tr>
<th>Stage</th>
<th>层级</th>
<th style="text-align: center;">Block 数</th>
<th>对应积木块</th>
<th>关键输出</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>用户挥杆</td>
<td style="text-align: center;">—</td>
<td>(物理动作，无软件)</td>
<td>用户开始挥杆</td>
</tr>
<tr>
<td>2</td>
<td>数据采集层</td>
<td style="text-align: center;">3</td>
<td><a href="#211-camera-block">CAMERA</a>, <a href="#212-sensor-hub-block">SENSOR_HUB</a> ×N, <a href="#213-ble-block">BLE</a></td>
<td>原始传感器流</td>
</tr>
<tr>
<td>3</td>
<td>传感器融合层</td>
<td style="text-align: center;">1</td>
<td><a href="#221-time-align-block">TIME_ALIGN</a></td>
<td>统一时间轴数据</td>
</tr>
<tr>
<td>4</td>
<td>特征提取层</td>
<td style="text-align: center;">3</td>
<td><a href="#232-pose-block">POSE</a>, <a href="#233-imu-block">IMU</a>, <a href="#234-emg-block">EMG</a></td>
<td>12 个结构化指标</td>
</tr>
<tr>
<td>5</td>
<td>分析诊断层</td>
<td style="text-align: center;">2</td>
<td><a href="#241-classifier-block">CLASSIFIER</a>, <a href="#242-fusion-block">FUSION</a></td>
<td>8阶段 + 6规则诊断</td>
</tr>
<tr>
<td>6</td>
<td>AI 反馈生成层</td>
<td style="text-align: center;">2</td>
<td><a href="#251-prompt-block">PROMPT</a>, <a href="#252-llm-block">LLM</a></td>
<td>Kinematic Prompts + 自然语言</td>
</tr>
<tr>
<td>7</td>
<td>用户反馈呈现层</td>
<td style="text-align: center;">1</td>
<td><a href="#261-output-block">OUTPUT</a></td>
<td>UI/TTS/触觉/Ghost</td>
</tr>
<tr>
<td></td>
<td><strong>总计</strong></td>
<td style="text-align: center;"><strong>12</strong></td>
<td><em>(SENSOR_HUB 为可复用模块，部署 N 个实例)</em></td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>接口契约汇总</strong></p>
<table>
<thead>
<tr>
<th style="text-align: center;">Stage</th>
<th>Block</th>
<th style="text-align: center;">实例数</th>
<th>Input 类型</th>
<th>Output 类型</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">2</td>
<td>CAMERA</td>
<td style="text-align: center;">1</td>
<td><code>CameraInput</code></td>
<td><code>CameraOutput</code></td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td>SENSOR_HUB</td>
<td style="text-align: center;">N</td>
<td><code>SensorHubInput</code></td>
<td><code>SensorHubOutput</code></td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td>BLE</td>
<td style="text-align: center;">1</td>
<td><code>BLEInput</code></td>
<td><code>BLEPacket</code></td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td>TIME_ALIGN</td>
<td style="text-align: center;">1</td>
<td><code>TimeAlignInput</code></td>
<td><code>TimeAlignOutput</code></td>
</tr>
<tr>
<td style="text-align: center;">4</td>
<td>POSE</td>
<td style="text-align: center;">1</td>
<td><code>VideoFrame</code></td>
<td><code>PoseResult</code></td>
</tr>
<tr>
<td style="text-align: center;">4</td>
<td>IMU</td>
<td style="text-align: center;">1</td>
<td><code>RawIMU</code></td>
<td><code>IMUFeatures</code></td>
</tr>
<tr>
<td style="text-align: center;">4</td>
<td>EMG</td>
<td style="text-align: center;">1</td>
<td><code>RawEMG</code></td>
<td><code>EMGFeatures</code></td>
</tr>
<tr>
<td style="text-align: center;">5</td>
<td>CLASSIFIER</td>
<td style="text-align: center;">1</td>
<td><code>ClassifierInput</code></td>
<td><code>ClassifierResult</code></td>
</tr>
<tr>
<td style="text-align: center;">5</td>
<td>FUSION</td>
<td style="text-align: center;">1</td>
<td><code>FusionInput</code></td>
<td><code>FusionResult</code></td>
</tr>
<tr>
<td style="text-align: center;">6</td>
<td>PROMPT</td>
<td style="text-align: center;">1</td>
<td><code>PromptInput</code></td>
<td><code>PromptOutput</code></td>
</tr>
<tr>
<td style="text-align: center;">6</td>
<td>LLM</td>
<td style="text-align: center;">1</td>
<td><code>LLMInput</code></td>
<td><code>LLMOutput</code></td>
</tr>
<tr>
<td style="text-align: center;">7</td>
<td>OUTPUT</td>
<td style="text-align: center;">1</td>
<td><code>OutputInput</code></td>
<td><code>OutputResult</code></td>
</tr>
</tbody>
</table>
<blockquote>
<p>💡 <strong>SENSOR_HUB 复用</strong>: 同一套固件代码，通过 <code>hub_id</code> 参数区分不同实例。MVP 部署 2 个 (N=2)。</p>
<p>📐 <strong>详细定义</strong>: 各 Block 接口契约的完整 Python dataclass 定义见对应章节。</p>
</blockquote>
<h2 id="2-模块详情">2.  十二个模块详解<a class="headerlink" href="#2-模块详情" title="Permanent link">&para;</a></h2>
<h3 id="21-数据采集层">2.1 数据采集层<a class="headerlink" href="#21-数据采集层" title="Permanent link">&para;</a></h3>
<p>Stage 2 负责从多种传感器采集原始数据:
- <strong>CAMERA</strong>: iPhone 本机摄像头，通过 Native SDK 直接访问 (零延迟)
- <strong>SENSOR_HUB</strong>: ESP32 穿戴设备，通过 BLE 5.0 传输到 iPhone</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>┌─────────────────────────────────────────────────────────────────────────────┐
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>│                         数据采集层 DATA COLLECTION                            │
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>├─────────────────────────────────────────────────────────────────────────────┤
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>│                                                                             │
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>│   ┌─────────────────┐          ┌─────────────────────────────────────┐      │
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>│   │   CAMERA Block  │          │         SENSOR_HUB Block ×N         │      │
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>│   │   ─────────────  │          │  ┌───────────┐     ┌───────────┐    │      │
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>│   │   iPhone 摄像头   │          │  │  Hub #0   │     │  Hub #1   │    │      │
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>│   │   MediaPipe iOS  │          │  │ (hub_id=0)│ ... │ (hub_id=1)│    │      │
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>│   │   33 keypoints   │          │  └─────┬─────┘     └─────┬─────┘    │      │
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>│   └────────┬────────┘          └────────┼─────────────────┼──────────┘      │
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>│            │                            │                 │                 │
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>│            │ Native SDK                 │                 │                 │
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>│            │ (零延迟)                    │                 │                 │
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>│            │                            ▼                 ▼                 │
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>│            │                   ┌─────────────────────────────────┐          │
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>│            │                   │          BLE Block              │          │
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>│            │                   │   (数据传输 + 时间戳同步)          │          │
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>│            │                   │   • N 个外设连接                 │          │
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>│            │                   │   • &lt;30ms 延迟                  │          │
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>│            │                   └──────────────┬──────────────────┘          │
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>│            │                                  │                             │
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>│            └──────────────────┬───────────────┘                             │
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>│                               ▼                                             │
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>│                        📱 iPhone App                                        │
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>│                        (数据汇聚点)                                          │
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>│                                                                             │
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>│   💡 SENSOR_HUB: 同一套固件代码，通过 hub_id 参数区分实例                        │
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>│      MVP: N=2 (上肢 + 下肢)                                                  │
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>│      扩展: N=4+ (四肢 + 躯干)                                                 │
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>│                                                                             │
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>└─────────────────────────────────────────────────────────────────────────────┘
</span></code></pre></div>
<h4 id="211-camera-block">2.1.1 CAMERA Block<a class="headerlink" href="#211-camera-block" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>属性</th>
<th>规格</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>硬件</strong></td>
<td>iPhone 摄像头 (用户自有)</td>
</tr>
<tr>
<td><strong>SDK</strong></td>
<td>MediaPipe iOS SDK</td>
</tr>
<tr>
<td><strong>输出</strong></td>
<td>33 个关键点 × 30fps</td>
</tr>
<tr>
<td><strong>坐标系</strong></td>
<td>归一化 [0,1] 屏幕坐标</td>
</tr>
</tbody>
</table>
<p><strong>接口契约</strong>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># Input: 物理世界 (无软件输入，由硬件直接采集)</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="nd">@dataclass</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">CameraInput</span><span class="p">:</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;物理输入: iPhone 摄像头采集的视频帧&quot;&quot;&quot;</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>    <span class="n">video_frame</span><span class="p">:</span> <span class="nb">bytes</span>          <span class="c1"># RGB 图像数据</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>    <span class="n">width</span><span class="p">:</span> <span class="nb">int</span>                  <span class="c1"># 帧宽度</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>    <span class="n">height</span><span class="p">:</span> <span class="nb">int</span>                 <span class="c1"># 帧高度</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>    <span class="n">system_time_ms</span><span class="p">:</span> <span class="nb">int</span>         <span class="c1"># iOS 系统时间戳</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="c1"># Output</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="nd">@dataclass</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="k">class</span><span class="w"> </span><span class="nc">CameraOutput</span><span class="p">:</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>    <span class="n">timestamp_ms</span><span class="p">:</span> <span class="nb">int</span>           <span class="c1"># 系统时钟时间戳</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>    <span class="n">keypoints</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Keypoint</span><span class="p">]</span>   <span class="c1"># 33 个关键点</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>    <span class="n">confidence</span><span class="p">:</span> <span class="nb">float</span>           <span class="c1"># 整体置信度 [0,1]</span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="nd">@dataclass</span>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="k">class</span><span class="w"> </span><span class="nc">Keypoint</span><span class="p">:</span>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>    <span class="n">x</span><span class="p">:</span> <span class="nb">float</span>      <span class="c1"># [0,1] 归一化</span>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>    <span class="n">y</span><span class="p">:</span> <span class="nb">float</span>      <span class="c1"># [0,1] 归一化</span>
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>    <span class="n">z</span><span class="p">:</span> <span class="nb">float</span>      <span class="c1"># 深度估计 (相对值)</span>
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>    <span class="n">visibility</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># [0,1]</span>
</span></code></pre></div>
<p><strong>可替换性</strong>: MediaPipe → RTMPose → 自训练模型 (接口不变)</p>
<h4 id="212-sensor-hub-block">2.1.2 SENSOR_HUB Block ×N<a class="headerlink" href="#212-sensor-hub-block" title="Permanent link">&para;</a></h4>
<blockquote>
<p><strong>核心特性</strong>: 可复用固件模块，通过 <code>hub_id</code> 参数区分不同实例</p>
<p><strong>部署灵活性</strong>: 同一套代码可部署于任意身体部位 (手臂、腿部、躯干等)</p>
</blockquote>
<table>
<thead>
<tr>
<th>属性</th>
<th>规格</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>MCU</strong></td>
<td>ESP32-S3</td>
</tr>
<tr>
<td><strong>IMU</strong></td>
<td>2× LSM6DSV16X</td>
</tr>
<tr>
<td><strong>EMG</strong></td>
<td>1× MyoWare 2.0 — <em>Elite 版</em></td>
</tr>
<tr>
<td><strong>采样率</strong></td>
<td>IMU: 1666Hz, EMG: 1000Hz</td>
</tr>
<tr>
<td><strong>实例数</strong></td>
<td>MVP: N=2, 扩展: N=4+</td>
</tr>
</tbody>
</table>
<p><strong>典型部署配置</strong>:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">hub_id</th>
<th>MVP 位置</th>
<th>扩展位置 (可选)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">0</td>
<td>上肢 (双前臂)</td>
<td>左臂</td>
</tr>
<tr>
<td style="text-align: center;">1</td>
<td>下肢 (双大腿)</td>
<td>右臂</td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td>—</td>
<td>左腿</td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td>—</td>
<td>右腿</td>
</tr>
<tr>
<td style="text-align: center;">4</td>
<td>—</td>
<td>躯干/核心</td>
</tr>
</tbody>
</table>
<p><strong>接口契约</strong>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># Input: 物理传感器信号 (由硬件直接采集)</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="nd">@dataclass</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">SensorHubInput</span><span class="p">:</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;物理输入: LSM6DSV16X + MyoWare 传感器原始信号&quot;&quot;&quot;</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>    <span class="n">hub_id</span><span class="p">:</span> <span class="nb">int</span>                 <span class="c1"># 实例标识 (0, 1, 2, ...)</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>    <span class="n">imu_registers</span><span class="p">:</span> <span class="nb">bytes</span>        <span class="c1"># IMU I2C 寄存器读取</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>    <span class="n">emg_adc_value</span><span class="p">:</span> <span class="nb">int</span>          <span class="c1"># ADC 采样值 (0-4095)</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>    <span class="n">esp_micros</span><span class="p">:</span> <span class="nb">int</span>             <span class="c1"># ESP32 微秒计数器</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="c1"># Output</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="nd">@dataclass</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="k">class</span><span class="w"> </span><span class="nc">SensorHubOutput</span><span class="p">:</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>    <span class="n">hub_id</span><span class="p">:</span> <span class="nb">int</span>                 <span class="c1"># 实例标识 (0, 1, 2, ...)</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>    <span class="n">timestamp_us</span><span class="p">:</span> <span class="nb">int</span>           <span class="c1"># ESP32 micros() 时间戳</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>    <span class="n">imu_1</span><span class="p">:</span> <span class="n">IMUReading</span>           <span class="c1"># 第一个 IMU</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>    <span class="n">imu_2</span><span class="p">:</span> <span class="n">IMUReading</span>           <span class="c1"># 第二个 IMU</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>    <span class="n">emg</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">EMGReading</span><span class="p">]</span>   <span class="c1"># Elite 版才有</span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a><span class="nd">@dataclass</span>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a><span class="k">class</span><span class="w"> </span><span class="nc">IMUReading</span><span class="p">:</span>
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>    <span class="n">accel</span><span class="p">:</span> <span class="n">Vector3</span>  <span class="c1"># m/s² [-16g, +16g]</span>
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a>    <span class="n">gyro</span><span class="p">:</span> <span class="n">Vector3</span>   <span class="c1"># rad/s [-2000°/s, +2000°/s]</span>
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a><span class="nd">@dataclass</span>
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a><span class="k">class</span><span class="w"> </span><span class="nc">EMGReading</span><span class="p">:</span>
</span><span id="__span-2-26"><a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a>    <span class="n">raw_mv</span><span class="p">:</span> <span class="nb">float</span>       <span class="c1"># 原始电压 mV</span>
</span><span id="__span-2-27"><a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a>    <span class="n">rectified</span><span class="p">:</span> <span class="nb">float</span>    <span class="c1"># 整流后</span>
</span><span id="__span-2-28"><a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a>    <span class="n">envelope</span><span class="p">:</span> <span class="nb">float</span>     <span class="c1"># 包络 (RMS 滤波)</span>
</span></code></pre></div>
<div class="admonition tip">
<p class="admonition-title">固件复用优势</p>
<p><strong>同一套固件代码</strong> 部署到所有 SENSOR_HUB 实例:</p>
<ul>
<li>开发效率: 只需维护一份代码</li>
<li>测试覆盖: 一次测试覆盖所有实例</li>
<li>OTA 升级: 统一固件版本管理</li>
<li>扩展性: 添加新 Hub 只需配置 <code>hub_id</code></li>
</ul>
</div>
<h4 id="213-ble-block">2.1.3 BLE Block<a class="headerlink" href="#213-ble-block" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>属性</th>
<th>规格</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>协议</strong></td>
<td>BLE 5.0</td>
</tr>
<tr>
<td><strong>延迟</strong></td>
<td>&lt; 30ms</td>
</tr>
<tr>
<td><strong>MTU</strong></td>
<td>244 bytes</td>
</tr>
<tr>
<td><strong>连接</strong></td>
<td>N 个外设 (SENSOR_HUB ×N)</td>
</tr>
</tbody>
</table>
<p><strong>职责</strong>:</p>
<ol>
<li>接收 ESP32 数据包 (含源端时间戳 + hub_id)</li>
<li>计算传输延迟并补偿</li>
<li>将数据转发到融合层</li>
</ol>
<p><strong>接口契约</strong>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1"># Input: 来自 ESP32 的 BLE 通知</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="nd">@dataclass</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">BLEInput</span><span class="p">:</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>    <span class="n">characteristic_uuid</span><span class="p">:</span> <span class="nb">str</span>    <span class="c1"># BLE 特征 UUID</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>    <span class="n">raw_bytes</span><span class="p">:</span> <span class="nb">bytes</span>            <span class="c1"># 原始字节流</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>    <span class="n">rssi</span><span class="p">:</span> <span class="nb">int</span>                   <span class="c1"># 信号强度</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="c1"># Output</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="nd">@dataclass</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="k">class</span><span class="w"> </span><span class="nc">BLEPacket</span><span class="p">:</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>    <span class="n">hub_id</span><span class="p">:</span> <span class="nb">int</span>           <span class="c1"># SENSOR_HUB 实例标识 (0, 1, 2, ...)</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>    <span class="n">esp_timestamp_us</span><span class="p">:</span> <span class="nb">int</span> <span class="c1"># ESP32 源端时间戳</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>    <span class="n">receive_time_ms</span><span class="p">:</span> <span class="nb">int</span>  <span class="c1"># iPhone 接收时间</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>    <span class="n">payload</span><span class="p">:</span> <span class="nb">bytes</span>        <span class="c1"># IMU/EMG 数据</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>    <span class="n">latency_ms</span><span class="p">:</span> <span class="nb">float</span>     <span class="c1"># 估算的传输延迟</span>
</span></code></pre></div>
<hr />
<h3 id="22-传感器融合层">2.2 传感器融合层<a class="headerlink" href="#22-传感器融合层" title="Permanent link">&para;</a></h3>
<p>Stage 3 负责将三模态数据对齐到统一时间轴，并执行交叉验证。</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>┌─────────────────────────────────────────────────────────────────────────────┐
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>│                         传感器融合层 SENSOR FUSION                           │
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>├─────────────────────────────────────────────────────────────────────────────┤
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>│                                                                             │
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>│   来自 Stage 2 的原始数据流:                                                 │
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>│   ─────────────────────────                                                 │
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>│   📹 Vision (30fps)  ──┐                                                    │
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>│   🔄 IMU (1666Hz)    ──┼──→  ⏱️ TIME_ALIGN Block ──→ 统一时间轴数据          │
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>│   💪 EMG (1000Hz)    ──┘                                                    │
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>│                                                                             │
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>│   输出到 Stage 4:                                                            │
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>│   ────────────────                                                          │
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>│   • 三模态时间对齐数据 (以 IMU 1666Hz 为主时钟)                               │
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>│   • 同步精度: 同Hub &lt;10μs, 跨Hub &lt;500μs, 跨设备 &lt;10ms                        │
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>│                                                                             │
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>└─────────────────────────────────────────────────────────────────────────────┘
</span></code></pre></div>
<h4 id="221-time-align-block">2.2.1 TIME_ALIGN Block<a class="headerlink" href="#221-time-align-block" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>属性</th>
<th>规格</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>输入</strong></td>
<td>Vision 30fps + IMU 1666Hz + EMG 1000Hz (各自带时间戳)</td>
</tr>
<tr>
<td><strong>输出</strong></td>
<td>统一时间轴的三模态数据</td>
</tr>
<tr>
<td><strong>主时钟</strong></td>
<td>IMU (1666Hz = 0.6ms 分辨率)</td>
</tr>
<tr>
<td><strong>同步精度</strong></td>
<td>&lt; 10ms (跨设备)</td>
</tr>
</tbody>
</table>
<p><strong>接口契约</strong>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nd">@dataclass</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">TimeAlignInput</span><span class="p">:</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>    <span class="n">vision_frames</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">CameraOutput</span><span class="p">]</span>       <span class="c1"># 30fps, 带时间戳</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>    <span class="n">hub_readings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">SensorHubOutput</span><span class="p">]</span>     <span class="c1"># N 个 Hub, 各 1666Hz, 带时间戳 + hub_id</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>    <span class="c1"># EMG 数据包含在 SensorHubOutput 中 (Elite 版)</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="nd">@dataclass</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="k">class</span><span class="w"> </span><span class="nc">TimeAlignOutput</span><span class="p">:</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>    <span class="n">aligned_data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">AlignedSample</span><span class="p">]</span>   <span class="c1"># 统一到 IMU 时间轴</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>    <span class="n">sync_quality</span><span class="p">:</span> <span class="n">SyncQuality</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="nd">@dataclass</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="k">class</span><span class="w"> </span><span class="nc">AlignedSample</span><span class="p">:</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>    <span class="n">timestamp_us</span><span class="p">:</span> <span class="nb">int</span>                   <span class="c1"># IMU 主时钟时间戳</span>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>    <span class="n">vision</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Keypoint</span><span class="p">]</span>          <span class="c1"># 插值后的视觉数据</span>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>    <span class="n">imu</span><span class="p">:</span> <span class="n">IMUReading</span>                     <span class="c1"># 原始 IMU</span>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>    <span class="n">emg</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">EMGReading</span><span class="p">]</span>           <span class="c1"># 插值后的 EMG</span>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a><span class="nd">@dataclass</span>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a><span class="k">class</span><span class="w"> </span><span class="nc">SyncQuality</span><span class="p">:</span>
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a>    <span class="n">max_offset_ms</span><span class="p">:</span> <span class="nb">float</span>                <span class="c1"># 最大同步偏移</span>
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a>    <span class="n">is_valid</span><span class="p">:</span> <span class="nb">bool</span>                      <span class="c1"># &lt; 10ms 为有效</span>
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a>    <span class="n">impact_aligned</span><span class="p">:</span> <span class="nb">bool</span>                <span class="c1"># Impact 事件是否对齐</span>
</span></code></pre></div>
<p><strong>可替换性</strong>: 简单线性插值 → 三次样条插值 → Kalman 滤波 (接口不变)</p>
<h4 id="222-时间同步策略">2.2.2 时间同步策略<a class="headerlink" href="#222-时间同步策略" title="Permanent link">&para;</a></h4>
<p>三模态融合的<strong>基础</strong>是精确的时间对齐:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>┌─────────────────────────────────────────────────────────────────────────────┐
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>│                         时间同步策略 TIME SYNCHRONIZATION                    │
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>├─────────────────────────────────────────────────────────────────────────────┤
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>│                                                                             │
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>│   为什么 IMU 是主时钟 (MASTER CLOCK):                                        │
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>│   ─────────────────────────────────────                                     │
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>│   • IMU: 1666Hz = 0.6ms 分辨率 (最高)                                       │
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>│   • EMG: 1000Hz = 1.0ms 分辨率                                              │
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>│   • Vision: 30Hz = 33.3ms 分辨率 (最低)                                     │
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>│                                                                             │
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>│   对齐策略:                                                                  │
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>│   ─────────────────────────────────────                                     │
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>│   • Vision 30fps → 线性插值到 1666Hz (填补帧间空白)                          │
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>│   • EMG 1000Hz → 三次样条插值上采样到 1666Hz                                 │
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>│   • IMU 1666Hz → 主参考轴 (不变换)                                          │
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>│                                                                             │
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>│   ⚠️ 关键要求:                                                              │
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>│   ─────────────────────────────────────                                     │
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>│   • 时间同步误差 MUST &lt; 10ms                                                │
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a>│   • 如果 &gt; 10ms，交叉验证失去意义                                           │
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a>│   • 相位检测时间戳将不可靠                                                   │
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a>│                                                                             │
</span><span id="__span-6-23"><a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a>│   实现方式:                                                                  │
</span><span id="__span-6-24"><a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a>│   ─────────────────────────────────────                                     │
</span><span id="__span-6-25"><a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a>│   • ESP32-S3 使用统一时钟源 (micros())                                      │
</span><span id="__span-6-26"><a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a>│   • BLE 传输包含发送时间戳                                                   │
</span><span id="__span-6-27"><a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a>│   • 手机端计算网络延迟并补偿                                                 │
</span><span id="__span-6-28"><a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a>│                                                                             │
</span><span id="__span-6-29"><a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a>└─────────────────────────────────────────────────────────────────────────────┘
</span></code></pre></div>
<div class="admonition tip">
<p class="admonition-title">🔧 调试工具: Rerun 时间轴验证</p>
<p><strong>问题</strong>: 如何验证三个传感器是否真的对齐到 &lt;10ms?</p>
<p><strong>Rerun 解决方案</strong>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>┌─────────────────────────────────────────────────────────────┐
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>│  Rerun 时间轴视图                                           │
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>├─────────────────────────────────────────────────────────────┤
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>│  📷 Vision:  [帧45] ─────────────●──────── (Top 检测)       │
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>│  🔄 IMU:     ─────────────────●────────── (gyro_z 零交叉)  │
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>│  💪 EMG:     ───────────────●──────────── (核心激活起始)    │
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>│                             ↑                               │
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>│                      如果三个●不在同一垂直线 → 同步有问题    │
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>└─────────────────────────────────────────────────────────────┘
</span></code></pre></div></p>
<p>拖动时间轴到 Impact 时刻，三个传感器的事件点应该对齐。
偏差 &gt;10ms 说明时间同步需要调整。</p>
<blockquote>
<p>详见 <a href="../../decisions/visualization-tools-evaluation/">可视化工具评估</a></p>
</blockquote>
</div>
<h4 id="223-时间同步实现方案">2.2.3 时间同步实现方案<a class="headerlink" href="#223-时间同步实现方案" title="Permanent link">&para;</a></h4>
<div class="admonition warning">
<p class="admonition-title">MVP 阶段说明</p>
<p>使用 <strong>Mock 数据</strong>时，时间同步自动完成（所有数据由同一代码生成，共享时钟）。
本节内容适用于<strong>真实硬件集成阶段</strong>。</p>
</div>
<div class="admonition warning">
<p class="admonition-title">BLE 传输抖动</p>
<p>BLE 连接间隔抖动 ±15-30ms，时间戳必须在 ESP32 源端生成，不受传输延迟影响。</p>
</div>
<h5 id="ntp-impact">推荐方案: NTP 预同步 + Impact 验证<a class="headerlink" href="#ntp-impact" title="Permanent link">&para;</a></h5>
<p>这是行业标准方法，被大多数运动分析应用采用。代码量约 40-50 行，无需额外硬件。</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>┌─────────────────────────────────────────────────────────────────────────────┐
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>│                    时间同步实现: NTP + IMPACT 验证                             │
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>├─────────────────────────────────────────────────────────────────────────────┤
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>│                                                                             │
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>│   STEP 1: NTP 预同步 (录制前)                                                 │
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>│   ────────────────────────────                                              │
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>│   • 手机自动从 NTP 服务器同步时间 (iOS/Android 内置)                             │
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>│   • ESP32 通过 BLE 从手机获取当前时间并设置内部时钟                               │
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>│   • 所有设备共享同一时间基准                                                    │
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>│   • 精度: ~1-10ms                                                            │
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>│                                                                             │
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>│   STEP 2: 传感器端时间戳 (录制中)                                               │
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>│   ─────────────────────────────                                             │
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>│   • IMU/EMG: ESP32 使用 micros() 在数据采集时立即打时间戳                        │
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>│   • Vision: 手机摄像头使用系统时钟 (已 NTP 同步)                                 │
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a>│   • ⚠️ 关键: 时间戳在传感器端生成，BLE 传输延迟不影响时间戳准确性                    │
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>│                                                                             │
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a>│   STEP 3: Impact 验证 (录制后)                                                │
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a>│   ───────────────────────────                                               │
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a>│   • IMU: 检测峰值角速度 → impact_imu (精度 ±5ms)                               │
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a>│   • Vision: 检测球离开瞬间 → impact_vision                                    │
</span><span id="__span-8-22"><a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a>│   • 计算偏移: offset = impact_imu - impact_vision                            │
</span><span id="__span-8-23"><a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a>│   • 校正: video.timestamps += offset                                        │
</span><span id="__span-8-24"><a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a>│   • 若 |offset| &gt; 20ms → 标记需检查                                           │
</span><span id="__span-8-25"><a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a>│                                                                             │
</span><span id="__span-8-26"><a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a>└─────────────────────────────────────────────────────────────────────────────┘
</span></code></pre></div>
<h5 id="emg">为什么 EMG 不参与时间对齐<a class="headerlink" href="#emg" title="Permanent link">&para;</a></h5>
<div class="language-text highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>肌电机械延迟 (Electromechanical Delay, EMD)
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>────────────────────────────────────────────
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>EMG 信号 ─→ 神经指令 ─→ 钙离子释放 ─→ 肌纤维收缩 ─→ 动作发生
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>            ↑                                        ↑
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>            EMG 检测                                 IMU/Vision 检测
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>时间差: 30-100ms
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>结论: EMG 是诊断数据，不是同步参考。使用 IMU 建立时间轴后，再分析 EMG。
</span></code></pre></div>
<h5 id="_1">替代方案对比<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h5>
<table>
<thead>
<tr>
<th>方案</th>
<th>精度</th>
<th>复杂度</th>
<th>适用性</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>NTP + Impact 验证</strong></td>
<td>&lt;10ms</td>
<td>低 (~50行代码)</td>
<td>✅ MVP 推荐</td>
<td>零额外硬件，手机内置 NTP</td>
</tr>
<tr>
<td>硬件 TTL 触发</td>
<td>&lt;150µs</td>
<td>高</td>
<td>❌</td>
<td>需同步盒、有线连接，不便携</td>
</tr>
<tr>
<td>BLE 时间戳对交换</td>
<td>&lt;1ms</td>
<td>中</td>
<td>⏳ V2</td>
<td>需固件开发，精度更高</td>
</tr>
<tr>
<td>Chrony</td>
<td>&lt;1ms</td>
<td>-</td>
<td>❌ 不可控</td>
<td>移动端无法选择时钟协议</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">注意: NTP 时钟跳变</p>
<p>NTP 校正可能导致时钟<strong>向后跳</strong> (例如 100ms → 95ms)。</p>
<p><strong>解决方案</strong>: 使用单调时钟计算相对时间:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c1"># Python</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="n">duration</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_monotonic</span>  <span class="c1"># 永远非负</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="c1"># ESP32</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="n">uint32_t</span> <span class="n">duration</span> <span class="o">=</span> <span class="n">micros</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_micros</span><span class="p">;</span>  <span class="o">//</span> <span class="n">使用差值</span><span class="err">，</span><span class="n">避免跳变影响</span>
</span></code></pre></div>
</div>
<h5 id="_2">参考实现 (硬件集成阶段)<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h5>
<div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">TimeAlignmentManager</span><span class="p">:</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;时间对齐管理器 - 硬件集成阶段使用&quot;&quot;&quot;</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">find_imu_impact</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gyro_z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">timestamps</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;从 IMU 陀螺仪数据检测击球时刻&quot;&quot;&quot;</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>        <span class="n">peak_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">gyro_z</span><span class="p">))</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>        <span class="k">return</span> <span class="n">timestamps</span><span class="p">[</span><span class="n">peak_idx</span><span class="p">]</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">find_video_impact</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frames</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">fps</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;从视频检测击球时刻 (球离开或杆头最低点)&quot;&quot;&quot;</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>        <span class="c1"># 简化实现: 使用运动检测找到最大变化帧</span>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a>        <span class="n">motion_scores</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_compute_motion</span><span class="p">(</span><span class="n">frames</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">frames</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a>                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a>        <span class="n">impact_frame</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">motion_scores</span><span class="p">)</span>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a>        <span class="k">return</span> <span class="n">impact_frame</span> <span class="o">/</span> <span class="n">fps</span>
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a>
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_and_correct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">imu_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">video_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;验证并校正时间对齐&quot;&quot;&quot;</span>
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a>        <span class="n">imu_impact</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_imu_impact</span><span class="p">(</span><span class="n">imu_data</span><span class="p">[</span><span class="s1">&#39;gyro_z&#39;</span><span class="p">],</span> <span class="n">imu_data</span><span class="p">[</span><span class="s1">&#39;timestamps&#39;</span><span class="p">])</span>
</span><span id="__span-11-20"><a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a>        <span class="n">video_impact</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_video_impact</span><span class="p">(</span><span class="n">video_data</span><span class="p">[</span><span class="s1">&#39;frames&#39;</span><span class="p">],</span> <span class="n">video_data</span><span class="p">[</span><span class="s1">&#39;fps&#39;</span><span class="p">])</span>
</span><span id="__span-11-21"><a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a>
</span><span id="__span-11-22"><a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a>        <span class="n">offset</span> <span class="o">=</span> <span class="n">imu_impact</span> <span class="o">-</span> <span class="n">video_impact</span>
</span><span id="__span-11-23"><a id="__codelineno-11-23" name="__codelineno-11-23" href="#__codelineno-11-23"></a>
</span><span id="__span-11-24"><a id="__codelineno-11-24" name="__codelineno-11-24" href="#__codelineno-11-24"></a>        <span class="n">result</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-11-25"><a id="__codelineno-11-25" name="__codelineno-11-25" href="#__codelineno-11-25"></a>            <span class="s1">&#39;offset_ms&#39;</span><span class="p">:</span> <span class="n">offset</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span>
</span><span id="__span-11-26"><a id="__codelineno-11-26" name="__codelineno-11-26" href="#__codelineno-11-26"></a>            <span class="s1">&#39;aligned&#39;</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.020</span><span class="p">,</span>  <span class="c1"># &lt;20ms 视为对齐</span>
</span><span id="__span-11-27"><a id="__codelineno-11-27" name="__codelineno-11-27" href="#__codelineno-11-27"></a>            <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.010</span> <span class="k">else</span> <span class="s1">&#39;corrected&#39;</span>
</span><span id="__span-11-28"><a id="__codelineno-11-28" name="__codelineno-11-28" href="#__codelineno-11-28"></a>        <span class="p">}</span>
</span><span id="__span-11-29"><a id="__codelineno-11-29" name="__codelineno-11-29" href="#__codelineno-11-29"></a>
</span><span id="__span-11-30"><a id="__codelineno-11-30" name="__codelineno-11-30" href="#__codelineno-11-30"></a>        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.010</span><span class="p">:</span>  <span class="c1"># &gt;10ms 需要校正</span>
</span><span id="__span-11-31"><a id="__codelineno-11-31" name="__codelineno-11-31" href="#__codelineno-11-31"></a>            <span class="n">video_data</span><span class="p">[</span><span class="s1">&#39;timestamps&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="o">+</span> <span class="n">offset</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">video_data</span><span class="p">[</span><span class="s1">&#39;timestamps&#39;</span><span class="p">]]</span>
</span><span id="__span-11-32"><a id="__codelineno-11-32" name="__codelineno-11-32" href="#__codelineno-11-32"></a>
</span><span id="__span-11-33"><a id="__codelineno-11-33" name="__codelineno-11-33" href="#__codelineno-11-33"></a>        <span class="k">return</span> <span class="n">result</span>
</span></code></pre></div>
<blockquote>
<p><strong>研究来源</strong>:</p>
<ul>
<li><a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC10144216/">BLE 多通道生物信号同步 (PMC10144216)</a> - 实现 &lt;1ms 精度</li>
<li><a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC7795013/">Twist-n-Sync 陀螺仪同步 (PMC7795013)</a> - 16µs 精度，Google Research</li>
<li><a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC7472298/">Golf Swing IMU 分段 (PMC7472298)</a> - Impact 检测精度 ±5-16ms</li>
</ul>
</blockquote>
<h4 id="224-sensor-hub-architecture">2.2.4 Sensor Hub 架构 (2025-12 推荐)<a class="headerlink" href="#224-sensor-hub-architecture" title="Permanent link">&para;</a></h4>
<div class="admonition success">
<p class="admonition-title">单一权威来源 — 所有 Sensor Hub 相关文档引用此处</p>
</div>
<p><strong>核心原则</strong>: 同一身体部位的 IMU + EMG 使用同一个 ESP32 作为 Sensor Hub，共享微秒级时钟，消除 BLE 抖动影响。</p>
<h5 id="3">完整 3 单元架构 (目标实现)<a class="headerlink" href="#3" title="Permanent link">&para;</a></h5>
<div class="language-text highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>┌─────────────────────────────────────────────────────────────────────────────┐
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>│                    Sensor Hub 架构 (同一部位共享时钟)                          │
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>├─────────────────────────────────────────────────────────────────────────────┤
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>│                                                                             │
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>│   ┌─────────────────┐   ┌─────────────────┐   ┌─────────────────┐           │
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>│   │    ESP32 #1     │   │    ESP32 #2     │   │    ESP32 #3     │           │
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>│   │   手臂 (Arm)     │   │   核心 (Core)   │   │    腿部 (Leg)    │           │
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>│   │ ┌─────┬───────┐ │   │ ┌─────┬───────┐ │   │ ┌─────┬───────┐ │           │
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>│   │ │ IMU │  EMG  │ │   │ │ IMU │  EMG  │ │   │ │ IMU │  EMG  │ │           │
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>│   │ │(I2C)│ (ADC) │ │   │ │(I2C)│ (ADC) │ │   │ │(I2C)│ (ADC) │ │           │
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>│   │ └─────┴───────┘ │   │ └─────┴───────┘ │   │ └─────┴───────┘ │           │
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a>│   │ esp_timer_get   │   │ esp_timer_get   │   │ esp_timer_get   │           │
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a>│   │ _time() 微秒 ✅  │   │ _time() 微秒 ✅ │   │ _time() 微秒 ✅  │           │
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a>│   └────────┬────────┘   └────────┬────────┘   └────────┬────────┘           │
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a>│            │                     │                     │                    │
</span><span id="__span-12-16"><a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a>│            └──────────── BLE ────┴──────────── BLE ────┘                    │
</span><span id="__span-12-17"><a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a>│                        (±15-30ms 抖动)                                       │
</span><span id="__span-12-18"><a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a>│                                  ↓                                          │
</span><span id="__span-12-19"><a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a>│                            ┌──────────┐                                     │
</span><span id="__span-12-20"><a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a>│                            │  iPhone  │                                     │
</span><span id="__span-12-21"><a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a>│                            │  Camera  │                                     │
</span><span id="__span-12-22"><a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a>│                            └──────────┘                                     │
</span><span id="__span-12-23"><a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a>│                                                                             │
</span><span id="__span-12-24"><a id="__codelineno-12-24" name="__codelineno-12-24" href="#__codelineno-12-24"></a>└─────────────────────────────────────────────────────────────────────────────┘
</span></code></pre></div>
<h5 id="imu">为什么每个单元都必须有 IMU？<a class="headerlink" href="#imu" title="Permanent link">&para;</a></h5>
<div class="language-text highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>┌─────────────────────────────────────────────────────────────────────────────┐
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>│   🔑 关键洞察: Impact 振动传遍全身，每个 IMU 都能检测到!                          │
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>├─────────────────────────────────────────────────────────────────────────────┤
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>│                                                                             │
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>│        [击球瞬间 Impact]                                                     │
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>│              ↓                                                              │
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>│        ┌─────────────────────────────────────────┐                          │
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>│        │           振动传遍身体                    │                          │
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>│        │  手臂 ←──── 核心 ←──── 腿部               │                          │
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>│        │   ↓          ↓          ↓               │                          │
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>│        │  IMU#1     IMU#2      IMU#3             │                          │
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a>│        │  检测到    检测到     检测到               │                          │
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a>│        │  振动峰值   振动峰值   振动峰值             │                          │
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>│        └─────────────────────────────────────────┘                          │
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a>│                                                                             │
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a>│   每个 IMU 都能检测到同一个 Impact 事件 → 这就是 T=0 参考点!                      │
</span><span id="__span-13-17"><a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a>│                                                                             │
</span><span id="__span-13-18"><a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a>│   ❌ 如果某个单元只有 EMG 没有 IMU → 无法检测 Impact → 无法与其他单元对齐!          │
</span><span id="__span-13-19"><a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a>│                                                                             │
</span><span id="__span-13-20"><a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a>└─────────────────────────────────────────────────────────────────────────────┘
</span></code></pre></div>
<h5 id="_3">优势<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h5>
<ul>
<li>✅ 同一部位传感器共享 ESP32 时钟 → 微秒级同步</li>
<li>✅ 每个单元都有 IMU → 可检测 Impact 事件做跨单元同步</li>
<li>✅ 不同部位用 Impact 瞬间对齐 → 消除 BLE 抖动 (±15-30ms)</li>
<li>✅ 减少 BLE 设备数量 → 更稳定的连接</li>
</ul>
<h5 id="_4">同步精度<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h5>
<blockquote>
<p>📐 <strong>详细时间同步规格</strong>: 见 <a href="./data-pipeline.md#sensor-hub-架构-2025-12-推荐">数据管道与AI §1.2</a></p>
</blockquote>
<table>
<thead>
<tr>
<th>场景</th>
<th>目标精度</th>
<th>实际可达</th>
<th>方法</th>
</tr>
</thead>
<tbody>
<tr>
<td>同一 ESP32 (IMU+EMG)</td>
<td>&lt;100 μs</td>
<td>&lt;10 μs</td>
<td>esp<em>timer</em>get_time()</td>
</tr>
<tr>
<td>跨 ESP32 (手臂↔核心)</td>
<td>&lt;1 ms</td>
<td>69-477 μs</td>
<td>Impact 事件对齐</td>
</tr>
<tr>
<td>跨设备 (ESP32↔Vision)</td>
<td>&lt;10 ms</td>
<td>&lt;5 ms</td>
<td>Impact 帧对齐</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>硬件购买清单</strong>: 见 <a href="../../decisions/architecture-decisions-2025-12-23/#43-硬件购买清单">关键决策 2025-12 §4.3</a></p>
</blockquote>
<h4 id="225-融合引擎">2.2.5 融合引擎: 三大机制<a class="headerlink" href="#225-融合引擎" title="Permanent link">&para;</a></h4>
<div class="admonition info">
<p class="admonition-title">融合不是简单叠加，而是三种机制的协同</p>
</div>
<h5 id="1-complementarity">机制 1: 互补性 (Complementarity)<a class="headerlink" href="#1-complementarity" title="Permanent link">&para;</a></h5>
<p>每个传感器测量其他传感器<strong>无法测量</strong>的内容:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>┌──────────────┐   ┌──────────────┐   ┌──────────────┐
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>│    Vision    │   │     IMU      │   │     EMG      │
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>├──────────────┤   ├──────────────┤   ├──────────────┤
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>│ X-Factor   ✅│   │ X-Factor   ❌│   │ X-Factor   ❌│
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>│ 身体姿态    ✅│   │ 身体姿态    ❌│    │ 身体姿态    ❌│
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>│ 空间位置    ✅│   │ 空间位置    ❌│    │ 空间位置    ❌│
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>│              │   │              │    │             │
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>│ 击球时刻    ❌│   │ 击球时刻    ✅│    │ 击球时刻    ❌│
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a>│ 峰值速度    ❌│   │ 峰值速度    ✅│    │ 峰值速度    ❌│
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>│ 3D 旋转    ❌│    │ 3D 旋转   ✅│     │ 3D 旋转    ❌│
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a>│             │    │             │     │             │
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a>│ 肌肉激活    ❌│   │ 肌肉激活    ❌│    │ 肌肉激活    ✅│
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a>│ 疲劳检测    ❌│   │ 疲劳检测    ❌│    │ 疲劳检测    ✅│
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a>│ 力链因果    ❌│   │ 力链因果    ❌│    │ 力链因果    ✅│
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a>└──────────────┘   └──────────────┘   └──────────────┘
</span><span id="__span-14-16"><a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a>
</span><span id="__span-14-17"><a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a>→ 融合 = 完整画面，不是部分视图
</span></code></pre></div>
<h5 id="2-cross-validation">机制 2: 双重/三重验证 (Cross-Validation)<a class="headerlink" href="#2-cross-validation" title="Permanent link">&para;</a></h5>
<p>同一事件被多个传感器测量 → 捕获错误:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>示例: 检测 &quot;Top of Backswing&quot;
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>  Vision 说: Frame 45 (±2帧 = ±66ms)
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>  IMU 说:    T = 1.523s (gyro_z 零交叉, ±0.6ms)
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>  如果 |vision_time - imu_time| &gt; 100ms → 标记为检测错误
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>  如果两者一致 → 高置信度时间戳
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a>  ┌─────────────────────────────────────────────────────────────┐
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a>  │  Ground Truth = IMU (更精确)                                │
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a>  │  Vision = 完整性检查 (身体是否&quot;看起来&quot;像 Top?)               │
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a>  │  EMG = 因果检查 (肌肉是否正确激活?)                         │
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a>  └─────────────────────────────────────────────────────────────┘
</span></code></pre></div>
<div class="admonition tip">
<p class="admonition-title">🔧 调试工具: 可视化交叉验证</p>
<p><strong>问题</strong>: 如何确认 Vision 和 IMU 的阶段检测是否一致?</p>
<p><strong>Rerun 解决方案</strong>:</p>
<table>
<thead>
<tr>
<th>通道</th>
<th>显示内容</th>
<th>验证点</th>
</tr>
</thead>
<tbody>
<tr>
<td>视频通道</td>
<td>骨架叠加 + 阶段标签</td>
<td>身体"看起来"像 Top 吗?</td>
</tr>
<tr>
<td>IMU 曲线</td>
<td>gyro_z 波形 + 零交叉标记</td>
<td>角速度是否过零?</td>
</tr>
<tr>
<td>置信度曲线</td>
<td>融合置信度 0-1</td>
<td>不一致时置信度会下降</td>
</tr>
</tbody>
</table>
<p>当 Vision 说 "Top" 但 IMU 还在运动 → 置信度曲线会下降 → 一眼看出问题</p>
</div>
<h5 id="3-anomaly-detection">机制 3: 异常检测 (Anomaly Detection)<a class="headerlink" href="#3-anomaly-detection" title="Permanent link">&para;</a></h5>
<p>传感器间的<strong>矛盾</strong>揭示隐藏问题:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>┌─────────────────────────────────────────────────────────────────────────────┐
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>│                         异常检测场景 ANOMALY SCENARIOS                       │
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>├─────────────────────────────────────────────────────────────────────────────┤
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>│                                                                             │
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>│   场景 1: 假性蓄力 (FALSE COIL) — 竞品无法检测!                              │
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>│   ─────────────────────────────────────────────────────                     │
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>│   IF: Vision 显示正常 X-Factor (45°)                                        │
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>│   BUT: EMG 显示核心激活 &lt; 50%                                               │
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>│   THEN: &quot;假性蓄力&quot; — 看起来对但肌肉没参与                                   │
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>│   → 用户反馈: &quot;转肩看起来够了，但核心没发力。专注于收紧腹肌。&quot;               │
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>│                                                                             │
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>│   场景 2: 代偿动作 (COMPENSATION)                                           │
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a>│   ─────────────────────────────────────────────────────                     │
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a>│   IF: IMU 显示快速旋转 (高角速度)                                           │
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a>│   BUT: EMG 显示核心未激活，前臂先于核心激活                                  │
</span><span id="__span-16-16"><a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a>│   THEN: &quot;代偿&quot; — 速度来自错误的力量源                                       │
</span><span id="__span-16-17"><a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a>│   → 用户反馈: &quot;速度来自手臂，缺乏核心力量。让身体带动，别用手打。&quot;           │
</span><span id="__span-16-18"><a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a>│                                                                             │
</span><span id="__span-16-19"><a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a>│   场景 3: 传感器故障                                                        │
</span><span id="__span-16-20"><a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a>│   ─────────────────────────────────────────────────────                     │
</span><span id="__span-16-21"><a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a>│   IF: Vision 显示大幅运动                                                   │
</span><span id="__span-16-22"><a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a>│   BUT: IMU 显示静止                                                         │
</span><span id="__span-16-23"><a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a>│   THEN: 传感器可能脱落或故障                                                │
</span><span id="__span-16-24"><a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a>│   → 系统反馈: &quot;请检查 IMU 传感器是否正确佩戴&quot;                               │
</span><span id="__span-16-25"><a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a>│                                                                             │
</span><span id="__span-16-26"><a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a>│   ⚡ 关键洞察:                                                              │
</span><span id="__span-16-27"><a id="__codelineno-16-27" name="__codelineno-16-27" href="#__codelineno-16-27"></a>│   没有融合，你会认为挥杆基于单一指标是&quot;好的&quot;                                 │
</span><span id="__span-16-28"><a id="__codelineno-16-28" name="__codelineno-16-28" href="#__codelineno-16-28"></a>│   有了融合，你能捕获隐藏问题                                                 │
</span><span id="__span-16-29"><a id="__codelineno-16-29" name="__codelineno-16-29" href="#__codelineno-16-29"></a>│                                                                             │
</span><span id="__span-16-30"><a id="__codelineno-16-30" name="__codelineno-16-30" href="#__codelineno-16-30"></a>└─────────────────────────────────────────────────────────────────────────────┘
</span></code></pre></div>
<h3 id="23-特征提取层">2.3 特征提取层<a class="headerlink" href="#23-特征提取层" title="Permanent link">&para;</a></h3>
<p>Stage 4 从原始传感器数据中提取结构化特征。每个 Block 负责一种数据源。</p>
<h4 id="231-积木块接口契约">2.3.1 积木块接口契约<a class="headerlink" href="#231-积木块接口契约" title="Permanent link">&para;</a></h4>
<p>每个积木块有明确的输入/输出契约，确保可替换性:</p>
<h5 id="pose-block">POSE Block 接口<a class="headerlink" href="#pose-block" title="Permanent link">&para;</a></h5>
<div class="language-python highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="c1"># Input</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="nd">@dataclass</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">VideoFrame</span><span class="p">:</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>    <span class="n">rgb</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>           <span class="c1"># [H, W, 3] RGB 图像</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>    <span class="n">timestamp_ms</span><span class="p">:</span> <span class="nb">int</span>         <span class="c1"># 帧时间戳</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="c1"># Output</span>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="nd">@dataclass</span>
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a><span class="k">class</span><span class="w"> </span><span class="nc">PoseResult</span><span class="p">:</span>
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a>    <span class="n">keypoints</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Keypoint</span><span class="p">]</span> <span class="c1"># 33 个关键点</span>
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a>    <span class="n">timestamp_ms</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="__span-17-12"><a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a>    <span class="n">features</span><span class="p">:</span> <span class="n">PoseFeatures</span>
</span><span id="__span-17-13"><a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a>
</span><span id="__span-17-14"><a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a><span class="nd">@dataclass</span>
</span><span id="__span-17-15"><a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a><span class="k">class</span><span class="w"> </span><span class="nc">PoseFeatures</span><span class="p">:</span>
</span><span id="__span-17-16"><a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a>    <span class="n">x_factor</span><span class="p">:</span> <span class="nb">float</span>           <span class="c1"># 肩髋分离角 (度)</span>
</span><span id="__span-17-17"><a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a>    <span class="n">x_factor_stretch</span><span class="p">:</span> <span class="nb">float</span>   <span class="c1"># X-Factor 延展</span>
</span><span id="__span-17-18"><a id="__codelineno-17-18" name="__codelineno-17-18" href="#__codelineno-17-18"></a>    <span class="n">s_factor</span><span class="p">:</span> <span class="nb">float</span>           <span class="c1"># 肩部倾斜角 (度)</span>
</span><span id="__span-17-19"><a id="__codelineno-17-19" name="__codelineno-17-19" href="#__codelineno-17-19"></a>    <span class="n">o_factor</span><span class="p">:</span> <span class="nb">float</span>           <span class="c1"># 骨盆倾斜角 (度)</span>
</span><span id="__span-17-20"><a id="__codelineno-17-20" name="__codelineno-17-20" href="#__codelineno-17-20"></a>    <span class="n">sway</span><span class="p">:</span> <span class="nb">float</span>               <span class="c1"># 髋部侧移 (归一化)</span>
</span><span id="__span-17-21"><a id="__codelineno-17-21" name="__codelineno-17-21" href="#__codelineno-17-21"></a>    <span class="n">lift</span><span class="p">:</span> <span class="nb">float</span>               <span class="c1"># 髋部抬升 (归一化)</span>
</span></code></pre></div>
<h5 id="imu-block">IMU Block 接口<a class="headerlink" href="#imu-block" title="Permanent link">&para;</a></h5>
<div class="language-python highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c1"># Input</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="nd">@dataclass</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">RawIMU</span><span class="p">:</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>    <span class="n">gyro</span><span class="p">:</span> <span class="n">Vector3</span>             <span class="c1"># [x,y,z] °/s</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>    <span class="n">accel</span><span class="p">:</span> <span class="n">Vector3</span>            <span class="c1"># [x,y,z] g</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>    <span class="n">timestamp_us</span><span class="p">:</span> <span class="nb">int</span>         <span class="c1"># 微秒时间戳</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="c1"># Output</span>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="nd">@dataclass</span>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="k">class</span><span class="w"> </span><span class="nc">IMUFeatures</span><span class="p">:</span>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a>    <span class="n">phase</span><span class="p">:</span> <span class="nb">str</span>                <span class="c1"># 当前阶段 (Address/Top/Impact/...)</span>
</span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a>    <span class="n">phase_confidence</span><span class="p">:</span> <span class="nb">float</span>   <span class="c1"># 阶段置信度 [0-1]</span>
</span><span id="__span-18-13"><a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a>    <span class="n">peak_velocity</span><span class="p">:</span> <span class="nb">float</span>      <span class="c1"># 峰值角速度 (°/s)</span>
</span><span id="__span-18-14"><a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a>    <span class="n">tempo_ratio</span><span class="p">:</span> <span class="nb">float</span>        <span class="c1"># 上杆/下杆时间比</span>
</span><span id="__span-18-15"><a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a>    <span class="n">backswing_duration_ms</span><span class="p">:</span> <span class="nb">int</span>  <span class="c1"># 上杆时长</span>
</span><span id="__span-18-16"><a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a>    <span class="n">downswing_duration_ms</span><span class="p">:</span> <span class="nb">int</span>  <span class="c1"># 下杆时长</span>
</span><span id="__span-18-17"><a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a>    <span class="n">timestamp_ms</span><span class="p">:</span> <span class="nb">int</span>
</span></code></pre></div>
<h5 id="emg-block">EMG Block 接口<a class="headerlink" href="#emg-block" title="Permanent link">&para;</a></h5>
<div class="language-python highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c1"># Input</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="nd">@dataclass</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">RawEMG</span><span class="p">:</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>    <span class="n">core_mv</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>      <span class="c1"># 核心肌群原始信号 (mV)</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>    <span class="n">forearm_mv</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>   <span class="c1"># 前臂原始信号 (mV)</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>    <span class="n">timestamp_ms</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="c1"># Output</span>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="nd">@dataclass</span>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="k">class</span><span class="w"> </span><span class="nc">EMGFeatures</span><span class="p">:</span>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a>    <span class="n">onset_times</span><span class="p">:</span> <span class="n">OnsetTimes</span>   <span class="c1"># 激活起始时间</span>
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a>    <span class="n">activation_pct</span><span class="p">:</span> <span class="n">ActivationPct</span>  <span class="c1"># 激活百分比 [0-1]</span>
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a>    <span class="n">timing_gap_ms</span><span class="p">:</span> <span class="nb">int</span>        <span class="c1"># forearm_onset - core_onset</span>
</span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a>    <span class="n">fatigue_ratio</span><span class="p">:</span> <span class="nb">float</span>      <span class="c1"># 当前/初始激活强度比</span>
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a>    <span class="n">timestamp_ms</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="__span-19-16"><a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a>
</span><span id="__span-19-17"><a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a><span class="nd">@dataclass</span>
</span><span id="__span-19-18"><a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a><span class="k">class</span><span class="w"> </span><span class="nc">OnsetTimes</span><span class="p">:</span>
</span><span id="__span-19-19"><a id="__codelineno-19-19" name="__codelineno-19-19" href="#__codelineno-19-19"></a>    <span class="n">core_ms</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="__span-19-20"><a id="__codelineno-19-20" name="__codelineno-19-20" href="#__codelineno-19-20"></a>    <span class="n">forearm_ms</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="__span-19-21"><a id="__codelineno-19-21" name="__codelineno-19-21" href="#__codelineno-19-21"></a>
</span><span id="__span-19-22"><a id="__codelineno-19-22" name="__codelineno-19-22" href="#__codelineno-19-22"></a><span class="nd">@dataclass</span>
</span><span id="__span-19-23"><a id="__codelineno-19-23" name="__codelineno-19-23" href="#__codelineno-19-23"></a><span class="k">class</span><span class="w"> </span><span class="nc">ActivationPct</span><span class="p">:</span>
</span><span id="__span-19-24"><a id="__codelineno-19-24" name="__codelineno-19-24" href="#__codelineno-19-24"></a>    <span class="n">core</span><span class="p">:</span> <span class="nb">float</span>               <span class="c1"># [0-1]</span>
</span><span id="__span-19-25"><a id="__codelineno-19-25" name="__codelineno-19-25" href="#__codelineno-19-25"></a>    <span class="n">forearm</span><span class="p">:</span> <span class="nb">float</span>            <span class="c1"># [0-1]</span>
</span></code></pre></div>
<h5 id="classifier-block">CLASSIFIER Block 接口<a class="headerlink" href="#classifier-block" title="Permanent link">&para;</a></h5>
<div class="language-python highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="c1"># Input</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="nd">@dataclass</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">ClassifierInput</span><span class="p">:</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>    <span class="n">pose_sequence</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PoseResult</span><span class="p">]</span>  <span class="c1"># N 帧姿态序列</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>    <span class="n">imu_features</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">IMUFeatures</span><span class="p">]</span>  <span class="c1"># 可选 IMU 辅助</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="c1"># Output</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="nd">@dataclass</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="k">class</span><span class="w"> </span><span class="nc">ClassifierResult</span><span class="p">:</span>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a>    <span class="n">phases</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PhaseLabel</span><span class="p">]</span>  <span class="c1"># N × {label, confidence}</span>
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a>    <span class="n">phase_boundaries</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PhaseBoundary</span><span class="p">]</span>
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a>
</span><span id="__span-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a><span class="nd">@dataclass</span>
</span><span id="__span-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a><span class="k">class</span><span class="w"> </span><span class="nc">PhaseLabel</span><span class="p">:</span>
</span><span id="__span-20-15"><a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a>    <span class="n">label</span><span class="p">:</span> <span class="nb">int</span>                <span class="c1"># 0-7 阶段编号</span>
</span><span id="__span-20-16"><a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a>    <span class="n">confidence</span><span class="p">:</span> <span class="nb">float</span>         <span class="c1"># [0-1]</span>
</span><span id="__span-20-17"><a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a>
</span><span id="__span-20-18"><a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a><span class="nd">@dataclass</span>
</span><span id="__span-20-19"><a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a><span class="k">class</span><span class="w"> </span><span class="nc">PhaseBoundary</span><span class="p">:</span>
</span><span id="__span-20-20"><a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a>    <span class="n">phase</span><span class="p">:</span> <span class="nb">int</span>                <span class="c1"># 阶段编号</span>
</span><span id="__span-20-21"><a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a>    <span class="n">start_ms</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="__span-20-22"><a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a>    <span class="n">end_ms</span><span class="p">:</span> <span class="nb">int</span>
</span></code></pre></div>
<h5 id="fusion-block">FUSION Block 接口<a class="headerlink" href="#fusion-block" title="Permanent link">&para;</a></h5>
<div class="language-python highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="c1"># Input</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="nd">@dataclass</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">FusionInput</span><span class="p">:</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>    <span class="n">pose</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PoseResult</span><span class="p">]</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>    <span class="n">imu</span><span class="p">:</span> <span class="n">IMUFeatures</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>    <span class="n">emg</span><span class="p">:</span> <span class="n">EMGFeatures</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>    <span class="n">classifier</span><span class="p">:</span> <span class="n">ClassifierResult</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="c1"># Output</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="nd">@dataclass</span>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="k">class</span><span class="w"> </span><span class="nc">FusionResult</span><span class="p">:</span>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a>    <span class="n">phases</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">FusedPhase</span><span class="p">]</span>  <span class="c1"># 融合后的阶段</span>
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a>    <span class="n">metrics</span><span class="p">:</span> <span class="n">SwingMetrics</span>     <span class="c1"># 12 个结构化指标</span>
</span><span id="__span-21-14"><a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a>    <span class="n">anomalies</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Anomaly</span><span class="p">]</span>  <span class="c1"># 异常检测结果</span>
</span><span id="__span-21-15"><a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a>    <span class="n">overall_confidence</span><span class="p">:</span> <span class="nb">float</span> <span class="c1"># 整体置信度</span>
</span><span id="__span-21-16"><a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a>    <span class="n">triggered_rules</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">DiagnosticRule</span><span class="p">]</span>  <span class="c1"># 触发的诊断规则</span>
</span><span id="__span-21-17"><a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a>
</span><span id="__span-21-18"><a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a><span class="nd">@dataclass</span>
</span><span id="__span-21-19"><a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a><span class="k">class</span><span class="w"> </span><span class="nc">FusedPhase</span><span class="p">:</span>
</span><span id="__span-21-20"><a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a>    <span class="n">label</span><span class="p">:</span> <span class="nb">str</span>                <span class="c1"># &quot;Address&quot; / &quot;Top&quot; / &quot;Impact&quot; / ...</span>
</span><span id="__span-21-21"><a id="__codelineno-21-21" name="__codelineno-21-21" href="#__codelineno-21-21"></a>    <span class="n">start_ms</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="__span-21-22"><a id="__codelineno-21-22" name="__codelineno-21-22" href="#__codelineno-21-22"></a>    <span class="n">end_ms</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="__span-21-23"><a id="__codelineno-21-23" name="__codelineno-21-23" href="#__codelineno-21-23"></a>    <span class="n">confidence</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="__span-21-24"><a id="__codelineno-21-24" name="__codelineno-21-24" href="#__codelineno-21-24"></a>
</span><span id="__span-21-25"><a id="__codelineno-21-25" name="__codelineno-21-25" href="#__codelineno-21-25"></a><span class="nd">@dataclass</span>
</span><span id="__span-21-26"><a id="__codelineno-21-26" name="__codelineno-21-26" href="#__codelineno-21-26"></a><span class="k">class</span><span class="w"> </span><span class="nc">SwingMetrics</span><span class="p">:</span>
</span><span id="__span-21-27"><a id="__codelineno-21-27" name="__codelineno-21-27" href="#__codelineno-21-27"></a>    <span class="c1"># Vision (6)</span>
</span><span id="__span-21-28"><a id="__codelineno-21-28" name="__codelineno-21-28" href="#__codelineno-21-28"></a>    <span class="n">x_factor</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="__span-21-29"><a id="__codelineno-21-29" name="__codelineno-21-29" href="#__codelineno-21-29"></a>    <span class="n">x_factor_stretch</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="__span-21-30"><a id="__codelineno-21-30" name="__codelineno-21-30" href="#__codelineno-21-30"></a>    <span class="n">shoulder_turn</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="__span-21-31"><a id="__codelineno-21-31" name="__codelineno-21-31" href="#__codelineno-21-31"></a>    <span class="n">hip_turn</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="__span-21-32"><a id="__codelineno-21-32" name="__codelineno-21-32" href="#__codelineno-21-32"></a>    <span class="n">s_factor</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="__span-21-33"><a id="__codelineno-21-33" name="__codelineno-21-33" href="#__codelineno-21-33"></a>    <span class="n">sway_lift</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="__span-21-34"><a id="__codelineno-21-34" name="__codelineno-21-34" href="#__codelineno-21-34"></a>    <span class="c1"># IMU (4)</span>
</span><span id="__span-21-35"><a id="__codelineno-21-35" name="__codelineno-21-35" href="#__codelineno-21-35"></a>    <span class="n">peak_velocity</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="__span-21-36"><a id="__codelineno-21-36" name="__codelineno-21-36" href="#__codelineno-21-36"></a>    <span class="n">tempo_ratio</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="__span-21-37"><a id="__codelineno-21-37" name="__codelineno-21-37" href="#__codelineno-21-37"></a>    <span class="n">backswing_duration</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="__span-21-38"><a id="__codelineno-21-38" name="__codelineno-21-38" href="#__codelineno-21-38"></a>    <span class="n">downswing_duration</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="__span-21-39"><a id="__codelineno-21-39" name="__codelineno-21-39" href="#__codelineno-21-39"></a>    <span class="c1"># EMG (2)</span>
</span><span id="__span-21-40"><a id="__codelineno-21-40" name="__codelineno-21-40" href="#__codelineno-21-40"></a>    <span class="n">core_activation</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="__span-21-41"><a id="__codelineno-21-41" name="__codelineno-21-41" href="#__codelineno-21-41"></a>    <span class="n">core_forearm_gap</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="__span-21-42"><a id="__codelineno-21-42" name="__codelineno-21-42" href="#__codelineno-21-42"></a>
</span><span id="__span-21-43"><a id="__codelineno-21-43" name="__codelineno-21-43" href="#__codelineno-21-43"></a><span class="nd">@dataclass</span>
</span><span id="__span-21-44"><a id="__codelineno-21-44" name="__codelineno-21-44" href="#__codelineno-21-44"></a><span class="k">class</span><span class="w"> </span><span class="nc">Anomaly</span><span class="p">:</span>
</span><span id="__span-21-45"><a id="__codelineno-21-45" name="__codelineno-21-45" href="#__codelineno-21-45"></a>    <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span>                 <span class="c1"># &quot;FALSE_COIL&quot; / &quot;COMPENSATION&quot; / ...</span>
</span><span id="__span-21-46"><a id="__codelineno-21-46" name="__codelineno-21-46" href="#__codelineno-21-46"></a>    <span class="n">severity</span><span class="p">:</span> <span class="nb">str</span>             <span class="c1"># &quot;P0&quot; / &quot;P1&quot; / &quot;P2&quot;</span>
</span><span id="__span-21-47"><a id="__codelineno-21-47" name="__codelineno-21-47" href="#__codelineno-21-47"></a>    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-21-48"><a id="__codelineno-21-48" name="__codelineno-21-48" href="#__codelineno-21-48"></a>
</span><span id="__span-21-49"><a id="__codelineno-21-49" name="__codelineno-21-49" href="#__codelineno-21-49"></a><span class="nd">@dataclass</span>
</span><span id="__span-21-50"><a id="__codelineno-21-50" name="__codelineno-21-50" href="#__codelineno-21-50"></a><span class="k">class</span><span class="w"> </span><span class="nc">DiagnosticRule</span><span class="p">:</span>
</span><span id="__span-21-51"><a id="__codelineno-21-51" name="__codelineno-21-51" href="#__codelineno-21-51"></a>    <span class="n">rule_id</span><span class="p">:</span> <span class="nb">str</span>              <span class="c1"># &quot;ARMS_BEFORE_CORE&quot; / &quot;LOW_X_FACTOR&quot; / ...</span>
</span><span id="__span-21-52"><a id="__codelineno-21-52" name="__codelineno-21-52" href="#__codelineno-21-52"></a>    <span class="n">priority</span><span class="p">:</span> <span class="nb">str</span>             <span class="c1"># &quot;P0&quot; / &quot;P1&quot; / &quot;P2&quot;</span>
</span><span id="__span-21-53"><a id="__codelineno-21-53" name="__codelineno-21-53" href="#__codelineno-21-53"></a>    <span class="n">message_cn</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-21-54"><a id="__codelineno-21-54" name="__codelineno-21-54" href="#__codelineno-21-54"></a>    <span class="n">message_en</span><span class="p">:</span> <span class="nb">str</span>
</span></code></pre></div>
<h4 id="232-pose-block">2.3.2 POSE Block 实现<a class="headerlink" href="#232-pose-block" title="Permanent link">&para;</a></h4>
<p><strong>职责</strong>: 从视频帧提取人体 33 个关键点坐标</p>
<p><strong>MVP 选择</strong>: MediaPipe BlazePose</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>值</th>
</tr>
</thead>
<tbody>
<tr>
<td>精度</td>
<td>AP 65%</td>
</tr>
<tr>
<td>速度</td>
<td>30 FPS</td>
</tr>
<tr>
<td>训练数据</td>
<td>0 (预训练)</td>
</tr>
<tr>
<td>平台</td>
<td>iOS / Android 原生支持</td>
</tr>
</tbody>
</table>
<p><strong>选择理由</strong>:</p>
<ul>
<li>开箱即用，MediaPipeTasksVision iOS SDK 官方支持</li>
<li>33 关键点足够计算 X-Factor、肩转、髋转</li>
<li>不需要任何训练数据</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">🔧 调试工具: MediaPipe 骨架可视化</p>
<p>Rerun 官方提供 <a href="https://rerun.io/examples/video-image/human_pose_tracking">human<em>pose</em>tracking</a> 示例:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>pip<span class="w"> </span>install<span class="w"> </span>rerun-sdk
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>python<span class="w"> </span>-m<span class="w"> </span>rerun_demos.human_pose_tracking
</span></code></pre></div>
<p>可验证:</p>
<ul>
<li>33 关键点是否完整检测</li>
<li>关键点 visibility 是否足够 (遮挡问题)</li>
<li>X-Factor 等特征计算是否正确 (叠加角度线)</li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">备选方案</p>
<table>
<thead>
<tr>
<th>方案</th>
<th>精度</th>
<th>速度</th>
<th>何时考虑</th>
</tr>
</thead>
<tbody>
<tr>
<td>RTMPose</td>
<td>AP 75.8%</td>
<td>25 FPS</td>
<td>需要更高精度</td>
</tr>
<tr>
<td>ViTPose++</td>
<td>AP 81%</td>
<td>15 FPS</td>
<td>精度优先，速度可接受</td>
</tr>
<tr>
<td>Custom Model</td>
<td>待定</td>
<td>待定</td>
<td>积累大量高尔夫数据后</td>
</tr>
</tbody>
</table>
</div>
<h5 id="_5">可计算的特征<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h5>
<table>
<thead>
<tr>
<th>特征</th>
<th>计算方法</th>
<th>关键点</th>
<th>用途</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>X-Factor</strong></td>
<td>肩部连线角 - 骨盆连线角</td>
<td>11,12,23,24</td>
<td>蓄力评估</td>
</tr>
<tr>
<td><strong>X-Factor Stretch</strong></td>
<td>下杆期最大 X-Factor - Top 时 X-Factor</td>
<td>同上</td>
<td>蓄力质量</td>
</tr>
<tr>
<td><strong>S-Factor</strong></td>
<td>肩部倾斜角</td>
<td>11,12</td>
<td>姿态评估</td>
</tr>
<tr>
<td><strong>O-Factor</strong></td>
<td>骨盆倾斜角</td>
<td>23,24</td>
<td>下盘稳定</td>
</tr>
<tr>
<td><strong>Sway/Lift</strong></td>
<td>髋部中心位移 vs Address</td>
<td>23,24</td>
<td>重心控制</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">详细算法实现</p>
<p>计算代码见 <a href="./metrics-calculation.md#31-vision-数据处理-mediapipe-33-landmarks">数据处理与指标计算 §3.1</a></p>
</div>
<h4 id="233-imu-block">2.3.3 IMU Block 实现<a class="headerlink" href="#233-imu-block" title="Permanent link">&para;</a></h4>
<p><strong>职责</strong>: 从惯性测量单元提取角速度、加速度等时序特征</p>
<p><strong>MVP 选择</strong>: 模拟数据 (Simulated JSON)</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>值</th>
</tr>
</thead>
<tbody>
<tr>
<td>数据源</td>
<td>JSON 文件 (基于研究论文) 或从 Pose 数据生成</td>
</tr>
<tr>
<td>采样率</td>
<td>100Hz (模拟) / 1666Hz (真实)</td>
</tr>
<tr>
<td>用途</td>
<td>开发调试，验证完整管道，无需等待硬件</td>
</tr>
</tbody>
</table>
<p><strong>模拟数据设计</strong>:</p>
<ul>
<li>峰值角速度: 800-1500°/s (职业范围)</li>
<li>节奏比: 2.5-3.5:1 (理想范围)</li>
<li>噪声模型: 高斯噪声 + 漂移模拟</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">🔧 调试工具: IMU 曲线与阶段对齐</p>
<p><strong>问题</strong>: 模拟 IMU 数据的峰值/零交叉点是否正确?</p>
<p><strong>Rerun 解决方案</strong>:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>gyro_z (°/s)
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>     │
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>1200 ┤                    ●─── Impact 峰值
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>     │                   ╱│
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a> 600 ┤                  ╱ │
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>     │                 ╱  │
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>   0 ┤────────────●───╱───┴──── Top (零交叉)
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a>     │   Address   ╲ ╱
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a>-600 ┤              V
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a>     └────────────────────────────→ time
</span></code></pre></div>
<p>Rerun 曲线视图可以自动检测峰值和零交叉，与视频帧同步验证</p>
</div>
<h5 id="imu_1">模拟 IMU 数据生成<a class="headerlink" href="#imu_1" title="Permanent link">&para;</a></h5>
<p><strong>原理</strong>: 用 MediaPipe 关键点序列<strong>导数</strong>近似 IMU 角速度</p>
<table>
<thead>
<tr>
<th>函数</th>
<th>输入</th>
<th>输出</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>simulate_imu_from_pose()</code></td>
<td>MediaPipe 33 关键点序列</td>
<td><code>List[SimulatedIMUFrame]</code></td>
</tr>
</tbody>
</table>
<p><strong>数据结构</strong>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="nd">@dataclass</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">SimulatedIMUFrame</span><span class="p">:</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>    <span class="n">timestamp_ms</span><span class="p">:</span> <span class="nb">int</span>        <span class="c1"># 时间戳</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>    <span class="n">gyro_z</span><span class="p">:</span> <span class="nb">float</span>            <span class="c1"># 主轴角速度 (°/s)</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>    <span class="n">gyro_magnitude</span><span class="p">:</span> <span class="nb">float</span>    <span class="c1"># 合成角速度</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>    <span class="n">accel_magnitude</span><span class="p">:</span> <span class="nb">float</span>   <span class="c1"># 合成加速度</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>    <span class="n">phase_hint</span><span class="p">:</span> <span class="nb">str</span>          <span class="c1"># 预期阶段 (TOP/IMPACT/...)</span>
</span></code></pre></div>
<div class="admonition tip">
<p class="admonition-title">完整算法实现</p>
<p>详细代码和测试场景见 <a href="./metrics-calculation.md#51-从-pose-数据生成模拟-imu">数据处理与指标计算 §5.1</a></p>
</div>
<div class="admonition note">
<p class="admonition-title">真实硬件选项 (Phase 2+)</p>
<p><strong>推荐硬件</strong>: Adafruit LSM6DSV16X (ADA-5783) — 45+ 分钟漂移稳定性</p>
<table>
<thead>
<tr>
<th>方案</th>
<th>精度</th>
<th>硬件</th>
<th>何时引入</th>
</tr>
</thead>
<tbody>
<tr>
<td>Single Wrist IMU</td>
<td>±9-15ms</td>
<td>LSM6DSV16X</td>
<td>硬件原型完成</td>
</tr>
<tr>
<td>Dual IMU</td>
<td>±5ms</td>
<td>Wrist + Pelvis</td>
<td>运动链分析</td>
</tr>
<tr>
<td>Multi-point (4+)</td>
<td>±2ms</td>
<td>完整穿戴</td>
<td>完整运动链</td>
</tr>
</tbody>
</table>
<p>⚠️ <strong>WitMotion WT901 警告</strong>: 必须禁用其 BLE，通过 I2C 连接 ESP32 使用</p>
</div>
<h5 id="imu_2">真实 IMU 检测能力<a class="headerlink" href="#imu_2" title="Permanent link">&para;</a></h5>
<table>
<thead>
<tr>
<th>特征</th>
<th>描述</th>
<th>阈值参考</th>
<th>用途</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Peak Angular Velocity</strong></td>
<td>杆头最大角速度</td>
<td>Pro: 800-1500°/s</td>
<td>爆发力评估</td>
</tr>
<tr>
<td><strong>Kinematic Sequence</strong></td>
<td>运动链时序</td>
<td>Pelvis→Torso→Arm→Club</td>
<td>动力传递验证</td>
</tr>
<tr>
<td><strong>Tempo Ratio</strong></td>
<td>上杆/下杆时间比</td>
<td>理想: 2.5-3.5:1</td>
<td>节奏评估</td>
</tr>
<tr>
<td><strong>Transition Timing</strong></td>
<td>转换点精度</td>
<td>±0.6ms 可检测</td>
<td>力量爆发点</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">详细算法实现</p>
<p>峰值检测、运动链验证代码见 <a href="./metrics-calculation.md#32-imu-数据处理-lsm6dsv16x--1666hz">数据处理与指标计算 §3.2</a></p>
</div>
<h4 id="234-emg-block">2.3.4 EMG Block 实现<a class="headerlink" href="#234-emg-block" title="Permanent link">&para;</a></h4>
<p><strong>职责</strong>: 从肌电传感器提取肌肉激活时序和强度</p>
<p><strong>MVP 选择</strong>: 模拟数据 (Simulated JSON)</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>值</th>
</tr>
</thead>
<tbody>
<tr>
<td>数据源</td>
<td>JSON 文件 (基于研究论文) 或根据阶段时间戳生成</td>
</tr>
<tr>
<td>通道数</td>
<td>2 (Core + Forearm)</td>
</tr>
<tr>
<td>采样率</td>
<td>500Hz (模拟) / 1000Hz (真实)</td>
</tr>
</tbody>
</table>
<p><strong>模拟数据设计</strong>:</p>
<ul>
<li>正确模式: Core 先于 Forearm 激活 (&gt;20ms)</li>
<li>错误模式: Forearm 先于 Core (模拟"手臂先动"问题)</li>
<li>包络处理: RMS 平滑后归一化到 0-100%</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">🔧 调试工具: EMG 激活时序可视化</p>
<p><strong>问题</strong>: 如何验证 Core 真的比 Forearm 先激活?</p>
<p><strong>Rerun 解决方案</strong>:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>EMG 包络 (归一化)
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>  1.0│      Core (红)     Forearm (蓝)
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>     │        ┌──╮           ┌──╮
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>  0.5│       ╱    ╲         ╱    ╲
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>     │      ╱      ╲       ╱      ╲
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>  0.0├─────●────────╲─────●────────╲────→ time
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a>          ↑ Core     ╲    ↑ Forearm
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>          onset       ╲   onset
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a>          (570ms)      ╲  (720ms)
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a>                        ╲
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a>                     gap = 150ms ✓
</span></code></pre></div>
<p>两条 EMG 曲线叠加显示，onset 标记一目了然</p>
</div>
<h5 id="emg_1">模拟 EMG 数据生成<a class="headerlink" href="#emg_1" title="Permanent link">&para;</a></h5>
<p><strong>原理</strong>: 根据已知生物力学时序生成<strong>符合真实模式</strong>的 EMG 信号</p>
<table>
<thead>
<tr>
<th>模式</th>
<th>描述</th>
<th>时序特征</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CORRECT</code></td>
<td>正确运动链</td>
<td>Core 先于 Forearm &gt;20ms</td>
</tr>
<tr>
<td><code>ARMS_FIRST</code></td>
<td>错误 — 手臂先动</td>
<td>Forearm 先于 Core</td>
</tr>
<tr>
<td><code>FALSE_COIL</code></td>
<td>假性蓄力</td>
<td>时序正确，Core &lt;50%</td>
</tr>
<tr>
<td><code>FATIGUED</code></td>
<td>疲劳模式</td>
<td>整体激活衰减</td>
</tr>
</tbody>
</table>
<p><strong>核心函数</strong>: <code>simulate_emg_from_phases(phase_timestamps, pattern) → SimulatedEMGResult</code></p>
<div class="admonition warning">
<p class="admonition-title">False Coil 是竞争护城河</p>
<p>假性蓄力 (False Coil) 是<strong>只有三模态融合才能检测</strong>的问题:</p>
<ul>
<li>Vision 看到: X-Factor = 45° ✅ (正常)</li>
<li>IMU 看到: 正常旋转时序 ✅</li>
<li>EMG 看到: Core activation = 30% ❌ (过低)</li>
</ul>
<p>结论: 球员"装"出了正确的姿势，但核心肌群没有真正参与。
这是 Vision-only 竞品永远无法检测的问题。</p>
</div>
<div class="admonition tip">
<p class="admonition-title">完整算法实现</p>
<p>详细代码和测试场景见 <a href="./metrics-calculation.md#52-从阶段时间戳生成模拟-emg">数据处理与指标计算 §5.2</a></p>
</div>
<div class="admonition note">
<p class="admonition-title">真实硬件选项 (Phase 2+)</p>
<p>🔴 <strong>CRITICAL</strong>: MyoWare 2.0 没有焊孔，只有 Snap 扣。Link Shield (DEV-18425) 是<strong>必需品</strong>！</p>
<p><strong>推荐套装</strong> (每个身体部位):
- 1x MyoWare 2.0 Muscle Sensor (~<span class="arithmatex">\(40)
- 1x MyoWare 2.0 Link Shield (\)</span>4.50) ← 必需！</p>
<p>⚠️ <strong>警告</strong>: DFRobot SEN0240 有线缆噪声问题，仅适用静态测量，不适合高速挥杆。</p>
<table>
<thead>
<tr>
<th>方案</th>
<th>通道</th>
<th>肌肉群</th>
<th>何时引入</th>
</tr>
</thead>
<tbody>
<tr>
<td>2-channel</td>
<td>2</td>
<td>Core + Forearm</td>
<td>硬件原型</td>
</tr>
<tr>
<td>4-channel</td>
<td>4</td>
<td>+ Gluteus, Adductors</td>
<td>下肢分析</td>
</tr>
<tr>
<td>6-channel</td>
<td>6</td>
<td>+ Lats, Deltoids</td>
<td>完整上身</td>
</tr>
</tbody>
</table>
</div>
<h5 id="emg_2">EMG 电极布局规划<a class="headerlink" href="#emg_2" title="Permanent link">&para;</a></h5>
<p>MVP 阶段使用 2 通道 (Core + Forearm)，后续渐进扩展：</p>
<table>
<thead>
<tr>
<th>阶段</th>
<th>通道</th>
<th>肌群覆盖</th>
<th>可检测能力</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Phase 1</strong></td>
<td>2</td>
<td>腹直肌 + 前臂屈肌</td>
<td>False Coil, 核心激活时序</td>
</tr>
<tr>
<td><strong>Phase 2</strong></td>
<td>4</td>
<td>+ 臀大肌, 内收肌</td>
<td>下肢驱动, 髋部稳定</td>
</tr>
<tr>
<td><strong>Phase 3</strong></td>
<td>6</td>
<td>+ 背阔肌, 三角肌</td>
<td>完整力链验证</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">详细布局图</p>
<p>电极放置位置、选择依据见 <a href="./metrics-calculation.md#333-emg-传感器布局规划">数据处理与指标计算 §3.3.3</a></p>
</div>
<h5 id="emg_3">真实 EMG 检测能力<a class="headerlink" href="#emg_3" title="Permanent link">&para;</a></h5>
<table>
<thead>
<tr>
<th>特征</th>
<th>描述</th>
<th>信号处理</th>
<th>用途</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Muscle Onset</strong></td>
<td>肌肉激活起始时间</td>
<td>阈值检测 (10% MVC)</td>
<td>运动链时序</td>
</tr>
<tr>
<td><strong>Peak Activation</strong></td>
<td>最大肌电幅值</td>
<td>RMS 包络</td>
<td>力量输出评估</td>
</tr>
<tr>
<td><strong>Fatigue Detection</strong></td>
<td>肌肉疲劳指标</td>
<td>频谱中值下降</td>
<td>训练负荷监控</td>
</tr>
<tr>
<td><strong>Co-activation</strong></td>
<td>拮抗肌同时激活</td>
<td>双通道比较</td>
<td>动作效率分析</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">详细算法实现</p>
<p>信号处理、特征提取代码见 <a href="./metrics-calculation.md#33-emg-数据处理-unique-capability">数据处理与指标计算 §3.3</a></p>
</div>
<h3 id="24-分析诊断层">2.4 分析诊断层<a class="headerlink" href="#24-分析诊断层" title="Permanent link">&para;</a></h3>
<p>对提取的特征进行智能分析，识别挥杆阶段并融合多模态数据。</p>
<h4 id="241-classifier-block">2.4.1 CLASSIFIER Block<a class="headerlink" href="#241-classifier-block" title="Permanent link">&para;</a></h4>
<p><strong>职责</strong>: 根据关键点序列识别挥杆的 8 个阶段</p>
<p><strong>MVP 选择</strong>: Simple Rules (基于 IMU 信号)</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>值</th>
</tr>
</thead>
<tbody>
<tr>
<td>方法</td>
<td>IMU gyro_z 信号分析</td>
</tr>
<tr>
<td>Top 检测</td>
<td>gyro_z 零交叉点 (方向反转)</td>
</tr>
<tr>
<td>Impact 检测</td>
<td>gyro_z 峰值点 (最大角速度)</td>
</tr>
<tr>
<td>训练数据</td>
<td>0 (纯规则)</td>
</tr>
<tr>
<td>精度</td>
<td>±0.6ms (IMU 原生精度)</td>
</tr>
</tbody>
</table>
<p><strong>选择理由</strong>:</p>
<ul>
<li><strong>无需训练数据</strong> — 纯物理信号分析</li>
<li><strong>更高精度</strong> — IMU 1666Hz vs Vision 30Hz</li>
<li><strong>可解释性强</strong> — 零交叉和峰值点有明确物理意义</li>
<li><strong>调试简单</strong> — Rerun 中一眼可见峰值和零交叉</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>Phase 检测原理 (Simple Rules):
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>───────────────────────────────
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>gyro_z (°/s)
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>     │
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>1200 ┤                    ●─── Impact (峰值点)
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>     │                   ╱│
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a> 600 ┤                  ╱ │
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>     │                 ╱  │
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>   0 ┤────────────●───╱───┴──── Top (零交叉点)
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>     │   Address   ╲ ╱
</span><span id="__span-26-11"><a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a>-600 ┤              V
</span><span id="__span-26-12"><a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a>     └────────────────────────────→ time
</span><span id="__span-26-13"><a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a>
</span><span id="__span-26-14"><a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a>Top = gyro_z 从负→正 零交叉 (上杆结束，下杆开始)
</span><span id="__span-26-15"><a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a>Impact = gyro_z 正向峰值 (最大旋转速度)
</span></code></pre></div>
<div class="admonition note">
<p class="admonition-title">备选方案 (Phase 2+)</p>
<table>
<thead>
<tr>
<th>方案</th>
<th>准确率</th>
<th>训练数据</th>
<th>速度</th>
<th>何时考虑</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>SwingNet</strong></td>
<td>71.5%</td>
<td>0 (预训练)</td>
<td>5ms</td>
<td>需要完整 8 阶段划分时</td>
</tr>
<tr>
<td>Random Forest</td>
<td>~65%</td>
<td>~500 videos</td>
<td>&lt;1ms</td>
<td>快速 baseline</td>
</tr>
<tr>
<td>BiGRU</td>
<td>~80%</td>
<td>~1000 videos</td>
<td>3ms</td>
<td>积累 1000 视频后</td>
</tr>
<tr>
<td>Transformer</td>
<td>~88%</td>
<td>~10000+</td>
<td>10ms</td>
<td>大量数据后</td>
</tr>
</tbody>
</table>
<p><strong>研究发现 (CaddieSet CVPR 2025)</strong>: 关节特征 + 时序模型 (MSE 8.80) 优于纯视觉 Transformer (MSE 32.32)</p>
</div>
<h4 id="242-fusion-block">2.4.2 FUSION Block<a class="headerlink" href="#242-fusion-block" title="Permanent link">&para;</a></h4>
<p><strong>职责</strong>: 融合 Vision + IMU + EMG 三模态数据，交叉验证并检测异常</p>
<p><strong>MVP 选择</strong>: Simple Merge</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>值</th>
</tr>
</thead>
<tbody>
<tr>
<td>方法</td>
<td>简单合并各传感器特征</td>
</tr>
<tr>
<td>复杂度</td>
<td>低</td>
</tr>
<tr>
<td>用途</td>
<td>快速验证管道</td>
</tr>
</tbody>
</table>
<p><strong>融合三原则</strong>:</p>
<ol>
<li><strong>互补性</strong> — Vision (空间姿态) + IMU (精确时序) + EMG (肌肉状态)</li>
<li><strong>交叉验证</strong> — Vision "Top" + IMU zero-crossing → 确认; 不一致 → 降低置信度</li>
<li><strong>异常检测</strong> — 传感器间矛盾 → 标记异常 (穿戴问题/传感器故障)</li>
</ol>
<h5 id="_6">核心诊断算法<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h5>
<p>FUSION Block 的核心价值在于<strong>诊断算法</strong> — 这些算法只有三模态融合才能实现。</p>
<blockquote>
<p><strong>实现代码</strong>: 见 <a href="./metrics-calculation.md#45-融合诊断算法-fusion-diagnostic-algorithms">数据处理与指标计算 §4.5 融合诊断算法</a></p>
</blockquote>
<table>
<thead>
<tr>
<th>算法</th>
<th>函数名</th>
<th>检测内容</th>
<th>所需传感器</th>
</tr>
</thead>
<tbody>
<tr>
<td>运动链序列验证</td>
<td><code>validate_kinematic_sequence()</code></td>
<td>Core 是否先于 Forearm 激活</td>
<td>EMG</td>
</tr>
<tr>
<td>假蓄力检测</td>
<td><code>detect_false_coil()</code></td>
<td>X-Factor 高但核心肌群未激活</td>
<td>Vision + EMG</td>
</tr>
<tr>
<td>力量链验证</td>
<td><code>verify_force_chain()</code></td>
<td>三模态数据一致性验证</td>
<td>Vision + IMU + EMG</td>
</tr>
<tr>
<td>诊断入口</td>
<td><code>run_fusion_diagnostics()</code></td>
<td>整合所有诊断，返回主要反馈</td>
<td>All</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">🔧 调试工具: 诊断规则验证</p>
<p><strong>问题</strong>: 规则是否在正确的条件下触发?</p>
<p><strong>Rerun 调试流程</strong>:</p>
<ol>
<li>录制一个 "ARMS<em>BEFORE</em>CORE" 问题挥杆</li>
<li>在 Rerun 中标记:<ul>
<li>EMG Core onset: 640ms</li>
<li>EMG Forearm onset: 580ms</li>
<li>规则触发时刻: 720ms</li>
</ul>
</li>
<li>验证: <code>timing_gap = 580 - 640 = -60ms &lt; 0</code> → 规则应该触发 ✓</li>
<li>如果规则没触发 → 检查阈值设置</li>
</ol>
<p>保存 <code>.rrd</code> 文件作为回归测试用例</p>
</div>
<p><strong>诊断严重度分级</strong>:</p>
<table>
<thead>
<tr>
<th>级别</th>
<th>含义</th>
<th>示例</th>
</tr>
</thead>
<tbody>
<tr>
<td>P0_CRITICAL</td>
<td>必须修正，影响挥杆效果</td>
<td><code>ARMS_BEFORE_CORE</code>, <code>FALSE_COIL</code></td>
</tr>
<tr>
<td>P1_IMPORTANT</td>
<td>建议修正，影响一致性</td>
<td><code>LOW_X_FACTOR</code>, <code>WEAK_CORE_LEAD</code></td>
</tr>
<tr>
<td>P2_MINOR</td>
<td>可选优化</td>
<td><code>PHASE_MISMATCH</code></td>
</tr>
<tr>
<td>INFO</td>
<td>仅供参考</td>
<td>正确序列确认</td>
</tr>
</tbody>
</table>
<h5 id="_7">诊断规则速查表<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h5>
<table>
<thead>
<tr>
<th>规则 ID</th>
<th>严重度</th>
<th>触发条件</th>
<th>需要的传感器</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ARMS_BEFORE_CORE</code></td>
<td>P0</td>
<td>Forearm 先于 Core 激活</td>
<td>EMG</td>
</tr>
<tr>
<td><code>FALSE_COIL</code></td>
<td>P0</td>
<td>X-Factor ≥35° 但 Core &lt;50%</td>
<td>Vision + EMG</td>
</tr>
<tr>
<td><code>COMPENSATION_DETECTED</code></td>
<td>P0</td>
<td>峰值速度高但 Core 激活低</td>
<td>IMU + EMG</td>
</tr>
<tr>
<td><code>LOW_X_FACTOR</code></td>
<td>P1</td>
<td>X-Factor &lt;35°</td>
<td>Vision</td>
</tr>
<tr>
<td><code>WEAK_CORE_LEAD</code></td>
<td>P1</td>
<td>Core 领先 Forearm &lt;20ms</td>
<td>EMG</td>
</tr>
<tr>
<td><code>PHASE_MISMATCH</code></td>
<td>P2</td>
<td>Vision 和 IMU 阶段不一致</td>
<td>Vision + IMU</td>
</tr>
</tbody>
</table>
<div class="admonition success">
<p class="admonition-title">三模态独有能力</p>
<p>以上规则中，<strong>P0 级别的三个规则都需要 EMG 数据</strong>。
这意味着:</p>
<ul>
<li>Vision-only 竞品只能检测 <code>LOW_X_FACTOR</code> (P1)</li>
<li>Vision+IMU 竞品可以检测 <code>PHASE_MISMATCH</code> (P2)</li>
<li><strong>只有 Vision+IMU+EMG 能检测全部 P0 问题</strong></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">备选融合方法</p>
<table>
<thead>
<tr>
<th>方案</th>
<th>复杂度</th>
<th>何时考虑</th>
</tr>
</thead>
<tbody>
<tr>
<td>Rule-based</td>
<td>中</td>
<td>明确传感器优先级后</td>
</tr>
<tr>
<td>Weighted Average</td>
<td>中</td>
<td>已知各传感器可靠性</td>
</tr>
<tr>
<td>Kalman Filter</td>
<td>高</td>
<td>需要实时平滑</td>
</tr>
<tr>
<td>ML Fusion</td>
<td>高</td>
<td>有足够融合训练数据</td>
</tr>
</tbody>
</table>
</div>
<h4 id="243-置信度计算逻辑">2.4.3 置信度计算逻辑<a class="headerlink" href="#243-置信度计算逻辑" title="Permanent link">&para;</a></h4>
<p>融合提升置信度的核心算法:</p>
<table>
<thead>
<tr>
<th>验证条件</th>
<th>置信度变化</th>
<th>结果示例</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>基准</strong></td>
<td>0.5</td>
<td>单传感器</td>
</tr>
<tr>
<td>Vision-IMU 阶段一致</td>
<td>+0.25</td>
<td>双重验证</td>
</tr>
<tr>
<td>Vision-IMU 阶段不一致</td>
<td>-0.15</td>
<td>需人工检查</td>
</tr>
<tr>
<td>EMG 序列正确</td>
<td>+0.25</td>
<td>三重验证</td>
</tr>
<tr>
<td>EMG 无数据</td>
<td>+0.0</td>
<td>保持</td>
</tr>
<tr>
<td>EMG 序列异常</td>
<td>-0.10</td>
<td>标记问题</td>
</tr>
</tbody>
</table>
<p><strong>置信度示例</strong>:</p>
<ul>
<li>Vision=Top, IMU=Top, EMG=Correct → <strong>1.0</strong> (最高)</li>
<li>Vision=Top, IMU=Top, EMG=None → <strong>0.75</strong></li>
<li>Vision=Top, IMU=Mid, EMG=None → <strong>0.35</strong> (需检查)</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">算法实现</p>
<p>完整 Python 代码见 <a href="./metrics-calculation.md#44-融合置信度计算-fusion-confidence">数据处理与指标计算 §4.4</a></p>
</div>
<h3 id="25-ai-反馈生成层">2.5 AI 反馈生成层<a class="headerlink" href="#25-ai-反馈生成层" title="Permanent link">&para;</a></h3>
<p>将传感器数据结构化为 LLM 可理解格式，生成教练级自然语言反馈。</p>
<h4 id="251-prompt-block">2.5.1 PROMPT Block<a class="headerlink" href="#251-prompt-block" title="Permanent link">&para;</a></h4>
<p><strong>职责</strong>: 将诊断结果转换为 Kinematic Prompts (结构化提示词)</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>值</th>
</tr>
</thead>
<tbody>
<tr>
<td>输入</td>
<td>触发的规则 + 12 指标 + 置信度</td>
</tr>
<tr>
<td>输出</td>
<td>结构化 JSON/Text Prompt</td>
</tr>
<tr>
<td>延迟</td>
<td>&lt;1ms (模板填充)</td>
</tr>
</tbody>
</table>
<p><strong>接口契约</strong>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="nd">@dataclass</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">PromptInput</span><span class="p">:</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>    <span class="n">triggered_rules</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">DiagnosticRule</span><span class="p">]</span>  <span class="c1"># 触发的规则列表</span>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>    <span class="n">metrics</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>               <span class="c1"># 12 个结构化指标</span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>    <span class="n">confidence</span><span class="p">:</span> <span class="nb">float</span>                       <span class="c1"># 融合置信度</span>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="nd">@dataclass</span>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="k">class</span><span class="w"> </span><span class="nc">PromptOutput</span><span class="p">:</span>
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a>    <span class="n">kinematic_prompt</span><span class="p">:</span> <span class="nb">str</span>     <span class="c1"># 结构化提示词</span>
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a>    <span class="n">severity</span><span class="p">:</span> <span class="nb">str</span>             <span class="c1"># P0/P1/P2/INFO</span>
</span><span id="__span-27-11"><a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a>    <span class="n">focus_metric</span><span class="p">:</span> <span class="nb">str</span>         <span class="c1"># 主要关注指标</span>
</span></code></pre></div>
<p><strong>Kinematic Prompt 示例</strong>:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>X-Factor: 42° ✅ (正常范围 35-55°)
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>Core activation: 30% ⚠️ (低于 50% 阈值)
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>Timing: 核心先于前臂 150ms ✅
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>Triggered rule: FALSE_COIL (P0)
</span></code></pre></div>
<h4 id="252-llm-block">2.5.2 LLM Block<a class="headerlink" href="#252-llm-block" title="Permanent link">&para;</a></h4>
<p><strong>职责</strong>: 将 Kinematic Prompts 翻译为教练级自然语言反馈</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>值</th>
</tr>
</thead>
<tbody>
<tr>
<td>输入</td>
<td>Kinematic Prompt</td>
</tr>
<tr>
<td>处理</td>
<td>GPT-4o-mini / Gemini 2.5 Flash</td>
</tr>
<tr>
<td>输出</td>
<td>自然语言反馈 (中/英文)</td>
</tr>
<tr>
<td>延迟</td>
<td>200-500ms (Cloud API)</td>
</tr>
</tbody>
</table>
<p><strong>接口契约</strong>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="nd">@dataclass</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">LLMInput</span><span class="p">:</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>    <span class="n">kinematic_prompt</span><span class="p">:</span> <span class="nb">str</span>     <span class="c1"># 结构化提示词</span>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>    <span class="n">language</span><span class="p">:</span> <span class="nb">str</span>             <span class="c1"># &quot;zh&quot; / &quot;en&quot;</span>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>    <span class="n">user_level</span><span class="p">:</span> <span class="nb">str</span>           <span class="c1"># &quot;beginner&quot; / &quot;intermediate&quot; / &quot;advanced&quot;</span>
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a><span class="nd">@dataclass</span>
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a><span class="k">class</span><span class="w"> </span><span class="nc">LLMOutput</span><span class="p">:</span>
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a>    <span class="n">feedback_text</span><span class="p">:</span> <span class="nb">str</span>        <span class="c1"># 自然语言反馈</span>
</span><span id="__span-29-10"><a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a>    <span class="n">action_items</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>   <span class="c1"># 可执行建议列表</span>
</span><span id="__span-29-11"><a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a>    <span class="n">tone</span><span class="p">:</span> <span class="nb">str</span>                 <span class="c1"># &quot;encouraging&quot; / &quot;instructive&quot; / &quot;warning&quot;</span>
</span></code></pre></div>
<p><strong>翻译示例</strong>:</p>
<table>
<thead>
<tr>
<th>输入</th>
<th>输出</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>FALSE_COIL (P0)</code> + <code>X-Factor=42°</code> + <code>Core=30%</code></td>
<td>"看起来转够了 (42°)，但核心没发力 (30%)。在下杆前收紧腹肌，让身体带动手臂。"</td>
</tr>
</tbody>
</table>
<h3 id="26-用户反馈呈现层">2.6 用户反馈呈现层<a class="headerlink" href="#26-用户反馈呈现层" title="Permanent link">&para;</a></h3>
<p>将 LLM 生成的反馈通过多种渠道呈现给用户，挥杆后 &lt;500ms 内完成。</p>
<h4 id="261-output-block">2.6.1 OUTPUT Block<a class="headerlink" href="#261-output-block" title="Permanent link">&para;</a></h4>
<p><strong>职责</strong>: 多渠道反馈呈现 (UI/TTS/触觉/Ghost)</p>
<table>
<thead>
<tr>
<th>渠道</th>
<th>组件</th>
<th>特点</th>
</tr>
</thead>
<tbody>
<tr>
<td>📱 <strong>App UI</strong></td>
<td>SwiftUI</td>
<td>简洁指标 (1-3 个)，颜色编码 🟢🟡🔴</td>
</tr>
<tr>
<td>🔊 <strong>语音 TTS</strong></td>
<td>AVSpeechSynthesizer</td>
<td>教练语音，离线可用</td>
</tr>
<tr>
<td>📳 <strong>触觉反馈</strong></td>
<td>UIFeedbackGenerator</td>
<td>振动提示，方向指引</td>
</tr>
<tr>
<td>👻 <strong>Ghost Overlay</strong></td>
<td>ARKit (Phase 2+)</td>
<td>骨架叠加，动作对比</td>
</tr>
</tbody>
</table>
<p><strong>接口契约</strong>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="c1"># Input</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="nd">@dataclass</span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">OutputInput</span><span class="p">:</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>    <span class="n">feedback_text</span><span class="p">:</span> <span class="nb">str</span>        <span class="c1"># LLM 生成的反馈</span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>    <span class="n">action_items</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>   <span class="c1"># 可执行建议列表</span>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>    <span class="n">severity</span><span class="p">:</span> <span class="nb">str</span>             <span class="c1"># P0/P1/P2/INFO</span>
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a>    <span class="n">metrics_summary</span><span class="p">:</span> <span class="n">Dict</span>     <span class="c1"># 关键指标摘要 (最多 3 个)</span>
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a>
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a><span class="nd">@dataclass</span>
</span><span id="__span-30-10"><a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a><span class="k">class</span><span class="w"> </span><span class="nc">OutputConfig</span><span class="p">:</span>
</span><span id="__span-30-11"><a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a>    <span class="n">enable_tts</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-30-12"><a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a>    <span class="n">enable_haptic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-30-13"><a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a>    <span class="n">enable_ghost</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Phase 2+</span>
</span><span id="__span-30-14"><a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a>    <span class="n">max_metrics_display</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="__span-30-15"><a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a>    <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;zh&quot;</span>      <span class="c1"># &quot;zh&quot; / &quot;en&quot;</span>
</span><span id="__span-30-16"><a id="__codelineno-30-16" name="__codelineno-30-16" href="#__codelineno-30-16"></a>
</span><span id="__span-30-17"><a id="__codelineno-30-17" name="__codelineno-30-17" href="#__codelineno-30-17"></a><span class="c1"># Output: 用户感知的反馈 (终端呈现，无下游 Block)</span>
</span><span id="__span-30-18"><a id="__codelineno-30-18" name="__codelineno-30-18" href="#__codelineno-30-18"></a><span class="nd">@dataclass</span>
</span><span id="__span-30-19"><a id="__codelineno-30-19" name="__codelineno-30-19" href="#__codelineno-30-19"></a><span class="k">class</span><span class="w"> </span><span class="nc">OutputResult</span><span class="p">:</span>
</span><span id="__span-30-20"><a id="__codelineno-30-20" name="__codelineno-30-20" href="#__codelineno-30-20"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;反馈呈现结果，用于日志和分析&quot;&quot;&quot;</span>
</span><span id="__span-30-21"><a id="__codelineno-30-21" name="__codelineno-30-21" href="#__codelineno-30-21"></a>    <span class="n">tts_played</span><span class="p">:</span> <span class="nb">bool</span>          <span class="c1"># TTS 是否播放成功</span>
</span><span id="__span-30-22"><a id="__codelineno-30-22" name="__codelineno-30-22" href="#__codelineno-30-22"></a>    <span class="n">tts_duration_ms</span><span class="p">:</span> <span class="nb">int</span>      <span class="c1"># TTS 播放时长</span>
</span><span id="__span-30-23"><a id="__codelineno-30-23" name="__codelineno-30-23" href="#__codelineno-30-23"></a>    <span class="n">haptic_triggered</span><span class="p">:</span> <span class="nb">bool</span>    <span class="c1"># 触觉反馈是否触发</span>
</span><span id="__span-30-24"><a id="__codelineno-30-24" name="__codelineno-30-24" href="#__codelineno-30-24"></a>    <span class="n">ui_rendered</span><span class="p">:</span> <span class="nb">bool</span>         <span class="c1"># UI 是否渲染成功</span>
</span><span id="__span-30-25"><a id="__codelineno-30-25" name="__codelineno-30-25" href="#__codelineno-30-25"></a>    <span class="n">total_latency_ms</span><span class="p">:</span> <span class="nb">int</span>     <span class="c1"># 从挥杆结束到反馈呈现的总延迟</span>
</span><span id="__span-30-26"><a id="__codelineno-30-26" name="__codelineno-30-26" href="#__codelineno-30-26"></a>    <span class="n">user_dismissed</span><span class="p">:</span> <span class="nb">bool</span>      <span class="c1"># 用户是否主动关闭反馈</span>
</span></code></pre></div>
<p><strong>反馈示例映射</strong>:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>┌─────────────────────────────────────────────────────────────────────────────┐
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>│                         反馈呈现示例                                          │
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a>├─────────────────────────────────────────────────────────────────────────────┤
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a>│                                                                             │
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a>│   示例 1: 运动链倒序                                                        │
</span><span id="__span-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a>│   ─────────────────────────────────────────────────────                     │
</span><span id="__span-31-7"><a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a>│   数据: emg_core_forearm_gap = -40ms                                        │
</span><span id="__span-31-8"><a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a>│   规则: ARMS_BEFORE_CORE (P0 严重)                                          │
</span><span id="__span-31-9"><a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a>│   CN: &quot;让身体带动，别用手打&quot;                                                │
</span><span id="__span-31-10"><a id="__codelineno-31-10" name="__codelineno-31-10" href="#__codelineno-31-10"></a>│   EN: &quot;Let your body lead, don&#39;t swing with your arms&quot;                     │
</span><span id="__span-31-11"><a id="__codelineno-31-11" name="__codelineno-31-11" href="#__codelineno-31-11"></a>│                                                                             │
</span><span id="__span-31-12"><a id="__codelineno-31-12" name="__codelineno-31-12" href="#__codelineno-31-12"></a>│   示例 2: X-Factor 不足                                                     │
</span><span id="__span-31-13"><a id="__codelineno-31-13" name="__codelineno-31-13" href="#__codelineno-31-13"></a>│   ─────────────────────────────────────────────────────                     │
</span><span id="__span-31-14"><a id="__codelineno-31-14" name="__codelineno-31-14" href="#__codelineno-31-14"></a>│   数据: x_factor = 22° (低于 35° 阈值)                                      │
</span><span id="__span-31-15"><a id="__codelineno-31-15" name="__codelineno-31-15" href="#__codelineno-31-15"></a>│   规则: LOW_X_FACTOR (P1 重要)                                              │
</span><span id="__span-31-16"><a id="__codelineno-31-16" name="__codelineno-31-16" href="#__codelineno-31-16"></a>│   CN: &quot;肩膀多转一点，你的背还没拧紧&quot;                                        │
</span><span id="__span-31-17"><a id="__codelineno-31-17" name="__codelineno-31-17" href="#__codelineno-31-17"></a>│   EN: &quot;Turn your shoulders more - you haven&#39;t coiled your back yet&quot;        │
</span><span id="__span-31-18"><a id="__codelineno-31-18" name="__codelineno-31-18" href="#__codelineno-31-18"></a>│                                                                             │
</span><span id="__span-31-19"><a id="__codelineno-31-19" name="__codelineno-31-19" href="#__codelineno-31-19"></a>│   示例 3: 假性蓄力 (只有三模态能检测!)                                       │
</span><span id="__span-31-20"><a id="__codelineno-31-20" name="__codelineno-31-20" href="#__codelineno-31-20"></a>│   ─────────────────────────────────────────────────────                     │
</span><span id="__span-31-21"><a id="__codelineno-31-21" name="__codelineno-31-21" href="#__codelineno-31-21"></a>│   数据: x_factor = 45° (正常) + emg_core_activation = 0.3 (低于 0.5)        │
</span><span id="__span-31-22"><a id="__codelineno-31-22" name="__codelineno-31-22" href="#__codelineno-31-22"></a>│   规则: FALSE_COIL (P0 严重)                                                │
</span><span id="__span-31-23"><a id="__codelineno-31-23" name="__codelineno-31-23" href="#__codelineno-31-23"></a>│   CN: &quot;看起来转够了，但核心没发力。专注于收紧腹肌再下杆。&quot;                   │
</span><span id="__span-31-24"><a id="__codelineno-31-24" name="__codelineno-31-24" href="#__codelineno-31-24"></a>│   EN: &quot;Your turn looks good but your core isn&#39;t engaged. Focus on          │
</span><span id="__span-31-25"><a id="__codelineno-31-25" name="__codelineno-31-25" href="#__codelineno-31-25"></a>│        tightening your abs before starting the downswing.&quot;                 │
</span><span id="__span-31-26"><a id="__codelineno-31-26" name="__codelineno-31-26" href="#__codelineno-31-26"></a>│                                                                             │
</span><span id="__span-31-27"><a id="__codelineno-31-27" name="__codelineno-31-27" href="#__codelineno-31-27"></a>│   示例 4: 疲劳预警                                                          │
</span><span id="__span-31-28"><a id="__codelineno-31-28" name="__codelineno-31-28" href="#__codelineno-31-28"></a>│   ─────────────────────────────────────────────────────                     │
</span><span id="__span-31-29"><a id="__codelineno-31-29" name="__codelineno-31-29" href="#__codelineno-31-29"></a>│   数据: emg_fatigue_ratio = 0.65 (低于 0.7 阈值)                            │
</span><span id="__span-31-30"><a id="__codelineno-31-30" name="__codelineno-31-30" href="#__codelineno-31-30"></a>│   规则: FATIGUE_WARNING (P1 重要)                                           │
</span><span id="__span-31-31"><a id="__codelineno-31-31" name="__codelineno-31-31" href="#__codelineno-31-31"></a>│   CN: &quot;你累了，休息一下再练，避免受伤&quot;                                      │
</span><span id="__span-31-32"><a id="__codelineno-31-32" name="__codelineno-31-32" href="#__codelineno-31-32"></a>│   EN: &quot;You&#39;re fatigued. Take a break to prevent injury.&quot;                   │
</span><span id="__span-31-33"><a id="__codelineno-31-33" name="__codelineno-31-33" href="#__codelineno-31-33"></a>│                                                                             │
</span><span id="__span-31-34"><a id="__codelineno-31-34" name="__codelineno-31-34" href="#__codelineno-31-34"></a>└─────────────────────────────────────────────────────────────────────────────┘
</span></code></pre></div>
<p><strong>用户体验保证</strong>:</p>
<table>
<thead>
<tr>
<th>指标</th>
<th>要求</th>
</tr>
</thead>
<tbody>
<tr>
<td>挥杆结束 → 反馈呈现</td>
<td>&lt;500ms (用户无感知延迟)</td>
</tr>
<tr>
<td>语音反馈</td>
<td>1-2 句话，可执行 ("收紧腹肌" vs 抽象建议)</td>
</tr>
<tr>
<td>视觉反馈</td>
<td>最多 3 个指标，避免信息过载</td>
</tr>
<tr>
<td>趋势追踪</td>
<td>连续多次挥杆的改进/退步趋势</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">🔧 调试工具: 验证反馈时机</p>
<p><strong>问题</strong>: 反馈是否在正确的时刻触发?</p>
<p><strong>Rerun 调试流程</strong>:</p>
<ol>
<li>录制一次挥杆到 <code>.rrd</code> 文件</li>
<li>在时间轴上标记:<ul>
<li>规则触发时刻 (如 <code>ARMS_BEFORE_CORE</code> 在 T=720ms 触发)</li>
<li>对应的 EMG 激活时刻 (Core=640ms, Forearm=580ms)</li>
</ul>
</li>
<li>验证规则逻辑是否正确</li>
<li>反复回放同一录制，调优阈值直到反馈时机合理</li>
</ol>
</div>
<hr />
<h2 id="3-积木替换示例">3. 积木替换示例<a class="headerlink" href="#3-积木替换示例" title="Permanent link">&para;</a></h2>
<blockquote>
<p><strong>核心理念</strong>: 模块化架构的价值在于 — 升级某个模块时，其他模块完全不受影响。</p>
<p>就像换乐高积木一样：只要接口形状相同，内部用什么颜色/材质都可以。</p>
</blockquote>
<h3 id="31">3.1 替换场景示例<a class="headerlink" href="#31" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>替换场景</th>
<th>MVP (现在)</th>
<th>升级版 (未来)</th>
<th>要改的</th>
<th>不用改的</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>分类器升级</strong></td>
<td>SwingNet (规则)</td>
<td>BiGRU (深度学习)</td>
<td>1个模型文件</td>
<td>所有其他代码</td>
</tr>
<tr>
<td><strong>IMU 真实化</strong></td>
<td>JSON 模拟数据</td>
<td>真实硬件传感器</td>
<td>数据源</td>
<td>特征提取逻辑</td>
</tr>
<tr>
<td><strong>融合算法</strong></td>
<td>简单合并</td>
<td>Kalman Filter</td>
<td>融合模块</td>
<td>上下游模块</td>
</tr>
</tbody>
</table>
<div class="language-text highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>┌─────────────────────────────────────────────────────────────────────────────┐
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>│                         积木替换原理 BLOCK REPLACEMENT                        │
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>├─────────────────────────────────────────────────────────────────────────────┤
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a>│                                                                             │
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a>│   替换前:                              替换后:                               │
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>│   ─────────                            ─────────                            │
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a>│                                                                             │
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a>│   ┌─────────┐   ┌─────────┐           ┌─────────┐   ┌─────────┐            │
</span><span id="__span-32-9"><a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a>│   │ Block A │ → │ Block B │           │ Block A │ → │ Block B&#39;│            │
</span><span id="__span-32-10"><a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a>│   └─────────┘   └─────────┘           └─────────┘   └─────────┘            │
</span><span id="__span-32-11"><a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a>│        │             │                     │             │                  │
</span><span id="__span-32-12"><a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a>│        │    旧实现    │                     │    新实现    │                  │
</span><span id="__span-32-13"><a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a>│        │             │                     │             │                  │
</span><span id="__span-32-14"><a id="__codelineno-32-14" name="__codelineno-32-14" href="#__codelineno-32-14"></a>│        └──────┬──────┘                     └──────┬──────┘                  │
</span><span id="__span-32-15"><a id="__codelineno-32-15" name="__codelineno-32-15" href="#__codelineno-32-15"></a>│               │                                   │                         │
</span><span id="__span-32-16"><a id="__codelineno-32-16" name="__codelineno-32-16" href="#__codelineno-32-16"></a>│               ▼                                   ▼                         │
</span><span id="__span-32-17"><a id="__codelineno-32-17" name="__codelineno-32-17" href="#__codelineno-32-17"></a>│   ┌─────────────────────┐             ┌─────────────────────┐              │
</span><span id="__span-32-18"><a id="__codelineno-32-18" name="__codelineno-32-18" href="#__codelineno-32-18"></a>│   │      Block C        │      =      │      Block C        │              │
</span><span id="__span-32-19"><a id="__codelineno-32-19" name="__codelineno-32-19" href="#__codelineno-32-19"></a>│   │     (不变)          │             │     (完全不改)       │              │
</span><span id="__span-32-20"><a id="__codelineno-32-20" name="__codelineno-32-20" href="#__codelineno-32-20"></a>│   └─────────────────────┘             └─────────────────────┘              │
</span><span id="__span-32-21"><a id="__codelineno-32-21" name="__codelineno-32-21" href="#__codelineno-32-21"></a>│                                                                             │
</span><span id="__span-32-22"><a id="__codelineno-32-22" name="__codelineno-32-22" href="#__codelineno-32-22"></a>│   💡 关键: 只要 Block B 和 Block B&#39; 的输出接口相同，Block C 无需任何修改        │
</span><span id="__span-32-23"><a id="__codelineno-32-23" name="__codelineno-32-23" href="#__codelineno-32-23"></a>│                                                                             │
</span><span id="__span-32-24"><a id="__codelineno-32-24" name="__codelineno-32-24" href="#__codelineno-32-24"></a>└─────────────────────────────────────────────────────────────────────────────┘
</span></code></pre></div>
<hr />
<h3 id="32-1-classifier-block">3.2 示例 1: 分类器升级 (CLASSIFIER Block)<a class="headerlink" href="#32-1-classifier-block" title="Permanent link">&para;</a></h3>
<p><strong>场景</strong>: 从简单规则升级到深度学习模型</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>MVP 阶段:
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>┌──────────┐    ┌───────────────┐    ┌──────────┐
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>│ MediaPipe│ →  │   SwingNet    │ →  │ 8 Phases │
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>│ 33点骨架  │    │   (规则匹配)   │    │  输出    │
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>└──────────┘    └───────────────┘    └──────────┘
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a>
</span><span id="__span-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a>升级后:
</span><span id="__span-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a>┌──────────┐    ┌───────────────┐    ┌──────────┐
</span><span id="__span-33-9"><a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a>│ MediaPipe│ →  │    BiGRU      │ →  │ 8 Phases │
</span><span id="__span-33-10"><a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a>│ 33点骨架  │    │   (深度学习)   │    │  输出    │
</span><span id="__span-33-11"><a id="__codelineno-33-11" name="__codelineno-33-11" href="#__codelineno-33-11"></a>└──────────┘    └───────────────┘    └──────────┘
</span><span id="__span-33-12"><a id="__codelineno-33-12" name="__codelineno-33-12" href="#__codelineno-33-12"></a>                      ↑
</span><span id="__span-33-13"><a id="__codelineno-33-13" name="__codelineno-33-13" href="#__codelineno-33-13"></a>                   只换这个
</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: center;">步骤</th>
<th>操作</th>
<th style="text-align: center;">工作量</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">1</td>
<td>收集 ~1000 个标注视频</td>
<td style="text-align: center;">数据准备</td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td>训练 BiGRU 模型</td>
<td style="text-align: center;">~4小时</td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td>导出 ONNX 格式</td>
<td style="text-align: center;">1行命令</td>
</tr>
<tr>
<td style="text-align: center;">4</td>
<td>替换 <code>classifier.onnx</code> 文件</td>
<td style="text-align: center;">换文件</td>
</tr>
<tr>
<td style="text-align: center;">✅</td>
<td><strong>其他代码零修改</strong></td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="33-2-imu-sensor_hub-block">3.3 示例 2: IMU 真实化 (SENSOR_HUB Block)<a class="headerlink" href="#33-2-imu-sensor_hub-block" title="Permanent link">&para;</a></h3>
<p><strong>场景</strong>: 从模拟数据切换到真实硬件</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>MVP 阶段 (模拟):
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>┌──────────────┐    ┌───────────────┐    ┌──────────┐
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>│  mock.json   │ →  │  IMU Block    │ →  │ 4 指标   │
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a>│  (模拟数据)   │    │  (特征提取)    │    │  输出    │
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a>└──────────────┘    └───────────────┘    └──────────┘
</span><span id="__span-34-6"><a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a>
</span><span id="__span-34-7"><a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a>升级后 (真实):
</span><span id="__span-34-8"><a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a>┌──────────────┐    ┌───────────────┐    ┌──────────┐
</span><span id="__span-34-9"><a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a>│  LSM6DSV16X  │ →  │  IMU Block    │ →  │ 4 指标   │
</span><span id="__span-34-10"><a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a>│  (BLE 传输)   │    │  (特征提取)    │    │  输出    │
</span><span id="__span-34-11"><a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a>└──────────────┘    └───────────────┘    └──────────┘
</span><span id="__span-34-12"><a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a>       ↑                   ↑
</span><span id="__span-34-13"><a id="__codelineno-34-13" name="__codelineno-34-13" href="#__codelineno-34-13"></a>    换数据源           逻辑不变
</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: center;">步骤</th>
<th>操作</th>
<th style="text-align: center;">工作量</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">1</td>
<td>完成硬件原型 (ESP32-S3 + IMU)</td>
<td style="text-align: center;">硬件</td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td>实现 BLE 数据传输</td>
<td style="text-align: center;">通信</td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td>替换数据源 (JSON → BLE Stream)</td>
<td style="text-align: center;">适配器</td>
</tr>
<tr>
<td style="text-align: center;">✅</td>
<td><strong>特征提取逻辑零修改</strong></td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="34-3-fusion-block">3.4 示例 3: 融合算法升级 (FUSION Block)<a class="headerlink" href="#34-3-fusion-block" title="Permanent link">&para;</a></h3>
<p><strong>场景</strong>: 从简单合并升级到 Kalman Filter</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>MVP 阶段:
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>┌─────────┐
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a>│ Vision  │ ──┐
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a>├─────────┤   │    ┌───────────────┐    ┌──────────┐
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a>│  IMU    │ ──┼──→ │ Simple Merge  │ →  │ 融合结果  │
</span><span id="__span-35-6"><a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a>├─────────┤   │    │  (简单合并)    │    │         │
</span><span id="__span-35-7"><a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a>│  EMG    │ ──┘    └───────────────┘    └──────────┘
</span><span id="__span-35-8"><a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a>└─────────┘
</span><span id="__span-35-9"><a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a>
</span><span id="__span-35-10"><a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a>升级后:
</span><span id="__span-35-11"><a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a>┌─────────┐
</span><span id="__span-35-12"><a id="__codelineno-35-12" name="__codelineno-35-12" href="#__codelineno-35-12"></a>│ Vision  │ ──┐
</span><span id="__span-35-13"><a id="__codelineno-35-13" name="__codelineno-35-13" href="#__codelineno-35-13"></a>├─────────┤   │    ┌───────────────┐    ┌──────────┐
</span><span id="__span-35-14"><a id="__codelineno-35-14" name="__codelineno-35-14" href="#__codelineno-35-14"></a>│  IMU    │ ──┼──→ │ Kalman Filter │ →  │ 融合结果  │
</span><span id="__span-35-15"><a id="__codelineno-35-15" name="__codelineno-35-15" href="#__codelineno-35-15"></a>├─────────┤   │    │  (最优估计)    │    │         │
</span><span id="__span-35-16"><a id="__codelineno-35-16" name="__codelineno-35-16" href="#__codelineno-35-16"></a>│  EMG    │ ──┘    └───────────────┘    └──────────┘
</span><span id="__span-35-17"><a id="__codelineno-35-17" name="__codelineno-35-17" href="#__codelineno-35-17"></a>└─────────┘              ↑
</span><span id="__span-35-18"><a id="__codelineno-35-18" name="__codelineno-35-18" href="#__codelineno-35-18"></a>                      只换这个
</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: center;">步骤</th>
<th>操作</th>
<th style="text-align: center;">工作量</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">1</td>
<td>确认传感器数据质量</td>
<td style="text-align: center;">分析</td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td>标定传感器噪声模型</td>
<td style="text-align: center;">测量</td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td>实现 Kalman Filter</td>
<td style="text-align: center;">算法</td>
</tr>
<tr>
<td style="text-align: center;">4</td>
<td>调整融合权重</td>
<td style="text-align: center;">调参</td>
</tr>
<tr>
<td style="text-align: center;">✅</td>
<td><strong>上下游模块零修改</strong></td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="35">3.5 为什么能做到"零修改"？<a class="headerlink" href="#35" title="Permanent link">&para;</a></h3>
<div class="admonition success">
<p class="admonition-title">接口契约是关键</p>
<p>只要保证<strong>输入输出接口不变</strong>，内部实现可以任意替换：</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="c1"># CLASSIFIER Block 接口契约 (不变)</span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">ClassifierInput</span><span class="p">:</span>
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a>    <span class="n">keypoints</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Keypoint</span><span class="p">]</span>   <span class="c1"># 输入: 33个关键点</span>
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a>
</span><span id="__span-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a><span class="k">class</span><span class="w"> </span><span class="nc">ClassifierResult</span><span class="p">:</span>
</span><span id="__span-36-6"><a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a>    <span class="n">phases</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">SwingPhase</span><span class="p">]</span>    <span class="c1"># 输出: 8个阶段</span>
</span><span id="__span-36-7"><a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a>    <span class="n">confidence</span><span class="p">:</span> <span class="nb">float</span>
</span></code></pre></div>
<p>无论内部是规则匹配还是深度学习，只要遵守这个契约，调用方无需感知变化。</p>
</div>
<hr />
<h2 id="4-相关文档">4. 相关文档<a class="headerlink" href="#4-相关文档" title="Permanent link">&para;</a></h2>
<h3 id="_8">核心文档<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>文档</th>
<th>内容</th>
<th>关系</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="../system-design/">系统架构</a></td>
<td>MVP 4 模块架构</td>
<td>本文档的父文档</td>
</tr>
<tr>
<td><a href="./metrics-calculation.md">数据处理与指标计算</a></td>
<td>算法实现代码</td>
<td>§3.1-3.3 的详细实现</td>
</tr>
<tr>
<td><a href="../../specs/eight-swing-phases/">八个挥杆阶段</a></td>
<td>8 阶段检测</td>
<td>CLASSIFIER Block 输出</td>
</tr>
<tr>
<td><a href="../../../prerequisites/foundations/biomechanics-glossary/">生物力学术语表</a></td>
<td>术语定义</td>
<td>高尔夫专业术语</td>
</tr>
</tbody>
</table>
<h3 id="adrs">技术决策 (ADRs)<a class="headerlink" href="#adrs" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>决策</th>
<th>内容</th>
<th>相关 Block</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="../../decisions/0002-lsm6dsv16x-imu/">ADR-0002</a></td>
<td>LSM6DSV16X 选型</td>
<td>IMU Block</td>
</tr>
<tr>
<td><a href="../../decisions/0005-esp32-s3-microcontroller/">ADR-0005</a></td>
<td>ESP32-S3 选型</td>
<td>Sensor Hub</td>
</tr>
<tr>
<td><a href="../../decisions/0007-swift-ios-native/">ADR-0007</a></td>
<td>Swift iOS 开发</td>
<td>Mobile App</td>
</tr>
</tbody>
</table>
<h3 id="_9">实现指南<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>文档</th>
<th>内容</th>
<th>适合</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="../../../prerequisites/ml-basics/">ML 基础</a></td>
<td>ML 概念入门</td>
<td>无 ML 背景读者</td>
</tr>
<tr>
<td><a href="../../specs/three-feedback-channels/">三个反馈通道</a></td>
<td>反馈系统设计</td>
<td>OUTPUT Block 实现</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="5-版本历史">5. 版本历史<a class="headerlink" href="#5-版本历史" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>版本</th>
<th>日期</th>
<th>修改内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>2.13</td>
<td>2025-12-27</td>
<td>Rerun 章节迁移</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• §4 Rerun 调试工具迁移至 data-pipeline.md §5</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• 章节重新编号: §5→§4, §6→§5</td>
</tr>
<tr>
<td>2.12</td>
<td>2025-12-27</td>
<td>文档聚焦重构</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• 删除 §3 MVP 策略 (内容移至 system-design.md)</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• 重写 §3 积木替换示例，增加概览表 + 原理图 + 步骤表</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• 修正 §2.1 数据采集层图: CAMERA 独立于 BLE (Native SDK 零延迟)</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• 章节重新编号: §4→§3, §5→§4, §6→§5, §7→§6</td>
</tr>
<tr>
<td>2.11</td>
<td>2025-12-27</td>
<td>SENSOR_HUB 可复用架构 — 同一固件多实例部署</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• HUB<em>A + HUB</em>B 合并为单一 SENSOR_HUB Block ×N</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• Block 总数: 13 → 12 (消除重复定义)</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• 新增 <code>hub_id</code> 字段区分实例 (0, 1, 2, ...)</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• 接口类: HubAInput/HubBOutput → SensorHubInput/SensorHubOutput</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• 新增典型部署配置表 (MVP N=2, 扩展 N=4+)</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• BLE Block 更新: 支持 N 个外设连接</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• TIME<em>ALIGN Block 更新: hub</em>readings 替代分离的 imu/emg 输入</td>
</tr>
<tr>
<td>2.10</td>
<td>2025-12-27</td>
<td>Hub 命名通用化 — 支持多场景部署</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• ARM<em>HUB → HUB</em>A, CORE<em>HUB → HUB</em>B (位置无关命名)</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• 接口类重命名: ArmHubInput/Output → HubAInput/Output</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• 字段通用化: left<em>arm</em>imu → imu<em>1, right</em>arm<em>imu → imu</em>2</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• 新增 "部署位置: 可配置" 说明</td>
</tr>
<tr>
<td>2.9</td>
<td>2025-12-27</td>
<td>接口契约完善 — 统一 Python dataclass 格式</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• §1.3: 新增 Block 数列 + 接口契约汇总表，统计 13 个 Block 总计</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• §2.1.1-2.1.4: 补全 Stage 2 采集层所有 Block 的 Input 接口</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• §2.3.1: 重写接口契约 (ASCII → Python dataclass)，新增完整类型定义</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• §2.6.1: 补全 OUTPUT Block 的 Output 接口 (OutputResult)</td>
</tr>
<tr>
<td>2.8</td>
<td>2025-12-27</td>
<td>Stage 6-7 拆分为独立层级</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• §2.5: 新增 AI 反馈生成层 (Stage 6) — PROMPT Block + LLM Block</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• §2.6: 新增用户反馈呈现层 (Stage 7) — OUTPUT Block</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• §1.3: 更新映射表，Stage 6/7 独立显示</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• 新增 3 个 Block 接口契约 (PromptInput/LLMInput/OutputInput)</td>
</tr>
<tr>
<td>2.7</td>
<td>2025-12-27</td>
<td>章节重构 — 对齐 7 阶段架构</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• §2.4: 新增分析诊断层 (Stage 5)，合并原 §3 分析层 + §2.4 置信度计算逻辑</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• §2.5: 用户反馈翻译层重新编号为 (Stage 6-7)</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• §3-§7: 全部章节重新编号 (原 §4-§8)</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• §1.3: 更新 Stage 4/5/6-7 的锚点链接</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• §5.2: 更新诊断规则调试链接指向 §2.4.2</td>
</tr>
<tr>
<td>2.6</td>
<td>2025-12-23</td>
<td>硬件与架构更新 (基于 architecture-decisions-2025-12-23.md)</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• §1.3: 新增原则 #6 "六边形架构" — Ports &amp; Adapters 模式</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• §2.4.1: 新增 BLE 传输抖动警告 (±15-30ms)</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• §2.4.2: 新增 Sensor Hub 架构 — 同一部位传感器共享 ESP32 时钟</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• §3.2: 更新 IMU 硬件推荐 — Adafruit LSM6DSV16X (ADA-5783) + WitMotion 警告</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• §3.3: 更新 EMG 硬件推荐 — MyoWare 2.0 + Link Shield 必需品 + DFRobot 警告</td>
</tr>
<tr>
<td></td>
<td></td>
<td>• §5.5: Phase 3 描述更新 — 架构变更为 Sensor Hub 模式</td>
</tr>
</tbody>
</table>
<hr />
<p><strong>最后更新</strong>: 2025-12-27
<strong>维护者</strong>: Movement Chain AI Team</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/movement-chain-ai" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/movement-chain-ai" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.tabs", "navigation.top", "navigation.tracking", "search.suggest", "search.highlight", "content.code.copy", "content.tabs.link"], "search": "../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": {"alias": true, "default": "latest", "provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>