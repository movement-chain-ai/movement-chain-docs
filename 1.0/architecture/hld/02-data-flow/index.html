
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Architecture documentation for multimodal AI movement training system">
      
      
        <meta name="author" content="Movement Chain AI Team">
      
      
        <link rel="canonical" href="https://movement-chain-ai.github.io/system-documentation/1.0/architecture/hld/02-data-flow/">
      
      
        <link rel="prev" href="../01-system-overview/">
      
      
        <link rel="next" href="../03-integration-patterns/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Data Flow - Movement Chain AI Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="cyan">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#data-flow-architecture" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Movement Chain AI Documentation" class="md-header__button md-logo" aria-label="Movement Chain AI Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Movement Chain AI Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Data Flow
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="cyan"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="cyan"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/movement-chain-ai/system-documentation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    movement-chain-ai/system-documentation
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../01-system-overview/" class="md-tabs__link">
          
  
  
    
  
  Architecture

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../decisions/" class="md-tabs__link">
          
  
  
    
  
  Decisions

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../resources/hardware-comparison/" class="md-tabs__link">
          
  
  
    
  
  Resources

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Movement Chain AI Documentation" class="md-nav__button md-logo" aria-label="Movement Chain AI Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Movement Chain AI Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/movement-chain-ai/system-documentation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    movement-chain-ai/system-documentation
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Architecture
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    High-Level Design
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    High-Level Design
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-system-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    System Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Data Flow
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Flow
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-multimodal-sensor-data-flow" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Multimodal Sensor Data Flow
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Multimodal Sensor Data Flow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-data-sources-and-characteristics" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.1 Data Sources and Characteristics
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-end-to-end-data-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.2 End-to-End Data Pipeline
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-data-flow-stages" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.3 Data Flow Stages
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-synchronization-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Synchronization Strategy
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Synchronization Strategy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-camera-timestamp-as-reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1 Camera Timestamp as Reference
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-timestamp-conversion-protocol" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2 Timestamp Conversion Protocol
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-clock-drift-mitigation" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3 Clock Drift Mitigation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-handling-packet-loss" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.4 Handling Packet Loss
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-data-format-specifications" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Data Format Specifications
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Data Format Specifications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-ble-protocol-buffer-schema" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1 BLE Protocol Buffer Schema
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-pose-estimation-output" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2 Pose Estimation Output
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-fused-feature-vector" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.3 Fused Feature Vector
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-local-storage-format-sqlite" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.4 Local Storage Format (SQLite)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-real-time-vs-batch-processing-paths" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Real-Time vs Batch Processing Paths
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Real-Time vs Batch Processing Paths">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-real-time-path-live-feedback" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.1 Real-Time Path (Live Feedback)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-batch-processing-path-post-workout-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2 Batch Processing Path (Post-Workout Analysis)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-hybrid-mode-selective-recording" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.3 Hybrid Mode (Selective Recording)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-data-quality-and-validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Data Quality and Validation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Data Quality and Validation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-input-validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.1 Input Validation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-synchronization-validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2 Synchronization Validation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-failure-modes-and-degradation" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Failure Modes and Degradation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-performance-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Performance Monitoring
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7. Performance Monitoring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71-telemetry-collection" class="md-nav__link">
    <span class="md-ellipsis">
      
        7.1 Telemetry Collection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72-bottleneck-identification" class="md-nav__link">
    <span class="md-ellipsis">
      
        7.2 Bottleneck Identification
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-future-optimizations" class="md-nav__link">
    <span class="md-ellipsis">
      
        8. Future Optimizations
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-integration-patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Integration Patterns
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-performance-targets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Performance Targets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../decisions/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Decisions
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Decisions
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../decisions/0001-multi-repo-structure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-0001 Multi-Repo Structure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../decisions/0002-lsm6dsv16x-imu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-0002 LSM6DSV16X IMU
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../decisions/0003-flutter-mobile/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-0003 Flutter Mobile
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../decisions/0004-simplified-4-module-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-0004 4-Module Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../decisions/0005-esp32-s3-microcontroller/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-0005 ESP32-S3 MCU
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../decisions/0006-onnx-runtime-deployment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-0006 ONNX Runtime
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Resources
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Resources
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../resources/hardware-comparison/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hardware Comparison
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../resources/ml-frameworks-comparison/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ML Frameworks Comparison
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../resources/mobile-frameworks-comparison/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mobile Frameworks Comparison
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="data-flow-architecture">Data Flow Architecture<a class="headerlink" href="#data-flow-architecture" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>Movement Chain AI processes multimodal sensor data from three sources: camera (60 FPS), IMU (100 Hz), and EMG (200 Hz). This document details the data flow architecture, synchronization strategies, format specifications, and processing paths required to achieve real-time movement analysis with latency under 100ms.</p>
<hr />
<h2 id="1-multimodal-sensor-data-flow">1. Multimodal Sensor Data Flow<a class="headerlink" href="#1-multimodal-sensor-data-flow" title="Permanent link">&para;</a></h2>
<h3 id="11-data-sources-and-characteristics">1.1 Data Sources and Characteristics<a class="headerlink" href="#11-data-sources-and-characteristics" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Sensor</th>
<th>Sampling Rate</th>
<th>Data Size</th>
<th>Latency Budget</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>Camera</td>
<td>60 FPS</td>
<td>640×480 RGB (~900KB/frame)</td>
<td>30ms</td>
<td>Pose estimation, visual context</td>
</tr>
<tr>
<td>IMU (6-axis)</td>
<td>100 Hz</td>
<td>24 bytes/sample</td>
<td>10ms</td>
<td>Acceleration, angular velocity</td>
</tr>
<tr>
<td>EMG (4-channel)</td>
<td>200 Hz</td>
<td>8 bytes/sample</td>
<td>10ms</td>
<td>Muscle activation patterns</td>
</tr>
</tbody>
</table>
<h3 id="12-end-to-end-data-pipeline">1.2 End-to-End Data Pipeline<a class="headerlink" href="#12-end-to-end-data-pipeline" title="Permanent link">&para;</a></h3>
<pre class="mermaid"><code>sequenceDiagram
    participant Cam as Camera
    participant IMU as IMU Sensor
    participant EMG as EMG Sensor
    participant BLE as BLE Module
    participant Sync as Synchronizer
    participant Pose as Pose Estimator
    participant Fusion as Sensor Fusion
    participant ML as ML Classifier
    participant UI as UI/Feedback

    par Parallel Acquisition
        Cam-&gt;&gt;Sync: Frame @ 60 FPS (t_cam)
        IMU-&gt;&gt;BLE: Accel/Gyro @ 100 Hz
        EMG-&gt;&gt;BLE: Muscle data @ 200 Hz
    end

    BLE-&gt;&gt;Sync: Sensor packet (t_cam ref)
    Sync-&gt;&gt;Sync: Buffer &amp; align to t_cam

    Cam-&gt;&gt;Pose: RGB Frame (640×480)
    Pose-&gt;&gt;Fusion: 17 keypoints + confidence
    Sync-&gt;&gt;Fusion: IMU[t_cam-50ms:t_cam]
    Sync-&gt;&gt;Fusion: EMG[t_cam-50ms:t_cam]

    Fusion-&gt;&gt;Fusion: Time-align &amp; interpolate
    Fusion-&gt;&gt;ML: Fused feature vector
    ML-&gt;&gt;ML: LSTM+Transformer inference
    ML-&gt;&gt;UI: Error classification + confidence
    UI-&gt;&gt;UI: Haptic feedback (if error)</code></pre>
<h3 id="13-data-flow-stages">1.3 Data Flow Stages<a class="headerlink" href="#13-data-flow-stages" title="Permanent link">&para;</a></h3>
<h4 id="stage-1-acquisition-0-30ms">Stage 1: Acquisition (0-30ms)<a class="headerlink" href="#stage-1-acquisition-0-30ms" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Camera</strong>: Flutter <code>camera</code> plugin captures frame at t_cam (reference timestamp)</li>
<li><strong>BLE Streaming</strong>: Firmware transmits IMU/EMG packets via GATT notifications</li>
<li>MTU: 500 bytes (allows ~20 IMU samples or ~60 EMG samples per packet)</li>
<li>Connection interval: 7.5ms (validated for 100 Hz throughput)</li>
<li>Packets include firmware timestamp offset from BLE connection start</li>
</ul>
<h4 id="stage-2-synchronization-30-40ms">Stage 2: Synchronization (30-40ms)<a class="headerlink" href="#stage-2-synchronization-30-40ms" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Timestamp Alignment</strong>: All sensor data indexed to camera timestamps</li>
<li>IMU/EMG firmware timestamps converted to camera timebase using initial offset calibration</li>
<li>Circular buffer stores last 500ms of IMU/EMG data (50 IMU samples, 100 EMG samples)</li>
<li><strong>Temporal Windowing</strong>: For each camera frame at t_cam, extract:</li>
<li>IMU samples in window [t_cam - 50ms, t_cam]</li>
<li>EMG samples in window [t_cam - 50ms, t_cam]</li>
</ul>
<h4 id="stage-3-pose-estimation-40-70ms">Stage 3: Pose Estimation (40-70ms)<a class="headerlink" href="#stage-3-pose-estimation-40-70ms" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Model</strong>: RTMPose-m (optimized for mobile)</li>
<li><strong>Input</strong>: 640×480 RGB frame → resized to 256×192</li>
<li><strong>Output</strong>: 17 COCO keypoints with confidence scores</li>
<li><strong>Processing</strong>: GPU-accelerated inference (Core ML/TensorFlow Lite)</li>
</ul>
<h4 id="stage-4-sensor-fusion-70-80ms">Stage 4: Sensor Fusion (70-80ms)<a class="headerlink" href="#stage-4-sensor-fusion-70-80ms" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Interpolation</strong>: Upsample IMU to match EMG rate (200 Hz) using cubic spline</li>
<li><strong>Feature Extraction</strong>:</li>
<li><strong>Pose</strong>: Joint angles (elbow, knee, hip, shoulder) + velocity estimates</li>
<li><strong>IMU</strong>: Orientation quaternion, linear acceleration (gravity-compensated)</li>
<li><strong>EMG</strong>: RMS amplitude per channel, frequency-domain features (50-150 Hz band power)</li>
<li><strong>Normalization</strong>: Z-score normalization per feature dimension</li>
</ul>
<h4 id="stage-5-ml-inference-80-120ms">Stage 5: ML Inference (80-120ms)<a class="headerlink" href="#stage-5-ml-inference-80-120ms" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Model Architecture</strong>: LSTM (2 layers, 128 units) + Transformer encoder (4 heads, 2 layers)</li>
<li><strong>Input</strong>: Sliding window of 30 frames (500ms @ 60 FPS) × fused feature vector</li>
<li><strong>Output</strong>: Error classification logits + confidence scores</li>
<li><strong>Quantization</strong>: INT8 quantization for 2-3x speedup (target: &lt;40ms inference)</li>
</ul>
<h4 id="stage-6-feedback-120-126ms">Stage 6: Feedback (120-126ms)<a class="headerlink" href="#stage-6-feedback-120-126ms" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Haptic Triggering</strong>: If error confidence &gt; 0.7, send haptic pattern via BLE</li>
<li><strong>UI Rendering</strong>: Display skeleton overlay + error annotations at 60 FPS</li>
</ul>
<hr />
<h2 id="2-synchronization-strategy">2. Synchronization Strategy<a class="headerlink" href="#2-synchronization-strategy" title="Permanent link">&para;</a></h2>
<h3 id="21-camera-timestamp-as-reference">2.1 Camera Timestamp as Reference<a class="headerlink" href="#21-camera-timestamp-as-reference" title="Permanent link">&para;</a></h3>
<p><strong>Design Rationale:</strong>
- Camera frames are the lowest-rate signal (60 FPS) → natural synchronization anchor
- Pose estimation requires visual context → camera timestamp defines "analysis instant"
- BLE streaming is asynchronous → must be aligned post-hoc</p>
<h3 id="22-timestamp-conversion-protocol">2.2 Timestamp Conversion Protocol<a class="headerlink" href="#22-timestamp-conversion-protocol" title="Permanent link">&para;</a></h3>
<h4 id="initialization-phase-connection-establishment">Initialization Phase (Connection Establishment)<a class="headerlink" href="#initialization-phase-connection-establishment" title="Permanent link">&para;</a></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>t_app_connect = System.currentTimeMillis()  // App records BLE connection time
</span></code></pre></div>
<p>Firmware sends initial calibration packet:
<div class="language-protobuf highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kd">message</span><span class="w"> </span><span class="nc">TimestampCalibration</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">  </span><span class="kt">uint32</span><span class="w"> </span><span class="na">firmware_millis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">  </span><span class="c1">// millis() at connection</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">  </span><span class="kt">uint64</span><span class="w"> </span><span class="na">connection_timestamp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">  </span><span class="c1">// Echo t_app_connect</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="p">}</span>
</span></code></pre></div></p>
<p>Calculate offset:
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>offset = t_app_connect - firmware_millis
</span></code></pre></div></p>
<h4 id="runtime-alignment">Runtime Alignment<a class="headerlink" href="#runtime-alignment" title="Permanent link">&para;</a></h4>
<p>For each BLE packet with firmware timestamp <code>t_fw</code>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>t_aligned = t_fw + offset  // Convert to app timebase
</span></code></pre></div></p>
<p>For each camera frame at <code>t_cam</code>, retrieve:
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>imu_window = buffer.get(t_cam - 50ms, t_cam)
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>emg_window = buffer.get(t_cam - 50ms, t_cam)
</span></code></pre></div></p>
<h3 id="23-clock-drift-mitigation">2.3 Clock Drift Mitigation<a class="headerlink" href="#23-clock-drift-mitigation" title="Permanent link">&para;</a></h3>
<p><strong>Problem</strong>: Firmware clock (millis()) drifts ~±50 ppm relative to system clock
- Worst case: 180ms drift over 1-hour session</p>
<p><strong>Solution</strong>: Periodic re-calibration
- Every 60 seconds, firmware sends heartbeat with updated <code>firmware_millis</code>
- App recalculates offset using moving average:
  <div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>offset_new = 0.9 * offset_old + 0.1 * (t_app_now - firmware_millis)
</span></code></pre></div></p>
<h3 id="24-handling-packet-loss">2.4 Handling Packet Loss<a class="headerlink" href="#24-handling-packet-loss" title="Permanent link">&para;</a></h3>
<p><strong>BLE Reliability</strong>: 99.5% packet delivery at 7.5ms interval
- Expected loss: ~0.5 packets/second at 100 Hz</p>
<p><strong>Recovery Strategy</strong>:
1. <strong>Sequence Numbers</strong>: Each BLE packet includes monotonic sequence ID
2. <strong>Gap Detection</strong>: If <code>seq_received != seq_expected</code>, mark gap
3. <strong>Interpolation</strong>: Linear interpolation for gaps ≤3 samples (30ms)
4. <strong>Drop Frame</strong>: If gap &gt;3 samples, skip ML inference for that camera frame</p>
<hr />
<h2 id="3-data-format-specifications">3. Data Format Specifications<a class="headerlink" href="#3-data-format-specifications" title="Permanent link">&para;</a></h2>
<h3 id="31-ble-protocol-buffer-schema">3.1 BLE Protocol Buffer Schema<a class="headerlink" href="#31-ble-protocol-buffer-schema" title="Permanent link">&para;</a></h3>
<div class="language-protobuf highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="k">syntax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;proto3&quot;</span><span class="p">;</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="kd">message</span><span class="w"> </span><span class="nc">SensorPacket</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">  </span><span class="kt">uint32</span><span class="w"> </span><span class="na">sequence_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">         </span><span class="c1">// Monotonic counter</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">  </span><span class="kt">uint32</span><span class="w"> </span><span class="na">firmware_timestamp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">   </span><span class="c1">// millis() at packet creation</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">  </span><span class="kd">message</span><span class="w"> </span><span class="nc">IMUSample</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="na">accel_x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">  </span><span class="c1">// m/s² (range: ±16g)</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="na">accel_y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="na">accel_z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="na">gyro_x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w">   </span><span class="c1">// rad/s (range: ±2000°/s)</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="na">gyro_y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="na">gyro_z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="w">  </span><span class="kd">message</span><span class="w"> </span><span class="nc">EMGSample</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a><span class="w">    </span><span class="n">uint16</span><span class="w"> </span><span class="na">channel_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">  </span><span class="c1">// 12-bit ADC value (0-4095)</span>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="w">    </span><span class="n">uint16</span><span class="w"> </span><span class="na">channel_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a><span class="w">    </span><span class="n">uint16</span><span class="w"> </span><span class="na">channel_3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a><span class="w">    </span><span class="n">uint16</span><span class="w"> </span><span class="na">channel_4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a>
</span><span id="__span-6-23"><a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a><span class="w">  </span><span class="k">repeated</span><span class="w"> </span><span class="n">IMUSample</span><span class="w"> </span><span class="na">imu_samples</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w">    </span><span class="c1">// Up to 20 samples/packet</span>
</span><span id="__span-6-24"><a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a><span class="w">  </span><span class="k">repeated</span><span class="w"> </span><span class="n">EMGSample</span><span class="w"> </span><span class="na">emg_samples</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w">    </span><span class="c1">// Up to 60 samples/packet</span>
</span><span id="__span-6-25"><a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>Packet Size Analysis</strong>:
- IMU sample: 6 floats × 4 bytes = 24 bytes
- EMG sample: 4 uint16 × 2 bytes = 8 bytes
- Max packet: 20 IMU (480 bytes) OR 60 EMG (480 bytes) + header (20 bytes) = 500 bytes (fits MTU)</p>
<h3 id="32-pose-estimation-output">3.2 Pose Estimation Output<a class="headerlink" href="#32-pose-estimation-output" title="Permanent link">&para;</a></h3>
<div class="language-dart highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="kd">class</span><span class="w"> </span><span class="nc">PoseEstimationResult</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">frameId</span><span class="p">;</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">DateTime</span><span class="w"> </span><span class="n">timestamp</span><span class="p">;</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Keypoint</span><span class="o">&gt;</span><span class="w"> </span><span class="n">keypoints</span><span class="p">;</span><span class="w">  </span><span class="c1">// 17 COCO keypoints</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">inferenceTimeMs</span><span class="p">;</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="w">  </span><span class="c1">// Keypoint indices (COCO format)</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">NOSE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">LEFT_EYE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">RIGHT_EYE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">;</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">LEFT_EAR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">;</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">RIGHT_EAR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">;</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">LEFT_SHOULDER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">;</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">RIGHT_SHOULDER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="p">;</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">LEFT_ELBOW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">7</span><span class="p">;</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">RIGHT_ELBOW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8</span><span class="p">;</span>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">LEFT_WRIST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">9</span><span class="p">;</span>
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">RIGHT_WRIST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">;</span>
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">LEFT_HIP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">11</span><span class="p">;</span>
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">RIGHT_HIP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">;</span>
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">LEFT_KNEE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">13</span><span class="p">;</span>
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">RIGHT_KNEE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">14</span><span class="p">;</span>
</span><span id="__span-7-23"><a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">LEFT_ANKLE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span><span class="p">;</span>
</span><span id="__span-7-24"><a id="__codelineno-7-24" name="__codelineno-7-24" href="#__codelineno-7-24"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">RIGHT_ANKLE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">;</span>
</span><span id="__span-7-25"><a id="__codelineno-7-25" name="__codelineno-7-25" href="#__codelineno-7-25"></a><span class="p">}</span>
</span><span id="__span-7-26"><a id="__codelineno-7-26" name="__codelineno-7-26" href="#__codelineno-7-26"></a>
</span><span id="__span-7-27"><a id="__codelineno-7-27" name="__codelineno-7-27" href="#__codelineno-7-27"></a><span class="kd">class</span><span class="w"> </span><span class="nc">Keypoint</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-28"><a id="__codelineno-7-28" name="__codelineno-7-28" href="#__codelineno-7-28"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w">           </span><span class="c1">// Normalized [0, 1]</span>
</span><span id="__span-7-29"><a id="__codelineno-7-29" name="__codelineno-7-29" href="#__codelineno-7-29"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">y</span><span class="p">;</span><span class="w">           </span><span class="c1">// Normalized [0, 1]</span>
</span><span id="__span-7-30"><a id="__codelineno-7-30" name="__codelineno-7-30" href="#__codelineno-7-30"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">confidence</span><span class="p">;</span><span class="w">  </span><span class="c1">// [0, 1]</span>
</span><span id="__span-7-31"><a id="__codelineno-7-31" name="__codelineno-7-31" href="#__codelineno-7-31"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="33-fused-feature-vector">3.3 Fused Feature Vector<a class="headerlink" href="#33-fused-feature-vector" title="Permanent link">&para;</a></h3>
<div class="language-dart highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="kd">class</span><span class="w"> </span><span class="nc">FusedFeatures</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="w">  </span><span class="c1">// Pose-derived (17 values)</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">jointAngles</span><span class="p">;</span><span class="w">  </span><span class="c1">// 8 angles (elbow, knee, shoulder, hip)</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">jointVelocities</span><span class="p">;</span><span class="w">  </span><span class="c1">// 8 velocities (deg/s)</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">torsoOrientation</span><span class="p">;</span><span class="w">  </span><span class="c1">// Angle relative to vertical</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="w">  </span><span class="c1">// IMU-derived (10 values)</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Quaternion</span><span class="w"> </span><span class="n">orientation</span><span class="p">;</span><span class="w">  </span><span class="c1">// 4 values (w, x, y, z)</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Vector3</span><span class="w"> </span><span class="n">linearAccel</span><span class="p">;</span><span class="w">     </span><span class="c1">// 3 values (gravity-compensated)</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Vector3</span><span class="w"> </span><span class="n">angularVel</span><span class="p">;</span><span class="w">      </span><span class="c1">// 3 values</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="w">  </span><span class="c1">// EMG-derived (8 values)</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rmsAmplitude</span><span class="p">;</span><span class="w">  </span><span class="c1">// 4 channels</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">bandPower</span><span class="p">;</span><span class="w">     </span><span class="c1">// 4 channels (50-150 Hz)</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="w">  </span><span class="c1">// Total: 35 features per timestep</span>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="w">  </span><span class="c1">// ML input: 30 timesteps × 35 features = 1050 values</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="34-local-storage-format-sqlite">3.4 Local Storage Format (SQLite)<a class="headerlink" href="#34-local-storage-format-sqlite" title="Permanent link">&para;</a></h3>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1">-- Training data collection</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">sessions</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">  </span><span class="n">id</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">  </span><span class="n">user_id</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">  </span><span class="n">exercise_type</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">  </span><span class="c1">-- &#39;squat&#39;, &#39;pushup&#39;, etc.</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">  </span><span class="n">start_time</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w">  </span><span class="n">duration_ms</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="p">);</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">frames</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="w">  </span><span class="n">id</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="w">  </span><span class="n">session_id</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="w">  </span><span class="k">timestamp</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">  </span><span class="c1">-- Unix epoch ms</span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="w">  </span><span class="n">pose_json</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">     </span><span class="c1">-- JSON array of 17 keypoints</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="w">  </span><span class="n">imu_json</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">      </span><span class="c1">-- JSON array of IMU samples</span>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="w">  </span><span class="n">emg_json</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">      </span><span class="c1">-- JSON array of EMG samples</span>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a><span class="w">  </span><span class="n">error_label</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span><span class="w">            </span><span class="c1">-- Ground truth label (if available)</span>
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="w">  </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">session_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">sessions</span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a><span class="p">);</span>
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a>
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_session_timestamp</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">frames</span><span class="p">(</span><span class="n">session_id</span><span class="p">,</span><span class="w"> </span><span class="k">timestamp</span><span class="p">);</span>
</span></code></pre></div>
<p><strong>Compression</strong>: 60-second session @ 60 FPS = 3,600 frames
- Pose data: ~1.5 KB/frame (17 keypoints × 3 values × 8 bytes)
- Sensor data: ~2 KB/frame (50 IMU + 100 EMG samples)
- Total: ~12.6 MB/minute (compress to ~3-4 MB using GZIP)</p>
<hr />
<h2 id="4-real-time-vs-batch-processing-paths">4. Real-Time vs Batch Processing Paths<a class="headerlink" href="#4-real-time-vs-batch-processing-paths" title="Permanent link">&para;</a></h2>
<h3 id="41-real-time-path-live-feedback">4.1 Real-Time Path (Live Feedback)<a class="headerlink" href="#41-real-time-path-live-feedback" title="Permanent link">&para;</a></h3>
<p><strong>Use Case</strong>: Workout guidance with immediate error correction</p>
<p><strong>Data Flow</strong>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>Camera → Pose → Fusion → ML → Feedback (126ms latency)
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>       ↓
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>  Discard frame (no storage)
</span></code></pre></div></p>
<p><strong>Characteristics</strong>:
- <strong>No persistence</strong>: Frames processed and discarded
- <strong>Latency-critical</strong>: Must complete within 100ms target
- <strong>Optimizations</strong>:
  - Skip every other frame if latency exceeds budget (30 FPS fallback)
  - Disable logging/telemetry
  - Use quantized INT8 models</p>
<h3 id="42-batch-processing-path-post-workout-analysis">4.2 Batch Processing Path (Post-Workout Analysis)<a class="headerlink" href="#42-batch-processing-path-post-workout-analysis" title="Permanent link">&para;</a></h3>
<p><strong>Use Case</strong>: Detailed movement analytics, model retraining, progress tracking</p>
<p><strong>Data Flow</strong>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>Camera → Pose → Fusion → Storage (SQLite)
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>                              ↓
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>                        Offline ML (no latency constraint)
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>                              ↓
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>                      Generate insights (summary stats, trend analysis)
</span></code></pre></div></p>
<p><strong>Characteristics</strong>:
- <strong>Full persistence</strong>: All frames + raw sensor data saved
- <strong>High accuracy</strong>: Use FP32 models, multi-pass analysis
- <strong>Additional processing</strong>:
  - Optical flow analysis for smooth motion tracking
  - 3D pose reconstruction (if depth camera available)
  - Biomechanical modeling (joint torques, forces)</p>
<h3 id="43-hybrid-mode-selective-recording">4.3 Hybrid Mode (Selective Recording)<a class="headerlink" href="#43-hybrid-mode-selective-recording" title="Permanent link">&para;</a></h3>
<p><strong>Use Case</strong>: Record only interesting segments (errors, PRs, user-flagged moments)</p>
<p><strong>Trigger Conditions</strong>:
- Error confidence &gt; 0.7 → Save ±2 seconds around error
- User presses "record" button → Save session
- New personal record detected → Save rep</p>
<p><strong>Implementation</strong>:
<div class="language-dart highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="kd">class</span><span class="w"> </span><span class="nc">SelectiveRecorder</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="w">  </span><span class="n">CircularBuffer</span><span class="o">&lt;</span><span class="n">Frame</span><span class="o">&gt;</span><span class="w"> </span><span class="n">buffer</span><span class="p">;</span><span class="w">  </span><span class="c1">// Last 2 seconds (120 frames)</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">onFrame</span><span class="p">(</span><span class="n">Frame</span><span class="w"> </span><span class="n">frame</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">errorConfidence</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="w">    </span><span class="n">buffer</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">frame</span><span class="p">);</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">errorConfidence</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0.7</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="w">      </span><span class="c1">// Flush buffer to storage</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="w">      </span><span class="n">db</span><span class="p">.</span><span class="n">saveFrames</span><span class="p">(</span><span class="n">buffer</span><span class="p">.</span><span class="n">getAll</span><span class="p">());</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="w">      </span><span class="c1">// Continue recording for next 2 seconds</span>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="w">      </span><span class="n">isRecording</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="w">      </span><span class="n">recordingEndTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">now</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">2000</span><span class="p">;</span>
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-12-16"><a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a><span class="p">}</span>
</span></code></pre></div></p>
<hr />
<h2 id="5-data-quality-and-validation">5. Data Quality and Validation<a class="headerlink" href="#5-data-quality-and-validation" title="Permanent link">&para;</a></h2>
<h3 id="51-input-validation">5.1 Input Validation<a class="headerlink" href="#51-input-validation" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Check</th>
<th>Criteria</th>
<th>Action on Failure</th>
</tr>
</thead>
<tbody>
<tr>
<td>Camera frame</td>
<td>Non-null, correct dimensions</td>
<td>Skip frame, log warning</td>
</tr>
<tr>
<td>BLE packet</td>
<td>Valid Protobuf, seq_id increments</td>
<td>Request retransmission (if possible)</td>
</tr>
<tr>
<td>Pose confidence</td>
<td>Mean keypoint confidence &gt; 0.5</td>
<td>Display "Move closer to camera"</td>
</tr>
<tr>
<td>IMU range</td>
<td>Accel ≤16g, Gyro ≤2000°/s</td>
<td>Clamp values, flag outlier</td>
</tr>
<tr>
<td>EMG range</td>
<td>ADC value ≤4095</td>
<td>Clamp to max, check sensor connection</td>
</tr>
</tbody>
</table>
<h3 id="52-synchronization-validation">5.2 Synchronization Validation<a class="headerlink" href="#52-synchronization-validation" title="Permanent link">&para;</a></h3>
<p><strong>Test Protocol</strong>:
1. Apply known stimulus (e.g., shake device while recording)
2. Verify IMU spike aligns with camera motion blur within ±16ms (1 frame @ 60 FPS)
3. Verify EMG spike (manual muscle contraction) aligns with pose change</p>
<p><strong>Metrics</strong>:
- <strong>Sync error</strong>: Mean absolute difference between expected and actual alignment
- <strong>Target</strong>: &lt;16ms (1 frame tolerance)</p>
<hr />
<h2 id="6-failure-modes-and-degradation">6. Failure Modes and Degradation<a class="headerlink" href="#6-failure-modes-and-degradation" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Failure</th>
<th>Detection</th>
<th>Graceful Degradation</th>
</tr>
</thead>
<tbody>
<tr>
<td>BLE disconnection</td>
<td>No packets for 100ms</td>
<td>Pause inference, show reconnection UI</td>
</tr>
<tr>
<td>Camera obstruction</td>
<td>Pose confidence &lt;0.3</td>
<td>Pause feedback, prompt user</td>
</tr>
<tr>
<td>High latency (&gt;150ms)</td>
<td>Timestamp delta tracking</td>
<td>Drop to 30 FPS, disable EMG fusion</td>
</tr>
<tr>
<td>Low battery (&lt;10%)</td>
<td>System API</td>
<td>Reduce camera resolution to 320×240</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="7-performance-monitoring">7. Performance Monitoring<a class="headerlink" href="#7-performance-monitoring" title="Permanent link">&para;</a></h2>
<h3 id="71-telemetry-collection">7.1 Telemetry Collection<a class="headerlink" href="#71-telemetry-collection" title="Permanent link">&para;</a></h3>
<div class="language-dart highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="kd">class</span><span class="w"> </span><span class="nc">PipelineMetrics</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Stopwatch</span><span class="w"> </span><span class="n">totalLatency</span><span class="p">;</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Stopwatch</span><span class="w"> </span><span class="n">poseInference</span><span class="p">;</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Stopwatch</span><span class="w"> </span><span class="n">fusion</span><span class="p">;</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Stopwatch</span><span class="w"> </span><span class="n">mlInference</span><span class="p">;</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">droppedFrames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">blePacketLoss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">logMetrics</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="w">    </span><span class="c1">// Log every 60 seconds</span>
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="w">    </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Avg latency: </span><span class="si">${</span><span class="n">totalLatency</span><span class="p">.</span><span class="n">averageMs</span><span class="p">()</span><span class="si">}</span><span class="s1">ms&#39;</span><span class="p">);</span>
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="w">    </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Dropped frames: </span><span class="si">$</span><span class="n">droppedFrames</span><span class="s1">&#39;</span><span class="p">);</span>
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a><span class="w">    </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;BLE loss rate: </span><span class="si">${</span><span class="n">blePacketLoss</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">6000</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">);</span><span class="w">  </span><span class="c1">// 100 Hz × 60s</span>
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="72-bottleneck-identification">7.2 Bottleneck Identification<a class="headerlink" href="#72-bottleneck-identification" title="Permanent link">&para;</a></h3>
<p><strong>Profiling Strategy</strong>:
1. Add timestamps at each pipeline stage
2. Calculate percentiles (P50, P95, P99) over 1-minute window
3. Identify stage where P95 exceeds budget</p>
<p><strong>Example Output</strong>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>Stage            P50    P95    P99    Budget   Status
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>Camera           25ms   32ms   40ms   30ms     ⚠️ Warning
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>Pose inference   28ms   45ms   60ms   30ms     ❌ Over budget
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>Fusion           8ms    12ms   15ms   10ms     ✅ OK
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>ML inference     35ms   50ms   65ms   40ms     ❌ Over budget
</span></code></pre></div></p>
<hr />
<h2 id="8-future-optimizations">8. Future Optimizations<a class="headerlink" href="#8-future-optimizations" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>Predictive Synchronization</strong>: Use IMU to predict pose at t_cam + 16ms (next frame)</li>
<li><strong>Adaptive Sampling</strong>: Reduce IMU/EMG rate to 50 Hz during low-motion periods</li>
<li><strong>Edge TPU</strong>: Offload pose inference to dedicated ML accelerator (target: 10ms inference)</li>
<li><strong>Delta Encoding</strong>: Transmit only IMU/EMG deltas from previous sample to reduce BLE bandwidth</li>
<li><strong>On-Device Training</strong>: Fine-tune ML model using user-specific data collected during batch processing</li>
</ol>
<hr />
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h2>
<p>The data flow architecture achieves real-time multimodal fusion through:
- <strong>Camera-centric synchronization</strong>: All sensors aligned to 60 FPS visual reference
- <strong>Efficient BLE protocol</strong>: 500-byte MTU with Protobuf encoding supports 100 Hz streaming
- <strong>Staged processing</strong>: Clear separation of concerns (acquisition → sync → pose → fusion → ML)
- <strong>Dual pathways</strong>: Real-time feedback path optimized for latency, batch path for accuracy</p>
<p><strong>Current Performance</strong>: 126ms average latency (26ms over target)
<strong>Optimization Priority</strong>: Pose inference (45ms → 20ms via quantization) + ML inference (50ms → 30ms via pruning)</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/movement-chain-ai" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/movement-chain-ai" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.tabs", "navigation.sections", "navigation.top", "navigation.tracking", "navigation.indexes", "toc.integrate", "search.suggest", "search.highlight", "content.code.copy", "content.tabs.link"], "search": "../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"alias": true, "default": "latest", "provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>